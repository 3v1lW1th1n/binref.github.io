<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.8.3" />
<title>the refinery documentation</title>
<meta name="description" content="On a Mission to Refine Binaries" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow-night-bright.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{background-color:#0D0D0D;color:#EEEEEE;font-size:12pt}@font-face{font-family:"FixedSysEx";src:local('Fixedsys Excelsior 3.01-L2'),local('Fixedsys Excelsior 3.01'),local('FixedSysEx'),url(FixedSysEx.ttf) format('truetype')}code,pre,body,html{font-family:FixedSysEx,monospace}b,strong{font-weight:normal}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #EEEEEE;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#EE8080;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#EEEEEE}// .title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#BB4040}pre code{background:#000000;display:block;padding:1px 0px 4px 0px;line-height:100%}code{background:#000000;padding:1px 0px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#000000;border:0;border-top:1px solid #EEEEEE;border-bottom:1px solid #EEEEEE;margin:1em 0;padding:1ex;overflow-x:auto}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #EEEEEE}#index ul{padding:0}// #index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 10px}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#000000;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#0D0D0D}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#EEEEEE;border-left:5px solid #EEEEEE;padding-left:1em}.inheritance em{font-style:normal}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1ch}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition.note,.admonition.info,.admonition.todo,.admonition.versionadded,.admonition.important,.admonition.tip,.admonition.hint{background:#054000}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#998800}.admonition.error,.admonition.danger,.admonition.caution{background:#300000}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #EEEEEE}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #EEEEEE;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>refinery</code></h1>
</header>
<section id="section-intro">
<hr>
<pre><code>        __     __  High Octane Triage Analysis          __
        ||    _||______ __       __________     _____   ||
        ||    \||___   \__| ____/   ______/___ / ____\  ||
========||=====||  | __/  |/    \  /==|  / __ \   __\===]|
        '======||  |   \  |   |  \_  _| \  ___/|  |     ||
               ||____  /__|___|__/  / |  \____]|  |     ||
===============''====\/=========/  /==|__|=====|__|======'
                               \  /
                                \/
</code></pre>
<p>The main package <code><a title="refinery" href="#refinery">refinery</a></code> exports all <code><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></code>s which are also
of type <code><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></code>, i.e. they expose a shell command. The command
line interface for each of these units is given below, this is the same text
as would be available by executing the command with the <code>-h</code> or <code>--help</code>
option. To better understand how the command line parameters are parsed, it is
recommended to study the module documentation of the following two library
modules, as their content is relevant for command line use of the <code><a title="refinery" href="#refinery">refinery</a></code>.</p>
<ul>
<li><code><a title="refinery.lib.argformats" href="lib/argformats.html">refinery.lib.argformats</a></code></li>
<li><code><a title="refinery.lib.frame" href="lib/frame.html">refinery.lib.frame</a></code></li>
</ul>
<p>Furthermore, the module documentation of <code><a title="refinery.units" href="units/index.html">refinery.units</a></code> contains a brief
example of how to write simple units.</p>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/__init__.py#L0-L161" class="git-link">Browse git</a>
</summary>
<pre><code class="python">#!/usr/bin/env python3
# -*- coding: utf-8 -*-
R&#34;&#34;&#34;
    ----------------------------------------------------------
            __     __  High Octane Triage Analysis          __
            ||    _||______ __       __________     _____   ||
            ||    \||___   \__| ____/   ______/___ / ____\  ||
    ========||=====||  | __/  |/    \  /==|  / __ \   __\===]|
            &#39;======||  |   \  |   |  \_  _| \  ___/|  |     ||
                   ||____  /__|___|__/  / |  \____]|  |     ||
    ===============&#39;&#39;====\/=========/  /==|__|=====|__|======&#39;
                                   \  /
                                    \/

The main package `refinery` exports all `refinery.units.Unit`s which are also
of type `refinery.units.Entry`, i.e. they expose a shell command. The command
line interface for each of these units is given below, this is the same text
as would be available by executing the command with the `-h` or `--help`
option. To better understand how the command line parameters are parsed, it is
recommended to study the module documentation of the following two library
modules, as their content is relevant for command line use of the `refinery`.

- `refinery.lib.argformats`
- `refinery.lib.frame`

Furthermore, the module documentation of `refinery.units` contains a brief
example of how to write simple units.
&#34;&#34;&#34;
import os
import pickle

from .units import arg, Unit


def _singleton(cls):
    return cls()


@_singleton
class _cache:
    &#34;&#34;&#34;
    Every unit can be imported from the refinery base module. The actual import
    is performed on demand to reduce import times. On first import of the refinery
    package, it creates a map of units and their corresponding module and stores
    this map as `__init__.pkl` in the package directory; this process can take
    several seconds. Subsequent imports of refinery should be faster, and the
    loading of units from the module is nearly as fast as specifying the full path.
    &#34;&#34;&#34;
    def __init__(self, filename=&#39;__init__.pkl&#39;):
        self.path = os.path.join(os.path.dirname(__file__), filename)
        self.reloading = False
        self.units = {}
        self.cache = {}
        self.load()

    def load(self):
        try:
            with open(self.path, &#39;rb&#39;) as stream:
                self.units = pickle.load(stream)
        except (FileNotFoundError, EOFError):
            self.reload()

    def save(self):
        try:
            with open(self.path, &#39;wb&#39;) as stream:
                pickle.dump(self.units, stream)
        except Exception:
            pass

    def reload(self):
        if not self.reloading:
            from .lib.loader import get_all_entry_points
            self.reloading = True
            self.units = {e.__qualname__: e.__module__ for e in get_all_entry_points()}
            self.reloading = False
            self.save()

    def _resolve(self, name, retry=False):
        if retry:
            self.reload()
        try:
            module_path = self.units[name]
            module = __import__(module_path, None, None, [name])
            entry = getattr(module, name)
            self.cache[name] = entry
            return entry
        except (KeyError, ModuleNotFoundError):
            if not retry:
                return self._resolve(name, retry=True)
            raise AttributeError

    def __getitem__(self, name):
        return self._resolve(name)


@_singleton
class __pdoc__(dict):
    OVERRIDES = {
        &#39;deobfuscate&#39;: False,
        &#39;decrypt&#39;: False,
        &#39;encrypt&#39;: False,
        &#39;filter&#39;: &#39;&#39;,
        &#39;interface&#39;: &#39;&#39;,
        &#39;keystream&#39;: False,
        &#39;ecb&#39;: False,
        &#39;bytestream&#39;: False,
        &#39;operate&#39;: False,
        &#39;inplace&#39;: False,
        &#39;reverse&#39;: False,
    }

    def __init__(self, *a, **kw):
        super().__init__()
        self._loaded = False

    def _strip_globals(self, hlp: str):
        def _strip(lines):
            triggered = False
            for line in lines:
                if triggered:
                    if line.lstrip() != line:
                        continue
                    triggered = False
                if line.lower().startswith(&#39;global options:&#39;):
                    triggered = True
                    continue
                yield line
        return &#39;&#39;.join(_strip(hlp.splitlines(keepends=True)))

    def _load(self):
        if self._loaded:
            return
        from .explore import get_help_string
        self[&#39;Unit&#39;] = False
        for name in _cache.units:
            unit = _cache[name]
            for attribute, description in self.OVERRIDES.items():
                at = getattr(unit, attribute, None)
                bt = getattr(unit.mro()[1], attribute, None)
                if at and at is not bt:
                    self[F&#39;{name}.{attribute}&#39;] = description
            hlp = get_help_string(unit, width=74)
            hlp = hlp.replace(&#39;\x60&#39;, &#39;&#39;)
            hlp = self._strip_globals(hlp).strip()
            hlp = (
                F&#39;This unit is implemented in `{unit.__module__}` and has the following &#39;
                F&#39;commandline Interface:\n```text\n{hlp}\n```&#39;
            )
            self[name] = hlp
        self._loaded = True

    def items(self):
        self._load()
        return super().items()


__all__ = [&#39;Unit&#39;, &#39;arg&#39;, &#39;__pdoc__&#39;]
__all__ += [x for x, _ in sorted(_cache.units.items(), key=lambda x:x[1])]


def __getattr__(name):
    return _cache[name]</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="refinery.explore" href="explore.html">refinery.explore</a></code></dt>
<dd>
<section class="desc"><p>A commandline script to search for binary refinery units based on keywords.</p></section>
</dd>
<dt><code class="name"><a title="refinery.lib" href="lib/index.html">refinery.lib</a></code></dt>
<dd>
<section class="desc"><p>Library functions used by various refinery units.</p></section>
</dd>
<dt><code class="name"><a title="refinery.units" href="units/index.html">refinery.units</a></code></dt>
<dd>
<section class="desc"><p>This package contains all refinery units. To write an executable refinery unit,
it is sufficient to write a class that inherits from …</p></section>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="refinery.arg"><code class="flex name class">
<span>class <span class="ident">arg</span></span>
<span>(</span><span>*args, action=refinery.units.arg.omit, choices=refinery.units.arg.omit, const=refinery.units.arg.omit, default=refinery.units.arg.omit, dest=refinery.units.arg.omit, help=refinery.units.arg.omit, metavar=refinery.units.arg.omit, nargs=refinery.units.arg.omit, required=refinery.units.arg.omit, type=refinery.units.arg.omit, group=None, guess=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This child class of <code><a title="refinery.units.Argument" href="units/index.html#refinery.units.Argument">Argument</a></code> is specifically an argument for the
<code>add_argument</code> method of an <code>ArgumentParser</code> from the <code>argparse</code> module. It can also
be used as a decorator for the constructor of a refinery unit to better control
the argument parser of that unit's command line interface. Example:</p>
<pre><code>class prefixer(Unit):
    @arg('prefix', help='this data will be prepended to the input.')
    def __init__(self, prefix): pass

    def process(self, data):
        return self.args.prefix + data
</code></pre>
<p>Note that when the init of a unit has a return annotation that is a base class of
itself, then all its parameters will automatically be forwarded to that base class.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/__init__.py#L122-L393" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class arg(Argument):
    &#34;&#34;&#34;
    This child class of `refinery.units.Argument` is specifically an argument for the
    `add_argument` method of an `ArgumentParser` from the `argparse` module. It can also
    be used as a decorator for the constructor of a refinery unit to better control
    the argument parser of that unit&#39;s command line interface. Example:
    ```
    class prefixer(Unit):
        @arg(&#39;prefix&#39;, help=&#39;this data will be prepended to the input.&#39;)
        def __init__(self, prefix): pass

        def process(self, data):
            return self.args.prefix + data
    ```
    Note that when the init of a unit has a return annotation that is a base class of
    itself, then all its parameters will automatically be forwarded to that base class.
    &#34;&#34;&#34;

    class delete: pass
    class omit: pass

    def __init__(
        self, *args: str,
            action   : Union[omit, str]           = omit, # noqa
            choices  : Union[omit, Iterable[Any]] = omit, # noqa
            const    : Union[omit, Any]           = omit, # noqa
            default  : Union[omit, Any]           = omit, # noqa
            dest     : Union[omit, str]           = omit, # noqa
            help     : Union[omit, str]           = omit, # noqa
            metavar  : Union[omit, str]           = omit, # noqa
            nargs    : Union[omit, int, str]      = omit, # noqa
            required : Union[omit, bool]          = omit, # noqa
            type     : Union[omit, type]          = omit, # noqa
            group    : Optional[str]              = None, # noqa
            guess    : bool                       = False # noqa
    ) -&gt; None:
        kwargs = dict(action=action, choices=choices, const=const, default=default, dest=dest,
            help=help, metavar=metavar, nargs=nargs, required=required, type=type)
        kwargs = {key: value for key, value in kwargs.items() if value is not arg.omit}
        self.group = group
        self.guess = guess
        super().__init__(*args, **kwargs)

    def update_help(self):
        if &#39;help&#39; not in self.kwargs:
            return
        formatting = {}
        choices = self.kwargs.get(&#39;choices&#39;, None)
        if choices is not None:
            formatting.update(choices=&#39;, &#39;.join(self.kwargs[&#39;choices&#39;]))
        default = self.kwargs.get(&#39;default&#39;, None)
        if default is not None:
            try:
                formatting.update(default=F&#39;H:{default.hex()}&#39;)
            except AttributeError:
                formatting.update(default=str(default))
        try:
            self.kwargs[&#39;help&#39;] = self.kwargs[&#39;help&#39;].format(**formatting)
        except Exception:
            pass

    def __rmatmul__(self, method):
        self.update_help()
        return super().__rmatmul__(method)

    @staticmethod
    def switch(
        *args: str, off=False,
        help : Union[omit, str] = omit,
        dest : Union[omit, str] = omit,
        group: Optional[str] = None,
    ) -&gt; Argument:
        &#34;&#34;&#34;
        A convenience method to add argparse arguments that change a boolean value from True to False or
        vice versa. By default, a switch will have a False default and change it to True when specified.
        &#34;&#34;&#34;
        return arg(*args, group=group, help=help, dest=dest, action=&#39;store_false&#39; if off else &#39;store_true&#39;)

    @staticmethod
    def number(
        *args: str,
        bound: Union[omit, Tuple[int, int]] = omit,
        help : Union[omit, str] = omit,
        dest : Union[omit, str] = omit,
        metavar : Optional[str] = None,
        group: Optional[str] = None,
    ) -&gt; Argument:
        &#34;&#34;&#34;
        Used to add argparse arguments that contain a number.
        &#34;&#34;&#34;
        nt = number
        if bound is not arg.omit:
            lower, upper = bound
            nt = nt[lower:upper]
        return arg(*args, group=group, help=help, dest=dest, type=nt, metavar=metavar or &#39;N&#39;)

    @staticmethod
    def option(
        *args: str, choices: Enum,
        help : Union[omit, str] = omit,
        dest : Union[omit, str] = omit,
        metavar: Optional[str] = None,
        group: Optional[str] = None,
    ) -&gt; Argument:
        &#34;&#34;&#34;
        Used to add argparse arguments with a fixed set of options, based on an enumeration.
        &#34;&#34;&#34;
        cnames = [c.name for c in choices]
        metavar = metavar or choices.__name__
        return arg(*args, group=group, help=help, metavar=metavar, dest=dest, choices=cnames, type=str)

    @staticmethod
    def choice(
        *args: str, choices : List[str],
        help    : Union[omit, str] = omit,
        metavar : Union[omit, str] = omit,
        dest    : Union[omit, str] = omit,
        nargs   : Union[omit, int, str] = omit,
        group   : Optional[str] = None,
    ):
        &#34;&#34;&#34;
        Used to add argparse arguments with a fixed set of options, based on a list of strings.
        &#34;&#34;&#34;
        return arg(*args, group=group, type=str, metavar=metavar, nargs=nargs,
            dest=dest, help=help, choices=choices)

    @property
    def positional(self) -&gt; bool:
        return any(a[0] != &#39;-&#39; for a in self.args)

    @property
    def destination(self) -&gt; str:
        &#34;&#34;&#34;
        The name of the variable where the contents of this parsed argument will be stored.
        &#34;&#34;&#34;
        for a in self.args:
            if a[0] != &#39;-&#39;:
                return a
        try:
            return self.kwargs[&#39;dest&#39;]
        except KeyError:
            for a in self.args:
                if a.startswith(&#39;--&#39;):
                    dest = a.lstrip(&#39;-&#39;).replace(&#39;-&#39;, &#39;_&#39;)
                    if dest.isidentifier():
                        return dest
            raise AttributeError(F&#39;The argument with these values has no destination: {self!r}&#39;)

    @classmethod
    def infer(cls, pt: inspect.Parameter) -&gt; Argument:
        &#34;&#34;&#34;
        This class method can be used to infer the argparse argument for a Python function
        parameter. This guess is based on the annotation, name, and default value.
        &#34;&#34;&#34;

        def needs_type(item):
            return item.get(&#39;action&#39;, &#39;store&#39;) == &#39;store&#39;

        def get_argp_type(annotation_type):
            if issubclass(annotation_type, (bytes, bytearray, memoryview)):
                return multibin
            if issubclass(annotation_type, int):
                return number
            if issubclass(annotation_type, slice):
                return sliceobj
            return annotation_type

        name = pt.name.replace(&#39;_&#39;, &#39;-&#39;)
        default = pt.default
        guessed_pos_args = []
        guessed_kwd_args = dict(dest=pt.name, guess=True)
        annotation = pt.annotation

        if isinstance(annotation, str):
            try: annotation = eval(annotation)
            except Exception: pass

        if annotation is not pt.empty:
            if isinstance(annotation, Argument):
                if annotation.kwargs.get(&#39;dest&#39;, pt.name) != pt.name:
                    raise ValueError(
                        F&#39;Incompatible argument destination specified; parameter {pt.name} &#39;
                        F&#39;was annotated with {annotation!r}.&#39;)
                guessed_pos_args = annotation.args
                guessed_kwd_args.update(annotation.kwargs)
                guessed_kwd_args[&#39;guess&#39;] = False
                guessed_kwd_args[&#39;group&#39;] = annotation.group
            elif isinstance(annotation, type):
                if not issubclass(annotation, bool) and needs_type(guessed_kwd_args):
                    guessed_kwd_args.update(type=get_argp_type(annotation))
                elif not isinstance(default, bool):
                    raise ValueError(&#39;Default value for boolean arguments must be provided.&#39;)

        if not guessed_pos_args:
            guessed_pos_args = guessed_pos_args or [F&#39;--{name}&#39; if pt.kind is pt.KEYWORD_ONLY else name]

        if pt.kind is pt.VAR_POSITIONAL:
            oldnargs = guessed_kwd_args.setdefault(&#39;nargs&#39;, ZERO_OR_MORE)
            if oldnargs not in (ONE_OR_MORE, ZERO_OR_MORE, REMAINDER):
                raise ValueError(F&#39;Variadic positional arguments has nargs set to {oldnargs!r}&#39;)
            return cls(*guessed_pos_args, **guessed_kwd_args)

        if default is not pt.empty:
            if isinstance(default, (list, tuple)):
                guessed_kwd_args.setdefault(&#39;nargs&#39;, ZERO_OR_MORE)
                if not pt.default:
                    default = pt.empty
                else:
                    guessed_kwd_args.setdefault(&#39;default&#39;, pt.default)
                    default = default[0]
            else:
                guessed_kwd_args.setdefault(&#39;default&#39;, default)
                if pt.kind is pt.POSITIONAL_ONLY:
                    guessed_kwd_args.setdefault(&#39;nargs&#39;, OPTIONAL)

        if default is not pt.empty:
            if isinstance(default, bool):
                guessed_kwd_args[&#39;action&#39;] = &#39;store_false&#39; if default else &#39;store_true&#39;
            elif needs_type(guessed_kwd_args) and &#39;type&#39; not in guessed_kwd_args:
                guessed_kwd_args[&#39;type&#39;] = get_argp_type(type(default))

        return cls(*guessed_pos_args, **guessed_kwd_args)

    def merge_args(self, them: Argument) -&gt; None:
        def iterboth():
            yield from them.args
            yield from self.args
        if not self.args:
            self.args = list(them.args)
            return
        sflag = None
        lflag = None
        for a in iterboth():
            if a[:2] == &#39;--&#39;: lflag = lflag or a
            elif a[0] == &#39;-&#39;: sflag = sflag or a
        self.args = []
        if sflag: self.args.append(sflag)
        if lflag: self.args.append(lflag)
        if not self.args:
            self.args = list(them.args)

    def merge_all(self, them: Argument) -&gt; None:
        for key, value in them.kwargs.items():
            if value is arg.delete:
                self.kwargs.pop(key, None)
                continue
            self.kwargs[key] = value
        self.merge_args(them)
        self.guess = self.guess and them.guess
        self.group = self.group or them.group

    def __copy__(self) -&gt; Argument:
        cls = self.__class__
        clone = cls.__new__(cls)
        clone.kwargs = dict(self.kwargs)
        clone.args = list(self.args)
        clone.group = self.group
        clone.guess = self.guess
        return clone

    def __repr__(self) -&gt; str:
        return F&#39;arg({super().__repr__()})&#39;

    def __call__(self, init: Callable) -&gt; Callable:
        parameters = inspect.signature(init).parameters
        try:
            inferred = arg.infer(parameters[self.destination])
            inferred.merge_all(self)
            init.__annotations__[self.destination] = inferred
        except KeyError:
            raise ValueError(F&#39;Unable to decorate because no parameter with name {self.destination} exists.&#39;)
        return init</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Argument" href="units/index.html#refinery.units.Argument">Argument</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.arg.delete"><code class="name">var <span class="ident">delete</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.arg.omit"><code class="name">var <span class="ident">omit</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="refinery.arg.switch"><code class="name flex">
<span>def <span class="ident">switch</span></span>(<span>*args, off=False, help=refinery.units.arg.omit, dest=refinery.units.arg.omit, group=None)</span>
</code></dt>
<dd>
<section class="desc"><p>A convenience method to add argparse arguments that change a boolean value from True to False or
vice versa. By default, a switch will have a False default and change it to True when specified.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/__init__.py#L187-L198" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@staticmethod
def switch(
    *args: str, off=False,
    help : Union[omit, str] = omit,
    dest : Union[omit, str] = omit,
    group: Optional[str] = None,
) -&gt; Argument:
    &#34;&#34;&#34;
    A convenience method to add argparse arguments that change a boolean value from True to False or
    vice versa. By default, a switch will have a False default and change it to True when specified.
    &#34;&#34;&#34;
    return arg(*args, group=group, help=help, dest=dest, action=&#39;store_false&#39; if off else &#39;store_true&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.arg.number"><code class="name flex">
<span>def <span class="ident">number</span></span>(<span>*args, bound=refinery.units.arg.omit, help=refinery.units.arg.omit, dest=refinery.units.arg.omit, metavar=None, group=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Used to add argparse arguments that contain a number.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/__init__.py#L200-L216" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@staticmethod
def number(
    *args: str,
    bound: Union[omit, Tuple[int, int]] = omit,
    help : Union[omit, str] = omit,
    dest : Union[omit, str] = omit,
    metavar : Optional[str] = None,
    group: Optional[str] = None,
) -&gt; Argument:
    &#34;&#34;&#34;
    Used to add argparse arguments that contain a number.
    &#34;&#34;&#34;
    nt = number
    if bound is not arg.omit:
        lower, upper = bound
        nt = nt[lower:upper]
    return arg(*args, group=group, help=help, dest=dest, type=nt, metavar=metavar or &#39;N&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.arg.option"><code class="name flex">
<span>def <span class="ident">option</span></span>(<span>*args, choices, help=refinery.units.arg.omit, dest=refinery.units.arg.omit, metavar=None, group=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Used to add argparse arguments with a fixed set of options, based on an enumeration.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/__init__.py#L218-L231" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@staticmethod
def option(
    *args: str, choices: Enum,
    help : Union[omit, str] = omit,
    dest : Union[omit, str] = omit,
    metavar: Optional[str] = None,
    group: Optional[str] = None,
) -&gt; Argument:
    &#34;&#34;&#34;
    Used to add argparse arguments with a fixed set of options, based on an enumeration.
    &#34;&#34;&#34;
    cnames = [c.name for c in choices]
    metavar = metavar or choices.__name__
    return arg(*args, group=group, help=help, metavar=metavar, dest=dest, choices=cnames, type=str)</code></pre>
</details>
</dd>
<dt id="refinery.arg.choice"><code class="name flex">
<span>def <span class="ident">choice</span></span>(<span>*args, choices, help=refinery.units.arg.omit, metavar=refinery.units.arg.omit, dest=refinery.units.arg.omit, nargs=refinery.units.arg.omit, group=None)</span>
</code></dt>
<dd>
<section class="desc"><p>Used to add argparse arguments with a fixed set of options, based on a list of strings.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/__init__.py#L233-L246" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@staticmethod
def choice(
    *args: str, choices : List[str],
    help    : Union[omit, str] = omit,
    metavar : Union[omit, str] = omit,
    dest    : Union[omit, str] = omit,
    nargs   : Union[omit, int, str] = omit,
    group   : Optional[str] = None,
):
    &#34;&#34;&#34;
    Used to add argparse arguments with a fixed set of options, based on a list of strings.
    &#34;&#34;&#34;
    return arg(*args, group=group, type=str, metavar=metavar, nargs=nargs,
        dest=dest, help=help, choices=choices)</code></pre>
</details>
</dd>
<dt id="refinery.arg.infer"><code class="name flex">
<span>def <span class="ident">infer</span></span>(<span>pt)</span>
</code></dt>
<dd>
<section class="desc"><p>This class method can be used to infer the argparse argument for a Python function
parameter. This guess is based on the annotation, name, and default value.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/__init__.py#L270-L343" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def infer(cls, pt: inspect.Parameter) -&gt; Argument:
    &#34;&#34;&#34;
    This class method can be used to infer the argparse argument for a Python function
    parameter. This guess is based on the annotation, name, and default value.
    &#34;&#34;&#34;

    def needs_type(item):
        return item.get(&#39;action&#39;, &#39;store&#39;) == &#39;store&#39;

    def get_argp_type(annotation_type):
        if issubclass(annotation_type, (bytes, bytearray, memoryview)):
            return multibin
        if issubclass(annotation_type, int):
            return number
        if issubclass(annotation_type, slice):
            return sliceobj
        return annotation_type

    name = pt.name.replace(&#39;_&#39;, &#39;-&#39;)
    default = pt.default
    guessed_pos_args = []
    guessed_kwd_args = dict(dest=pt.name, guess=True)
    annotation = pt.annotation

    if isinstance(annotation, str):
        try: annotation = eval(annotation)
        except Exception: pass

    if annotation is not pt.empty:
        if isinstance(annotation, Argument):
            if annotation.kwargs.get(&#39;dest&#39;, pt.name) != pt.name:
                raise ValueError(
                    F&#39;Incompatible argument destination specified; parameter {pt.name} &#39;
                    F&#39;was annotated with {annotation!r}.&#39;)
            guessed_pos_args = annotation.args
            guessed_kwd_args.update(annotation.kwargs)
            guessed_kwd_args[&#39;guess&#39;] = False
            guessed_kwd_args[&#39;group&#39;] = annotation.group
        elif isinstance(annotation, type):
            if not issubclass(annotation, bool) and needs_type(guessed_kwd_args):
                guessed_kwd_args.update(type=get_argp_type(annotation))
            elif not isinstance(default, bool):
                raise ValueError(&#39;Default value for boolean arguments must be provided.&#39;)

    if not guessed_pos_args:
        guessed_pos_args = guessed_pos_args or [F&#39;--{name}&#39; if pt.kind is pt.KEYWORD_ONLY else name]

    if pt.kind is pt.VAR_POSITIONAL:
        oldnargs = guessed_kwd_args.setdefault(&#39;nargs&#39;, ZERO_OR_MORE)
        if oldnargs not in (ONE_OR_MORE, ZERO_OR_MORE, REMAINDER):
            raise ValueError(F&#39;Variadic positional arguments has nargs set to {oldnargs!r}&#39;)
        return cls(*guessed_pos_args, **guessed_kwd_args)

    if default is not pt.empty:
        if isinstance(default, (list, tuple)):
            guessed_kwd_args.setdefault(&#39;nargs&#39;, ZERO_OR_MORE)
            if not pt.default:
                default = pt.empty
            else:
                guessed_kwd_args.setdefault(&#39;default&#39;, pt.default)
                default = default[0]
        else:
            guessed_kwd_args.setdefault(&#39;default&#39;, default)
            if pt.kind is pt.POSITIONAL_ONLY:
                guessed_kwd_args.setdefault(&#39;nargs&#39;, OPTIONAL)

    if default is not pt.empty:
        if isinstance(default, bool):
            guessed_kwd_args[&#39;action&#39;] = &#39;store_false&#39; if default else &#39;store_true&#39;
        elif needs_type(guessed_kwd_args) and &#39;type&#39; not in guessed_kwd_args:
            guessed_kwd_args[&#39;type&#39;] = get_argp_type(type(default))

    return cls(*guessed_pos_args, **guessed_kwd_args)</code></pre>
</details>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="refinery.arg.positional"><code class="name">var <span class="ident">positional</span></code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/__init__.py#L248-L250" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@property
def positional(self) -&gt; bool:
    return any(a[0] != &#39;-&#39; for a in self.args)</code></pre>
</details>
</dd>
<dt id="refinery.arg.destination"><code class="name">var <span class="ident">destination</span></code></dt>
<dd>
<section class="desc"><p>The name of the variable where the contents of this parsed argument will be stored.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/__init__.py#L252-L268" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@property
def destination(self) -&gt; str:
    &#34;&#34;&#34;
    The name of the variable where the contents of this parsed argument will be stored.
    &#34;&#34;&#34;
    for a in self.args:
        if a[0] != &#39;-&#39;:
            return a
    try:
        return self.kwargs[&#39;dest&#39;]
    except KeyError:
        for a in self.args:
            if a.startswith(&#39;--&#39;):
                dest = a.lstrip(&#39;-&#39;).replace(&#39;-&#39;, &#39;_&#39;)
                if dest.isidentifier():
                    return dest
        raise AttributeError(F&#39;The argument with these values has no destination: {self!r}&#39;)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="refinery.arg.update_help"><code class="name flex">
<span>def <span class="ident">update_help</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/__init__.py#L165-L181" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def update_help(self):
    if &#39;help&#39; not in self.kwargs:
        return
    formatting = {}
    choices = self.kwargs.get(&#39;choices&#39;, None)
    if choices is not None:
        formatting.update(choices=&#39;, &#39;.join(self.kwargs[&#39;choices&#39;]))
    default = self.kwargs.get(&#39;default&#39;, None)
    if default is not None:
        try:
            formatting.update(default=F&#39;H:{default.hex()}&#39;)
        except AttributeError:
            formatting.update(default=str(default))
    try:
        self.kwargs[&#39;help&#39;] = self.kwargs[&#39;help&#39;].format(**formatting)
    except Exception:
        pass</code></pre>
</details>
</dd>
<dt id="refinery.arg.merge_args"><code class="name flex">
<span>def <span class="ident">merge_args</span></span>(<span>self, them)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/__init__.py#L345-L361" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def merge_args(self, them: Argument) -&gt; None:
    def iterboth():
        yield from them.args
        yield from self.args
    if not self.args:
        self.args = list(them.args)
        return
    sflag = None
    lflag = None
    for a in iterboth():
        if a[:2] == &#39;--&#39;: lflag = lflag or a
        elif a[0] == &#39;-&#39;: sflag = sflag or a
    self.args = []
    if sflag: self.args.append(sflag)
    if lflag: self.args.append(lflag)
    if not self.args:
        self.args = list(them.args)</code></pre>
</details>
</dd>
<dt id="refinery.arg.merge_all"><code class="name flex">
<span>def <span class="ident">merge_all</span></span>(<span>self, them)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/__init__.py#L363-L371" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def merge_all(self, them: Argument) -&gt; None:
    for key, value in them.kwargs.items():
        if value is arg.delete:
            self.kwargs.pop(key, None)
            continue
        self.kwargs[key] = value
    self.merge_args(them)
    self.guess = self.guess and them.guess
    self.group = self.group or them.group</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Argument" href="units/index.html#refinery.units.Argument">Argument</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Argument.args" href="units/index.html#refinery.units.Argument.args">args</a></code></li>
<li><code><a title="refinery.units.Argument.kwargs" href="units/index.html#refinery.units.Argument.kwargs">kwargs</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.add"><code class="flex name class">
<span>class <span class="ident">add</span></span>
<span>(</span><span>argument, bigendian=False, blocksize=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.blockwise.add" href="units/blockwise/add.html">refinery.units.blockwise.add</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: add [-h] [-Q] [-0] [-v] [-E] [-B N] argument

Add the given argument to each block.

positional arguments:
  argument           A single numeric expression which provides the right
                     argument to the operation, where the left argument is
                     each block in the input data. This argument can also
                     contain a sequence of bytes which is then split into
                     blocks of the same size as the input data and used
                     cyclically.

optional arguments:
  -E, --bigendian    Read chunks in big endian.
  -B, --blocksize N  The size of each block in bytes, default is 1.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/blockwise/add.py#L6-L13" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class add(BinaryOperation):
    &#34;&#34;&#34;
    Add the given argument to each block.
    &#34;&#34;&#34;
    @staticmethod
    def operate(a, b): return a + b
    @staticmethod
    def inplace(a, b): a += b</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.blockwise.BinaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.BinaryOperation">BinaryOperation</a></li>
<li><a title="refinery.units.blockwise.ArithmeticUnit" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit">ArithmeticUnit</a></li>
<li><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.add.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.blockwise.BinaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.BinaryOperation">BinaryOperation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.BinaryOperation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process_block" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation.process_block">process_block</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process_ecb_fast" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit.process_ecb_fast">process_ecb_fast</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.bitrev"><code class="flex name class">
<span>class <span class="ident">bitrev</span></span>
<span>(</span><span>bigendian=False, blocksize=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.blockwise.bitrev" href="units/blockwise/bitrev.html">refinery.units.blockwise.bitrev</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: bitrev [-h] [-Q] [-0] [-v] [-E] [-B N]

Reverse the bits of every block.

optional arguments:
  -E, --bigendian    Read chunks in big endian.
  -B, --blocksize N  The size of each block in bytes, default is 1.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/blockwise/bitrev.py#L6-L40" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class bitrev(UnaryOperation):
    &#34;&#34;&#34;
    Reverse the bits of every block.
    &#34;&#34;&#34;
    @staticmethod
    def operate(arg): pass

    def __init__(self, bigendian=False, blocksize=1):
        &#34;&#34;&#34;
        Unreadable bit reversal operations due to:
        https://graphics.stanford.edu/~seander/bithacks.html#ReverseByteWith64BitsDiv
        https://graphics.stanford.edu/~seander/bithacks.html#ReverseParallel
        &#34;&#34;&#34;
        super().__init__(bigendian=bigendian, blocksize=blocksize)

        if self.bytestream:
            self.operate = lambda v: ((v * 0x202020202) &amp; 0x10884422010) % 1023
        elif self.args.blocksize in (2, 4, 8):
            def operate(v):
                s = self.fbits
                m = self.fmask
                w = v
                while s &gt; 1:
                    s &gt;&gt;= 1
                    m = m ^ (m &lt;&lt; s)
                    w = ((w &lt;&lt; s) &amp; ~m) | ((w &gt;&gt; s) &amp; m)
                return w
            self.operate = operate
        else:
            def operate(v):
                w = v &amp; 0
                for s in range(self.fbits):
                    w |= ((v &gt;&gt; s) &amp; 1) &lt;&lt; (self.fbits - s - 1)
                return w
            self.operate = operate</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.blockwise.UnaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.UnaryOperation">UnaryOperation</a></li>
<li><a title="refinery.units.blockwise.ArithmeticUnit" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit">ArithmeticUnit</a></li>
<li><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.bitrev.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.blockwise.UnaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.UnaryOperation">UnaryOperation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.UnaryOperation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.process_block" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation.process_block">process_block</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.process_ecb_fast" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit.process_ecb_fast">process_ecb_fast</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.blockop"><code class="flex name class">
<span>class <span class="ident">blockop</span></span>
<span>(</span><span>operation, *argument, seed=0, prologue=None, epilogue=None, inc=False, dec=False, cbc=False, bigendian=False, blocksize=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.blockwise.blockop" href="units/blockwise/blockop.html">refinery.units.blockwise.blockop</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: blockop [-h] [-Q] [-0] [-v] [-s SEED] [-p E] [-e E | -I | -D | -X]
               [-E] [-B N]
               operation [argument [argument ...]]

This unit allows you to specify a custom Python expression where the
following variables are allowed.

- the variable A: same as V[0]
- the variable B: current block
- the variable N: number of bytes in the input
- the variable S: an optional seed value for an internal state
- the variable V: the vector of arguments

Each block of the input is replaced by the value of this expression.
Additionally, it is possible to specify prologue and epilogue expressions
which are used to update the state variable S before and after the update
of each block, respectively.

positional arguments:
  operation          A Python expression defining the operation.
  argument           A single numeric expression which provides the right
                     argument to the operation, where the left argument is
                     each block in the input data. This argument can also
                     contain a sequence of bytes which is then split into
                     blocks of the same size as the input data and used
                     cyclically.

optional arguments:
  -s, --seed SEED    Optional seed value for the state variable S. The
                     default is zero. This can be an expression involving
                     the variable N.
  -p, --prologue E   Optional expression with which the state variable S
                     is updated before a block is operated on.
  -e, --epilogue E   Optional expression with which the state variable S
                     is updated after a block was operated on.
  -I, --inc          equivalent to --epilogue=S+1
  -D, --dec          equivalent to --epilogue=S-1
  -X, --cbc          equivalent to --epilogue=(B)
  -E, --bigendian    Read chunks in big endian.
  -B, --blocksize N  The size of each block in bytes, default is 1.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/blockwise/blockop.py#L9-L101" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class blockop(ArithmeticUnit):
    &#34;&#34;&#34;
    This unit allows you to specify a custom Python expression where the following variables are allowed.

    - the variable `A`: same as `V[0]`
    - the variable `B`: current block
    - the variable `N`: number of bytes in the input
    - the variable `S`: an optional seed value for an internal state
    - the variable `V`: the vector of arguments

    Each block of the input is replaced by the value of this expression. Additionally, it is possible to
    specify prologue and epilogue expressions which are used to update the state variable `S` before and
    after the update of each block, respectively.
    &#34;&#34;&#34;

    _PARSER_OPERATION = PythonExpression(&#39;B&#39;, &#39;A&#39;, &#39;S&#39;, &#39;N&#39;, &#39;V&#39;)
    _PARSER_SEEDVALUE = PythonExpression(&#39;N&#39;)

    @staticmethod
    def _parse_op(definition):
        &#34;&#34;&#34;
        An argparse type which uses the `refinery.lib.argformats.PythonExpression` parser to
        parse the expressions that can be passed to `refinery.blockop`. Essentially, these
        are Python expressions which can contain variables `B`, `A`, `S`, and `V`.
        &#34;&#34;&#34;
        def wrapper(B, S, N, *V):
            return wrapper.parsed(B=B, A=V[0], N=N, S=S, V=V) if V else wrapper.parsed(B=B, S=S)
        wrapper.parsed = blockop._PARSER_OPERATION(definition)
        return wrapper

    def __init__(
        self, operation: arg(type=str, help=&#39;A Python expression defining the operation.&#39;), *argument,
        seed: arg(&#39;-s&#39;, type=str, help=(
            &#39;Optional seed value for the state variable S. The default is zero. This can be an expression &#39;
            &#39;involving the variable N.&#39;)) = 0,
        prologue: arg(&#39;-p&#39;, type=str, metavar=&#39;E&#39;, help=(
            &#39;Optional expression with which the state variable S is updated before a block is operated on.&#39;)) = None,
        epilogue: arg(&#39;-e&#39;, type=str, metavar=&#39;E&#39;, group=&#39;EPI&#39;, help=(
            &#39;Optional expression with which the state variable S is updated after a block was operated on.&#39;)) = None,
        inc: arg(&#39;-I&#39;, group=&#39;EPI&#39;, help=&#39;equivalent to --epilogue=S+1&#39;) = False,
        dec: arg(&#39;-D&#39;, group=&#39;EPI&#39;, help=&#39;equivalent to --epilogue=S-1&#39;) = False,
        cbc: arg(&#39;-X&#39;, group=&#39;EPI&#39;, help=&#39;equivalent to --epilogue=(B)&#39;) = False,
        bigendian=False, blocksize=1
    ):
        for flag, flag_is_set, expression in [
            (&#39;--cbc&#39;, cbc, &#39;(B)&#39;),
            (&#39;--inc&#39;, inc, &#39;S+1&#39;),
            (&#39;--dec&#39;, dec, &#39;S-1&#39;),
        ]:
            if flag_is_set:
                if epilogue is not None:
                    raise ValueError(
                        F&#39;Ambiguous specification; epilogue was already set to {epilogue} &#39;
                        F&#39;when {flag} was parsed.&#39;
                    )
                epilogue = expression

        if isinstance(seed, str):
            seed = self._PARSER_SEEDVALUE(seed)

        super().__init__(
            *argument,
            bigendian=bigendian,
            blocksize=blocksize,
            operation=self._parse_op(operation),
            seed=seed,
            prologue=prologue and self._parse_op(prologue),
            epilogue=epilogue and self._parse_op(epilogue),
        )

    @property
    def ecb(self):
        return not self.args.epilogue and not self.args.prologue

    def process_ecb_fast(self, data):
        if not self.ecb:
            raise NoNumpy
        return super().process_ecb_fast(data)

    def process(self, data):
        self._total = len(data)
        self._state = self.args.seed
        if callable(self._state):
            self._state = self._state(N=self._total)
        return super().process(data)

    def operate(self, block, *args):
        if self.args.prologue:
            self._state = self.args.prologue(block, self._state, self._total, *args)
        block = self.args.operation(block, self._state, self._total, *args) &amp; self.fmask
        if self.args.epilogue:
            self._state = self.args.epilogue(block, self._state, self._total, *args)
        return block</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.blockwise.ArithmeticUnit" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit">ArithmeticUnit</a></li>
<li><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.blockop.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.blockwise.ArithmeticUnit" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit">ArithmeticUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.process_ecb_fast" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit.process_ecb_fast">process_ecb_fast</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.blockwise.ArithmeticUnit" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit">ArithmeticUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.process_block" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation.process_block">process_block</a></code></li>
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.blockwise.ArithmeticUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.map"><code class="flex name class">
<span>class <span class="ident">map</span></span>
<span>(</span><span>index, image, blocksize=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.blockwise.map" href="units/blockwise/map.html">refinery.units.blockwise.map</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: map [-h] [-Q] [-0] [-v] [-B N] index image

Each block of the input data which occurs as a block of the index argument
is replaced by the corresponding block of the image argument.

positional arguments:
  index              index characters
  image              image characters

optional arguments:
  -B, --blocksize N  The size of each block in bytes, default is 1.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/blockwise/map.py#L6-L26" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class map(BlockTransformation):
    &#34;&#34;&#34;
    Each block of the input data which occurs as a block of the index argument
    is replaced by the corresponding block of the image argument.
    &#34;&#34;&#34;
    def __init__(
        self,
        index: arg(help=&#39;index characters&#39;),
        image: arg(help=&#39;image characters&#39;),
        blocksize=1
    ):
        super().__init__(blocksize=blocksize, index=index, image=image)

    def process(self, data):
        self._map = dict(zip(
            self.chunk(self.args.index),
            self.chunk(self.args.image)))
        return super().process(data)

    def process_block(self, token):
        return self._map.get(token, token)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.map.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.BlockTransformation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.process_block" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation.process_block">process_block</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.neg"><code class="flex name class">
<span>class <span class="ident">neg</span></span>
<span>(</span><span>bigendian=False, blocksize=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.blockwise.neg" href="units/blockwise/neg.html">refinery.units.blockwise.neg</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: neg [-h] [-Q] [-0] [-v] [-E] [-B N]

Each block of the input data is negated bitwise. This is sometimes also
called the bitwise complement or inverse.

optional arguments:
  -E, --bigendian    Read chunks in big endian.
  -B, --blocksize N  The size of each block in bytes, default is 1.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/blockwise/neg.py#L6-L12" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class neg(UnaryOperation):
    &#34;&#34;&#34;
    Each block of the input data is negated bitwise. This is sometimes
    also called the bitwise complement or inverse.
    &#34;&#34;&#34;
    def operate(self, a): return ~a
    def inplace(self, a): a ^= self.fmask</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.blockwise.UnaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.UnaryOperation">UnaryOperation</a></li>
<li><a title="refinery.units.blockwise.ArithmeticUnit" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit">ArithmeticUnit</a></li>
<li><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.neg.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.blockwise.UnaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.UnaryOperation">UnaryOperation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.UnaryOperation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.process_block" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation.process_block">process_block</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.process_ecb_fast" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit.process_ecb_fast">process_ecb_fast</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.blockwise.UnaryOperation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.pack"><code class="flex name class">
<span>class <span class="ident">pack</span></span>
<span>(</span><span>base=0, hexdump=False, prefix=False, strict=False, bigendian=False, blocksize=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.blockwise.pack" href="units/blockwise/pack.html">refinery.units.blockwise.pack</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: pack [-h] [-R] [-Z] [-Q] [-0] [-v] [-x] [-r] [-s] [-E] [-B N]
            [base]

Scans the input data for numeric constants and packs them into a binary
format. This is useful to convert the textual representation of an array
of numbers into its binary form. For example, 123,34,256,12,1,234 would be
transformed into the byte sequence 7B22000C01EA, where 256 was wrapped and
packed as a null byte because the default block size is one byte. If the
above sequence would be packed with options -EB2, the result would be
equal to 007B00220100000C000100EA in hexadecimal.

positional arguments:
  base               Find only numbers in given base. Default of 0 means
                     that common expressions for hexadecimal, octal and
                     binary are accepted.

optional arguments:
  -x, --hexdump      Parse only pairs of hexadecimal digits surrounded by
                     whitespace.
  -r, --prefix       Add numeric prefixes like 0x, 0b, and 0o in reverse
                     mode.
  -s, --strict       Only parse integers that fit in one block of the
                     given block size.
  -E, --bigendian    Read chunks in big endian.
  -B, --blocksize N  The size of each block in bytes, default is 1.

generic options:
  -h, --help         Show this help message and exit.
  -R, --reverse      Use the reverse operation.
  -Z, --squeeze      Fuse outputs, do not insert line breaks.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/blockwise/pack.py#L11-L88" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class pack(BlockTransformation):
    &#34;&#34;&#34;
    Scans the input data for numeric constants and packs them into a binary
    format. This is useful to convert the textual representation of an array of
    numbers into its binary form. For example, `123,34,256,12,1,234` would be
    transformed into the byte sequence `7B22000C01EA`, where `256` was wrapped
    and packed as a null byte because the default block size is one byte. If
    the above sequence would be packed with options -EB2, the result would be
    equal to `007B00220100000C000100EA` in hexadecimal.
    &#34;&#34;&#34;

    def __init__(self,
        base: arg(type=number[2:36], help=(
            &#39;Find only numbers in given base. Default of 0 means that &#39;
            &#39;common expressions for hexadecimal, octal and binary are &#39;
            &#39;accepted.&#39;)) = 0,
        hexdump : arg.switch(&#39;-x&#39;, help=&#39;Parse only pairs of hexadecimal digits surrounded by whitespace.&#39;) = False,
        prefix  : arg.switch(&#39;-r&#39;, help=&#39;Add numeric prefixes like 0x, 0b, and 0o in reverse mode.&#39;) = False,
        strict  : arg.switch(&#39;-s&#39;, help=&#39;Only parse integers that fit in one block of the given block size.&#39;) = False,
        bigendian=False, blocksize=1
    ):
        super().__init__(
            base=0x10 if hexdump else base,
            hexdump=hexdump,
            prefix=prefix,
            strict=strict,
            bigendian=bigendian,
            blocksize=blocksize
        )

    @property
    def bytestream(self):
        # never alow bytes to be left unchunked
        return False

    def reverse(self, data):
        base = self.args.base or 10
        prefix = B&#39;&#39;

        self.log_debug(F&#39;using base {base:d}&#39;)

        if self.args.prefix:
            prefix = {
                0x02: b&#39;0b&#39;,
                0x08: b&#39;0o&#39;,
                0x10: b&#39;0x&#39;
            }.get(base, B&#39;&#39;)

        converter = base_unit(base, self.args.bigendian)

        for n in self.chunk(data, raw=True):
            yield prefix + converter.reverse(n)

    def process(self, data):
        def intb(integers):
            for n in integers:
                if self.args.base == 0 and n.startswith(B&#39;0&#39;) and n[1:].isdigit():
                    n = B&#39;0o&#39; + n
                N = int(n, self.args.base)
                M = N &amp; self.fmask
                self.log_debug(lambda: F&#39;0x{M:0{self.fbits // 4}X}&#39;)
                if self.args.strict and M != N:
                    continue
                yield M

        if self.args.hexdump:
            pattern = re.compile(
                BR&#39;(?:\W|\s|^)(?:0x)?([0-9a-f]{%i})h?(?=\s|$)&#39; % (self.args.blocksize * 2),
                re.IGNORECASE
            )
        elif self.args.base == 0:
            pattern = formats.integer
        elif self.args.base &lt;= 10:
            pattern = re.compile(B&#39;[-+]?[0-%d]{1,64}&#39; % (self.args.base - 1))
        else:
            pattern = re.compile(B&#39;[-+]?[0-9a-%c]{1,20}&#39; % (0x57 + self.args.base), re.IGNORECASE)

        return self.unchunk(intb(pattern.findall(data)))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.pack.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.BlockTransformation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.process_block" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation.process_block">process_block</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.rev"><code class="flex name class">
<span>class <span class="ident">rev</span></span>
<span>(</span><span>blocksize=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.blockwise.rev" href="units/blockwise/rev.html">refinery.units.blockwise.rev</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: rev [-h] [-Q] [-0] [-v] [-B N]

The blocks of the input data are output in reverse order. If the length of
the input data is not a multiple of the block size, the data is truncated.

optional arguments:
  -B, --blocksize N  The size of each block in bytes, default is 1.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/blockwise/rev.py#L6-L19" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class rev(BlockTransformation):
    &#34;&#34;&#34;
    The blocks of the input data are output in reverse order. If the length of
    the input data is not a multiple of the block size, the data is truncated.
    &#34;&#34;&#34;
    def __init__(self, blocksize=1):
        super().__init__(blocksize=blocksize)

    def process(self, data):
        if self.bytestream:
            return data[::-1]
        else:
            rv = list(self.chunk(data, raw=True))[::-1]
            return self.rest(data) + self.unchunk(rv, raw=True)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.rev.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.BlockTransformation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.process_block" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation.process_block">process_block</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.rotl"><code class="flex name class">
<span>class <span class="ident">rotl</span></span>
<span>(</span><span>argument, bigendian=False, blocksize=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.blockwise.rotl" href="units/blockwise/rotl.html">refinery.units.blockwise.rotl</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: rotl [-h] [-Q] [-0] [-v] [-E] [-B N] argument

Rotate the bits of each block left.

positional arguments:
  argument           A single numeric expression which provides the right
                     argument to the operation, where the left argument is
                     each block in the input data. This argument can also
                     contain a sequence of bytes which is then split into
                     blocks of the same size as the input data and used
                     cyclically.

optional arguments:
  -E, --bigendian    Read chunks in big endian.
  -B, --blocksize N  The size of each block in bytes, default is 1.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/blockwise/rotl.py#L6-L18" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class rotl(BinaryOperation):
    &#34;&#34;&#34;
    Rotate the bits of each block left.
    &#34;&#34;&#34;
    def operate(self, value, shift):
        shift %= self.fbits
        return (value &lt;&lt; shift) | (value &gt;&gt; (self.fbits - shift))

    def inplace(self, value, shift):
        shift %= self.fbits
        lower = value &gt;&gt; (self.fbits - shift)
        value &lt;&lt;= shift
        value |= lower</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.blockwise.BinaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.BinaryOperation">BinaryOperation</a></li>
<li><a title="refinery.units.blockwise.ArithmeticUnit" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit">ArithmeticUnit</a></li>
<li><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.rotl.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.blockwise.BinaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.BinaryOperation">BinaryOperation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.BinaryOperation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process_block" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation.process_block">process_block</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process_ecb_fast" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit.process_ecb_fast">process_ecb_fast</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.rotr"><code class="flex name class">
<span>class <span class="ident">rotr</span></span>
<span>(</span><span>argument, bigendian=False, blocksize=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.blockwise.rotr" href="units/blockwise/rotr.html">refinery.units.blockwise.rotr</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: rotr [-h] [-Q] [-0] [-v] [-E] [-B N] argument

Rotate the bits of each block right.

positional arguments:
  argument           A single numeric expression which provides the right
                     argument to the operation, where the left argument is
                     each block in the input data. This argument can also
                     contain a sequence of bytes which is then split into
                     blocks of the same size as the input data and used
                     cyclically.

optional arguments:
  -E, --bigendian    Read chunks in big endian.
  -B, --blocksize N  The size of each block in bytes, default is 1.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/blockwise/rotr.py#L6-L18" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class rotr(BinaryOperation):
    &#34;&#34;&#34;
    Rotate the bits of each block right.
    &#34;&#34;&#34;
    def operate(self, value, shift):
        shift %= self.fbits
        return (value &gt;&gt; shift) | (value &lt;&lt; (self.fbits - shift))

    def inplace(self, value, shift):
        shift %= self.fbits
        lower = value &gt;&gt; shift
        value &lt;&lt;= self.fbits - shift
        value |= lower</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.blockwise.BinaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.BinaryOperation">BinaryOperation</a></li>
<li><a title="refinery.units.blockwise.ArithmeticUnit" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit">ArithmeticUnit</a></li>
<li><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.rotr.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.blockwise.BinaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.BinaryOperation">BinaryOperation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.BinaryOperation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process_block" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation.process_block">process_block</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process_ecb_fast" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit.process_ecb_fast">process_ecb_fast</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.shl"><code class="flex name class">
<span>class <span class="ident">shl</span></span>
<span>(</span><span>argument, bigendian=False, blocksize=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.blockwise.shl" href="units/blockwise/shl.html">refinery.units.blockwise.shl</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: shl [-h] [-Q] [-0] [-v] [-E] [-B N] argument

Shift the bits of each block left, filling with zero bits.

positional arguments:
  argument           A single numeric expression which provides the right
                     argument to the operation, where the left argument is
                     each block in the input data. This argument can also
                     contain a sequence of bytes which is then split into
                     blocks of the same size as the input data and used
                     cyclically.

optional arguments:
  -E, --bigendian    Read chunks in big endian.
  -B, --blocksize N  The size of each block in bytes, default is 1.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/blockwise/shl.py#L6-L13" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class shl(BinaryOperation):
    &#34;&#34;&#34;
    Shift the bits of each block left, filling with zero bits.
    &#34;&#34;&#34;
    @staticmethod
    def operate(a, b): return a &lt;&lt; b
    @staticmethod
    def inplace(a, b): a &lt;&lt;= b</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.blockwise.BinaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.BinaryOperation">BinaryOperation</a></li>
<li><a title="refinery.units.blockwise.ArithmeticUnit" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit">ArithmeticUnit</a></li>
<li><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.shl.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.blockwise.BinaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.BinaryOperation">BinaryOperation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.BinaryOperation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process_block" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation.process_block">process_block</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process_ecb_fast" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit.process_ecb_fast">process_ecb_fast</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.shr"><code class="flex name class">
<span>class <span class="ident">shr</span></span>
<span>(</span><span>argument, bigendian=False, blocksize=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.blockwise.shr" href="units/blockwise/shr.html">refinery.units.blockwise.shr</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: shr [-h] [-Q] [-0] [-v] [-E] [-B N] argument

Shift the bits of each block right, filling with zero bits.

positional arguments:
  argument           A single numeric expression which provides the right
                     argument to the operation, where the left argument is
                     each block in the input data. This argument can also
                     contain a sequence of bytes which is then split into
                     blocks of the same size as the input data and used
                     cyclically.

optional arguments:
  -E, --bigendian    Read chunks in big endian.
  -B, --blocksize N  The size of each block in bytes, default is 1.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/blockwise/shr.py#L6-L13" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class shr(BinaryOperation):
    &#34;&#34;&#34;
    Shift the bits of each block right, filling with zero bits.
    &#34;&#34;&#34;
    @staticmethod
    def operate(a, b): return a &gt;&gt; b
    @staticmethod
    def inplace(a, b): a &gt;&gt;= b</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.blockwise.BinaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.BinaryOperation">BinaryOperation</a></li>
<li><a title="refinery.units.blockwise.ArithmeticUnit" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit">ArithmeticUnit</a></li>
<li><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.shr.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.blockwise.BinaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.BinaryOperation">BinaryOperation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.BinaryOperation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process_block" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation.process_block">process_block</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process_ecb_fast" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit.process_ecb_fast">process_ecb_fast</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.sub"><code class="flex name class">
<span>class <span class="ident">sub</span></span>
<span>(</span><span>argument, bigendian=False, blocksize=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.blockwise.sub" href="units/blockwise/sub.html">refinery.units.blockwise.sub</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: sub [-h] [-Q] [-0] [-v] [-E] [-B N] argument

Subtract the given argument from each block.

positional arguments:
  argument           A single numeric expression which provides the right
                     argument to the operation, where the left argument is
                     each block in the input data. This argument can also
                     contain a sequence of bytes which is then split into
                     blocks of the same size as the input data and used
                     cyclically.

optional arguments:
  -E, --bigendian    Read chunks in big endian.
  -B, --blocksize N  The size of each block in bytes, default is 1.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/blockwise/sub.py#L6-L13" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class sub(BinaryOperation):
    &#34;&#34;&#34;
    Subtract the given argument from each block.
    &#34;&#34;&#34;
    @staticmethod
    def operate(a, b): return a - b
    @staticmethod
    def inplace(a, b): a -= b</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.blockwise.BinaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.BinaryOperation">BinaryOperation</a></li>
<li><a title="refinery.units.blockwise.ArithmeticUnit" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit">ArithmeticUnit</a></li>
<li><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.sub.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.blockwise.BinaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.BinaryOperation">BinaryOperation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.BinaryOperation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process_block" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation.process_block">process_block</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process_ecb_fast" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit.process_ecb_fast">process_ecb_fast</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.transpose"><code class="flex name class">
<span>class <span class="ident">transpose</span></span>
<span>(</span><span>padding=b'', bigendian=False, blocksize=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.blockwise.transpose" href="units/blockwise/transpose.html">refinery.units.blockwise.transpose</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: transpose [-h] [-Q] [-0] [-v] [-E] [-B N] [padding]

Interprets the sequence of blocks as rows of a matrix and returns the
blocks that correspond to the columns of this matrix.

positional arguments:
  padding            Optional byte sequence to use as padding for tail
                     end.

optional arguments:
  -E, --bigendian    Read chunks in big endian.
  -B, --blocksize N  The size of each block in bytes, default is 1.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/blockwise/transpose.py#L6-L30" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class transpose(BlockTransformation):
    &#34;&#34;&#34;
    Interprets the sequence of blocks as rows of a matrix and returns the
    blocks that correspond to the columns of this matrix.
    &#34;&#34;&#34;
    def __init__(
        self, padding: arg(help=&#39;Optional byte sequence to use as padding for tail end.&#39;) = B&#39;&#39;,
        bigendian=False, blocksize=1
    ):
        super().__init__(bigendian=bigendian, blocksize=blocksize, padding=padding)

    def process(self, data):
        rest = self.rest(data)
        data = list(self.chunk(data, raw=True))

        if self.args.padding:
            while len(rest) &lt; self.args.blocksize:
                rest += self.args.padding
            rest = rest[:self.args.blocksize]
            data.append(rest)
            rest = B&#39;&#39;

        return self.unchunk((
            bytes(data[j][i] for j in range(len(data)))
            for i in range(self.args.blocksize)), raw=True)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.transpose.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.BlockTransformation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.process_block" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation.process_block">process_block</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.blockwise.BlockTransformation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.xor"><code class="flex name class">
<span>class <span class="ident">xor</span></span>
<span>(</span><span>argument, bigendian=False, blocksize=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.blockwise.xor" href="units/blockwise/xor.html">refinery.units.blockwise.xor</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: xor [-h] [-Q] [-0] [-v] [-E] [-B N] argument

Form the exclusive or of the input data with the given argument.

positional arguments:
  argument           A single numeric expression which provides the right
                     argument to the operation, where the left argument is
                     each block in the input data. This argument can also
                     contain a sequence of bytes which is then split into
                     blocks of the same size as the input data and used
                     cyclically.

optional arguments:
  -E, --bigendian    Read chunks in big endian.
  -B, --blocksize N  The size of each block in bytes, default is 1.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/blockwise/xor.py#L6-L27" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class xor(BinaryOperation):
    &#34;&#34;&#34;
    Form the exclusive or of the input data with the given argument.
    &#34;&#34;&#34;
    def process_ecb_fast(self, data):
        try:
            return super().process_ecb_fast(data)
        except NoNumpy as E:
            try:
                from Crypto.Util.strxor import strxor
            except ModuleNotFoundError:
                raise E
            else:
                from itertools import islice, cycle
                take = len(data) // self.args.blocksize + 1
                argb = self.unchunk(islice(cycle(x &amp; self.fmask for x in self.args.argument[0]), take))
                return strxor(data, argb[:len(data)])

    @staticmethod
    def operate(a, b): return a ^ b
    @staticmethod
    def inplace(a, b): a ^= b</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.blockwise.BinaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.BinaryOperation">BinaryOperation</a></li>
<li><a title="refinery.units.blockwise.ArithmeticUnit" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit">ArithmeticUnit</a></li>
<li><a title="refinery.units.blockwise.BlockTransformation" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation">BlockTransformation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.xor.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.blockwise.BinaryOperation" href="units/blockwise/index.html#refinery.units.blockwise.BinaryOperation">BinaryOperation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.blockwise.BinaryOperation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process_block" href="units/blockwise/index.html#refinery.units.blockwise.BlockTransformation.process_block">process_block</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.process_ecb_fast" href="units/blockwise/index.html#refinery.units.blockwise.ArithmeticUnit.process_ecb_fast">process_ecb_fast</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.blockwise.BinaryOperation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.aplib"><code class="flex name class">
<span>class <span class="ident">aplib</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.compression.ap" href="units/compression/ap.html">refinery.units.compression.ap</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: aplib [-h] [-R] [-Q] [-0] [-v]

APLib compression and decompression.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/compression/ap.py#L281-L290" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class aplib(Unit):
    &#34;&#34;&#34;
    APLib compression and decompression.
    &#34;&#34;&#34;

    def reverse(self, buf):
        return compressor(buf).compress()

    def process(self, buf):
        return decompressor(buf).decompress()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.aplib.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.bz2"><code class="flex name class">
<span>class <span class="ident">bz2</span></span>
<span>(</span><span>level=9)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.compression.bz2" href="units/compression/bz2.html">refinery.units.compression.bz2</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: bz2 [-h] [-R] [-Q] [-0] [-v] [-l LEVEL]

BZip2 compression and decompression.

optional arguments:
  -l, --level LEVEL  compression level preset between 1 and 9

generic options:
  -h, --help         Show this help message and exit.
  -R, --reverse      Use the reverse operation.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/compression/bz2.py#L9-L20" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class bz2(Unit):
    &#34;&#34;&#34;
    BZip2 compression and decompression.
    &#34;&#34;&#34;
    def __init__(self, level: arg(&#39;-l&#39;, type=number[1:9], help=&#39;compression level preset between 1 and 9&#39;) = 9):
        super().__init__(level=level)

    def process(self, data):
        return bz2_.decompress(data)

    def reverse(self, data):
        return bz2_.compress(data, self.args.level)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.bz2.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.decompress"><code class="flex name class">
<span>class <span class="ident">decompress</span></span>
<span>(</span><span>prepend=True, tolerance=12, min_ratio=1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.compression.decompress" href="units/compression/decompress.html">refinery.units.compression.decompress</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: decompress [-h] [-Q] [-0] [-v] [-P] [-t N] [-r R]

Attempts all available decompression units against the input and returns
the output of the first successful one. If none succeeds, the data is
returned unaltered. The process is heavily biased against LZNT1
decompression due to a large tendency for LZNT1 false positives.

optional arguments:
  -P, --no-prepend   By default, if decompression fails, the unit attempts
                     to prefix the data with all possible values of a
                     single byte and decompress the result. This behavior
                     can be disabled with this flag.
  -t, --tolerance N  Maximum number of bytes to strip from the beginning
                     of the data; The default value is 12.
  -r, --min-ratio R  To determine whether a decompression algorithm was
                     successful, the ratio of compressed size to
                     decompressed size is required to be at least this
                     number, a floating point value R; default value is 1.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/compression/decompress.py#L14-L105" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class decompress(Unit):
    &#34;&#34;&#34;
    Attempts all available decompression units against the input and returns
    the output of the first successful one. If none succeeds, the data is
    returned unaltered. The process is heavily biased against LZNT1 decompression
    due to a large tendency for LZNT1 false positives.
    &#34;&#34;&#34;
    def __init__(
        self,
        prepend: arg.switch(&#39;-P&#39;, &#39;--no-prepend&#39;, off=True, help=(
            &#39;By default, if decompression fails, the unit attempts to prefix &#39;
            &#39;the data with all possible values of a single byte and decompress &#39;
            &#39;the result. This behavior can be disabled with this flag.&#39;)
        ) = True,
        tolerance: arg.number(&#39;-t&#39;, help=(
            &#39;Maximum number of bytes to strip from the beginning of the data; &#39;
            &#39;The default value is 12.&#39;)
        ) = 12,
        min_ratio: arg(&#39;-r&#39;, metavar=&#39;R&#39;, help=(
            &#39;To determine whether a decompression algorithm was successful, the &#39;
            &#39;ratio of compressed size to decompressed size is required to be at &#39;
            &#39;least this number, a floating point value R; default value is 1.&#39;)
        ) = 1,
    ):
        if min_ratio &lt;= 0:
            raise ValueError(&#39;The compression factor must be nonnegative.&#39;)
        super().__init__(tolerance=tolerance, prepend=prepend, min_ratio=min_ratio)
        self.engines = [
            engine() for engine in [zl, lzma, aplib, gz, bz2, lznt1]
        ]

    def process(self, data):
        best = None
        current_ratio = 1

        class result:
            _MIN_RATIO = self.args.min_ratio
            _LOG_DEBUG = self.log_debug

            def __init__(self, engine, cutoff=0, prefix=None):
                feed = data

                self.engine = engine
                self.prefix = prefix
                self.cutoff = cutoff

                if cutoff:
                    feed = data[cutoff:]
                if prefix is not None:
                    feed = prefix + data

                try:
                    self.result = engine.process(feed)
                except Exception:
                    self.result = B&#39;&#39;

                if not self.result:
                    self.ratio = INF
                else:
                    self.ratio = len(data) / len(self.result)

            @property
            def unmodified(self):
                return not self.prefix and not self.cutoff

            def schedule(self):
                nonlocal best, current_ratio
                if self.ratio &gt;= self._MIN_RATIO:
                    return
                prefix = hex(self.prefix[0]) if self.prefix else None
                r = 1 if self.unmodified and best and not best.unmodified else 0.9
                if self.engine.__class__ is lznt1:
                    r /= 2
                if not best or self.ratio / current_ratio &lt; r:
                    self._LOG_DEBUG(
                        F&#39;obtained {self.ratio:.2f} compression ratio with: prefix={prefix}, &#39;
                        F&#39;cutoff={self.cutoff}, engine={self.engine.name}&#39;)
                    best = self
                    current_ratio = self.ratio

        for engine in self.engines:
            for t in range(self.args.tolerance):
                result(engine, t).schedule()
            if self.args.prepend:
                for p in range(0x100):
                    result(engine, 0, bytes((p,))).schedule()

        if best is None:
            self.log_info(&#39;nothing worked, returning original data.&#39;)
            return data

        return best.result</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.decompress.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.gz"><code class="flex name class">
<span>class <span class="ident">gz</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.compression.gz" href="units/compression/gz.html">refinery.units.compression.gz</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: gz [-h] [-R] [-Q] [-0] [-v]

GZip compression and decompression.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/compression/gz.py#L8-L17" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class gz(Unit):
    &#34;&#34;&#34;
    GZip compression and decompression.
    &#34;&#34;&#34;

    def process(self, data):
        return gzip.decompress(data)

    def reverse(self, data):
        return gzip.compress(data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.gz.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.lzma"><code class="flex name class">
<span>class <span class="ident">lzma</span></span>
<span>(</span><span>filter=None, raw=False, alone=False, xz=False, level=9, delta=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.compression.lz" href="units/compression/lz.html">refinery.units.compression.lz</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: lzma [-h] [-R] [-Q] [-0] [-v] [-r | -a | -x] [-l N] [-d N] [FILTER]

LZMA compression and decompression.

positional arguments:
  FILTER         Specifies a bcj filter to be applied. Possible values
                 are: ARM, ARMTHUMB, IA64, LZMA1, LZMA2, POWERPC, SPARC,
                 X86

optional arguments:
  -r, --raw      Use raw (no container) format.
  -a, --alone    Use the lzma container format.
  -x, --xz       Use the default xz format.
  -l, --level N  The compression level preset; between 0 and 9.
  -d, --delta N  Add a delta filter when compressing.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/compression/lz.py#L11-L83" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class lzma(Unit):
    &#34;&#34;&#34;
    LZMA compression and decompression.
    &#34;&#34;&#34;
    _LZMA_FILTER = extract_options(lzma_, &#39;FILTER_&#39;, &#39;DELTA&#39;)
    _LZMA_PARSER = OptionFactory(_LZMA_FILTER)

    def __init__(
        self, filter: arg.choice(choices=list(_LZMA_FILTER), metavar=&#39;FILTER&#39;, help=(
            &#39;Specifies a bcj filter to be applied. Possible values are: {choices}&#39;)) = None,
        raw   : arg.switch(&#39;-r&#39;, group=&#39;MODE&#39;, help=&#39;Use raw (no container) format.&#39;) = False,
        alone : arg.switch(&#39;-a&#39;, group=&#39;MODE&#39;, help=&#39;Use the lzma container format.&#39;) = False,
        xz    : arg.switch(&#39;-x&#39;, group=&#39;MODE&#39;, help=&#39;Use the default xz format.&#39;) = False,
        level : arg.number(&#39;-l&#39;, bound=(0, 9), help=&#39;The compression level preset; between 0 and 9.&#39;) = 9,
        delta : arg.number(&#39;-d&#39;, help=&#39;Add a delta filter when compressing.&#39;) = None,
    ):
        filter = filter and self._LZMA_PARSER(filter)
        if (raw, alone, xz).count(True) &gt; 1:
            raise ValueError(&#39;Only one container format can be enabled.&#39;)
        if level not in range(10):
            raise ValueError(&#39;Compression level must be a number between 0 and 9.&#39;)
        super().__init__(filter=filter, raw=raw, alone=alone, xz=xz, delta=delta,
            level=level | lzma_.PRESET_EXTREME)

    def _get_lz_mode_and_filters(self, reverse=False):
        mode = lzma_.FORMAT_AUTO
        filters = []
        if self.args.filter is not None:
            filters.append({&#39;id&#39;: self.args.filter.value})
        if self.args.delta is not None:
            self.log_debug(&#39;adding delta filter&#39;)
            filters.append({
                &#39;id&#39;: lzma_.FILTER_DELTA,
                &#39;dist&#39;: self.args.delta
            })
        if self.args.alone:
            self.log_debug(&#39;setting alone format&#39;)
            mode = lzma_.FORMAT_ALONE
            filters.append({
                &#39;id&#39;: lzma_.FILTER_LZMA1,
                &#39;preset&#39;: self.args.level
            })
        elif self.args.raw:
            self.log_debug(&#39;setting raw format&#39;)
            mode = lzma_.FORMAT_RAW
            filters.append({
                &#39;id&#39;: lzma_.FILTER_LZMA2,
                &#39;preset&#39;: self.args.level
            })
        elif self.args.xz or reverse:
            if reverse and not self.log_debug(&#39;setting xz container format&#39;):
                self.log_info(&#39;choosing default .xz container format for compression.&#39;)
            mode = lzma_.FORMAT_XZ
            filters.append({
                &#39;id&#39;: lzma_.FILTER_LZMA2,
                &#39;preset&#39;: self.args.level
            })
        return mode, filters

    def reverse(self, data):
        mode, filters = self._get_lz_mode_and_filters(True)
        lz = lzma_.LZMACompressor(mode, filters=filters)
        output = lz.compress(data)
        output += lz.flush()
        return output

    def process(self, data):
        keywords = {}
        mode, filters = self._get_lz_mode_and_filters(False)
        if self.args.raw:
            keywords[&#39;filters&#39;] = filters
        lz = lzma_.LZMADecompressor(mode, **keywords)
        return lz.decompress(data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.lzma.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.lznt1"><code class="flex name class">
<span>class <span class="ident">lznt1</span></span>
<span>(</span><span>chunk_size=4096)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.compression.lznt1" href="units/compression/lznt1.html">refinery.units.compression.lznt1</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: lznt1 [-h] [-R] [-Q] [-0] [-v] [-c N]

LZNT1 compression and decompression. This compression algorithm is
expected by the Win32 API routine RtlDecompressBuffer, for example.

optional arguments:
  -c, --chunk-size N  Optionally specify the chunk size for compression,
                      default is 0x1000.

generic options:
  -h, --help          Show this help message and exit.
  -R, --reverse       Use the reverse operation.
  -Q, --quiet         Disables all log output.
  -0, --devnull       Do not produce any output.
  -v, --verbose       Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/compression/lznt1.py#L10-L148" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class lznt1(Unit):
    &#34;&#34;&#34;
    LZNT1 compression and decompression. This compression algorithm is expected
    by the Win32 API routine `RtlDecompressBuffer`, for example.
    &#34;&#34;&#34;

    def _decompress_chunk(self, chunk):
        out = B&#39;&#39;
        while chunk:
            flags = chunk[0]
            chunk = chunk[1:]
            for i in range(8):
                if not (flags &gt;&gt; i &amp; 1):
                    out += chunk[:1]
                    chunk = chunk[1:]
                else:
                    flag = struct.unpack(&#39;&lt;H&#39;, chunk[:2])[0]
                    pos = len(out) - 1
                    l_mask = 0xFFF
                    o_shift = 12
                    while pos &gt;= 0x10:
                        l_mask &gt;&gt;= 1
                        o_shift -= 1
                        pos &gt;&gt;= 1
                    length = (flag &amp; l_mask) + 3
                    offset = (flag &gt;&gt; o_shift) + 1
                    if length &gt;= offset:
                        tmp = out[-offset:] * (0xFFF // len(out[-offset:]) + 1)
                        out += tmp[:length]
                    else:
                        out += out[-offset:length - offset]
                    chunk = chunk[2:]
                if len(chunk) == 0:
                    break
        return out

    def _find(self, src, target, max_len):
        result_offset = 0
        result_length = 0
        for i in range(1, max_len):
            offset = src.rfind(target[:i])
            if offset == -1:
                break
            tmp_offset = len(src) - offset
            tmp_length = i
            if tmp_offset == tmp_length:
                tmp = src[offset:] * (0xFFF // len(src[offset:]) + 1)
                for j in range(i, max_len + 1):
                    offset = tmp.rfind(target[:j])
                    if offset == -1:
                        break
                    tmp_length = j
            if tmp_length &gt; result_length:
                result_offset = tmp_offset
                result_length = tmp_length
        if result_length &lt; 3:
            return 0, 0
        return result_offset, result_length

    def _compress_chunk(self, chunk):
        blob = copy.copy(chunk)
        out = B&#39;&#39;
        pow2 = 0x10
        l_mask3 = 0x1002
        o_shift = 12
        while len(blob) &gt; 0:
            bits = 0
            tmp = B&#39;&#39;
            for i in range(8):
                bits &gt;&gt;= 1
                while pow2 &lt; (len(chunk) - len(blob)):
                    pow2 &lt;&lt;= 1
                    l_mask3 = (l_mask3 &gt;&gt; 1) + 1
                    o_shift -= 1
                if len(blob) &lt; l_mask3:
                    max_len = len(blob)
                else:
                    max_len = l_mask3
                offset1, length1 = self._find(
                    chunk[:len(chunk) - len(blob)], blob, max_len)
                # try to find more compressed pattern
                offset2, length2 = self._find(
                    chunk[:len(chunk) - len(blob) + 1], blob[1:], max_len)
                if length1 &lt; length2:
                    length1 = 0
                if length1 &gt; 0:
                    symbol = ((offset1 - 1) &lt;&lt; o_shift) | (length1 - 3)
                    tmp += struct.pack(&#39;&lt;H&#39;, symbol)
                    bits |= 0x80  # set the highest bit
                    blob = blob[length1:]
                else:
                    tmp += blob[:1]
                    blob = blob[1:]
                if len(blob) == 0:
                    break
            out += struct.pack(&#39;B&#39;, bits &gt;&gt; (7 - i))
            out += tmp
        return out

    def reverse(self, buf):
        out = B&#39;&#39;
        while buf:
            chunk = buf[:self.args.chunk_size]
            compressed = self._compress_chunk(chunk)
            if len(compressed) &lt; len(chunk):  # chunk is compressed
                flags = 0xB000
                header = struct.pack(&#39;&lt;H&#39;, flags | (len(compressed) - 1))
                out += header + compressed
            else:
                flags = 0x3000
                header = struct.pack(&#39;&lt;H&#39;, flags | (len(chunk) - 1))
                out += header + chunk
            buf = buf[self.args.chunk_size:]
        return out

    def process(self, data):
        out = io.BytesIO()
        offset = 0
        while offset &lt; len(data):
            try:
                header, = struct.unpack(&#39;&lt;H&#39;, data[offset:offset + 2])
            except struct.error as err:
                raise RefineryPartialResult(str(err), partial=out.getvalue())
            offset += 2
            size = (header &amp; 0xFFF) + 1
            if size + 1 &gt;= len(data):
                raise RefineryPartialResult(
                    F&#39;chunk header indicates size {size}, but only {len(data)} bytes remain.&#39;,
                    partial=out.getvalue()
                )
            chunk = data[offset:offset + size]
            offset += size
            if header &amp; 0x8000:
                chunk = self._decompress_chunk(chunk)
            out.write(chunk)
        return out.getvalue()

    def __init__(self, chunk_size: arg.number(&#39;-c&#39;, help=&#39;Optionally specify the chunk size for compression, default is 0x1000.&#39;) = 0x1000):
        super().__init__(chunk_size=chunk_size)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.lznt1.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.zl"><code class="flex name class">
<span>class <span class="ident">zl</span></span>
<span>(</span><span>level=9, window=15, force=False, zlib_header=False, gzip_header=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.compression.zl" href="units/compression/zl.html">refinery.units.compression.zl</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: zl [-h] [-R] [-Q] [-0] [-v] [-l N] [-w N] [-f] [-z | -g]

ZLib compression and decompression.

optional arguments:
  -l, --level N      Specify a compression level between 0 and 9.
  -w, --window N     Manually specify the window size between 8 and 15.
  -f, --force        Decompress as far as possible, even if all known
                     methods fail.
  -z, --zlib-header  Use a ZLIB header.
  -g, --gzip-header  Use a GZIP header.

generic options:
  -h, --help         Show this help message and exit.
  -R, --reverse      Use the reverse operation.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/compression/zl.py#L8-L60" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class zl(Unit):
    &#34;&#34;&#34;
    ZLib compression and decompression.
    &#34;&#34;&#34;

    def __init__(
        self,
        level  : arg.number(&#39;-l&#39;, bound=(0, 0X9), help=&#39;Specify a compression level between 0 and 9.&#39;) = 9,
        window : arg.number(&#39;-w&#39;, bound=(8, 0XF), help=&#39;Manually specify the window size between 8 and 15.&#39;) = 15,
        force  : arg.switch(&#39;-f&#39;, help=&#39;Decompress as far as possible, even if all known methods fail.&#39;) = False,
        zlib_header: arg.switch(&#39;-z&#39;, group=&#39;MODE&#39;, help=&#39;Use a ZLIB header.&#39;) = False,
        gzip_header: arg.switch(&#39;-g&#39;, group=&#39;MODE&#39;, help=&#39;Use a GZIP header.&#39;) = False
    ):
        if zlib_header and gzip_header:
            raise ValueError(&#39;You can only specify one header type (ZLIB or GZIP).&#39;)
        return super().__init__(level=level, window=window, force=force, zlib_header=zlib_header, gzip_header=gzip_header)

    def _force_decompress(self, data, mode):
        z = zlib.decompressobj(mode)

        def as_many_as_possible():
            for k in range(len(data)):
                try: yield z.decompress(data[k : k + 1])
                except zlib.error: break

        return B&#39;&#39;.join(as_many_as_possible())

    def process(self, data):
        if data[0] == 0x78 or data[0:2] == B&#39;\x1F\x8B&#39; or self.args.zlib_header or self.args.gzip_header:
            mode_candidates = [self.args.window | 0x20, -self.args.window, 0]
        else:
            mode_candidates = [-self.args.window, self.args.window | 0x20, 0]
        for mode in mode_candidates:
            self.log_info(F&#39;using mode {mode:+2d} for decompression&#39;)
            try:
                z = zlib.decompressobj(mode)
                return z.decompress(data)
            except zlib.error:
                pass
        if self.args.force:
            return self._force_decompress(data, mode_candidates[0])
        raise ValueError(&#39;could not detect any zlib stream.&#39;)

    def reverse(self, data):
        mode = -self.args.window
        if self.args.zlib_header:
            mode = -mode
        if self.args.gzip_header:
            mode = -mode | 0x10
        self.log_info(F&#39;using mode {mode:+2d} for compression&#39;)
        zl = zlib.compressobj(self.args.level, zlib.DEFLATED, mode)
        zz = zl.compress(data)
        return zz + zl.flush(zlib.Z_FINISH)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.zl.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.aes"><code class="flex name class">
<span>class <span class="ident">aes</span></span>
<span>(</span><span>mode, key, iv=b'', padding=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.aes" href="units/crypto/cipher/aes.html">refinery.units.crypto.cipher.aes</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: aes [-h] [-R] [-Q] [-0] [-v] [-I IV] [-P ALG] mode key

AES encryption and decryption.

positional arguments:
  mode               Choose cipher mode to be used. Possible values are:
                     CBC, CCM, CFB, CTR, EAX, ECB, GCM, OCB, OFB, OPENPGP,
                     SIV.
  key                The encryption key.

optional arguments:
  -I, --iv IV        Specifies the initialization vector. If none is
                     specified, then a block of zero bytes is used.
  -P, --padding ALG  Choose a padding algorithm (PKCS7, ISO7816, X923,
                     RAW). The RAW algorithm does nothing. By default, all
                     other algorithms are attempted. In most cases, the
                     data was not correctly decrypted if none of these
                     work.

generic options:
  -h, --help         Show this help message and exit.
  -R, --reverse      Use the reverse operation.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/aes.py#L8-L12" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class aes(StandardBlockCipherUnit, cipher=AES):
    &#34;&#34;&#34;
    AES encryption and decryption.
    &#34;&#34;&#34;
    pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardBlockCipherUnit">StandardBlockCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.BlockCipherUnitBase" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.BlockCipherUnitBase">BlockCipherUnitBase</a></li>
<li><a title="refinery.units.crypto.cipher.StandardCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardCipherUnit">StandardCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.CipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.CipherUnit">CipherUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.aes.blocksize"><code class="name">var <span class="ident">blocksize</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.aes.key_sizes"><code class="name">var <span class="ident">key_sizes</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.aes.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.aes.stdcipher"><code class="name">var <span class="ident">stdcipher</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.aes.modespec"><code class="name">var <span class="ident">modespec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardBlockCipherUnit">StandardBlockCipherUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.blowfish"><code class="flex name class">
<span>class <span class="ident">blowfish</span></span>
<span>(</span><span>mode, key, iv=b'', padding=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.blowfish" href="units/crypto/cipher/blowfish.html">refinery.units.crypto.cipher.blowfish</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: blowfish [-h] [-R] [-Q] [-0] [-v] [-I IV] [-P ALG] mode key

Blowfish encryption and decryption.

positional arguments:
  mode               Choose cipher mode to be used. Possible values are:
                     CBC, CFB, CTR, EAX, ECB, OFB, OPENPGP.
  key                The encryption key.

optional arguments:
  -I, --iv IV        Specifies the initialization vector. If none is
                     specified, then a block of zero bytes is used.
  -P, --padding ALG  Choose a padding algorithm (PKCS7, ISO7816, X923,
                     RAW). The RAW algorithm does nothing. By default, all
                     other algorithms are attempted. In most cases, the
                     data was not correctly decrypted if none of these
                     work.

generic options:
  -h, --help         Show this help message and exit.
  -R, --reverse      Use the reverse operation.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/blowfish.py#L8-L12" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class blowfish(StandardBlockCipherUnit, cipher=Blowfish):
    &#34;&#34;&#34;
    Blowfish encryption and decryption.
    &#34;&#34;&#34;
    pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardBlockCipherUnit">StandardBlockCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.BlockCipherUnitBase" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.BlockCipherUnitBase">BlockCipherUnitBase</a></li>
<li><a title="refinery.units.crypto.cipher.StandardCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardCipherUnit">StandardCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.CipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.CipherUnit">CipherUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.blowfish.blocksize"><code class="name">var <span class="ident">blocksize</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.blowfish.key_sizes"><code class="name">var <span class="ident">key_sizes</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.blowfish.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.blowfish.stdcipher"><code class="name">var <span class="ident">stdcipher</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.blowfish.modespec"><code class="name">var <span class="ident">modespec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardBlockCipherUnit">StandardBlockCipherUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.cast"><code class="flex name class">
<span>class <span class="ident">cast</span></span>
<span>(</span><span>mode, key, iv=b'', padding=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.cast" href="units/crypto/cipher/cast.html">refinery.units.crypto.cipher.cast</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: cast [-h] [-R] [-Q] [-0] [-v] [-I IV] [-P ALG] mode key

CAST encryption and decryption.

positional arguments:
  mode               Choose cipher mode to be used. Possible values are:
                     CBC, CFB, CTR, EAX, ECB, OFB, OPENPGP.
  key                The encryption key.

optional arguments:
  -I, --iv IV        Specifies the initialization vector. If none is
                     specified, then a block of zero bytes is used.
  -P, --padding ALG  Choose a padding algorithm (PKCS7, ISO7816, X923,
                     RAW). The RAW algorithm does nothing. By default, all
                     other algorithms are attempted. In most cases, the
                     data was not correctly decrypted if none of these
                     work.

generic options:
  -h, --help         Show this help message and exit.
  -R, --reverse      Use the reverse operation.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/cast.py#L8-L12" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class cast(StandardBlockCipherUnit, cipher=CAST):
    &#34;&#34;&#34;
    CAST encryption and decryption.
    &#34;&#34;&#34;
    pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardBlockCipherUnit">StandardBlockCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.BlockCipherUnitBase" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.BlockCipherUnitBase">BlockCipherUnitBase</a></li>
<li><a title="refinery.units.crypto.cipher.StandardCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardCipherUnit">StandardCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.CipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.CipherUnit">CipherUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.cast.blocksize"><code class="name">var <span class="ident">blocksize</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.cast.key_sizes"><code class="name">var <span class="ident">key_sizes</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.cast.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.cast.stdcipher"><code class="name">var <span class="ident">stdcipher</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.cast.modespec"><code class="name">var <span class="ident">modespec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardBlockCipherUnit">StandardBlockCipherUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.chacha"><code class="flex name class">
<span>class <span class="ident">chacha</span></span>
<span>(</span><span>key, nonce=b'REFINERY')</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.chacha" href="units/crypto/cipher/chacha.html">refinery.units.crypto.cipher.chacha</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: chacha [-h] [-R] [-Q] [-0] [-v] [-N NONCE] key

ChaCha20 and XChaCha20 encryption and decryption. For ChaCha20, the IV
(nonce) must be 8 or 12 bytes long; for XChaCha20, choose an IV which is
24 bytes long. The default IV value is the string value REFINERY.

positional arguments:
  key                The encryption key.

optional arguments:
  -N, --nonce NONCE  Specify the one-time use nonce; the default value is
                     &quot;REFINERY&quot;.

generic options:
  -h, --help         Show this help message and exit.
  -R, --reverse      Use the reverse operation.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/chacha.py#L8-L14" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class chacha(LatinStreamCipher, cipher=ChaCha20):
    &#34;&#34;&#34;
    ChaCha20 and XChaCha20 encryption and decryption. For ChaCha20, the IV
    (nonce) must be 8 or 12 bytes long; for XChaCha20, choose an IV which is
    24 bytes long. The default IV value is the string value `REFINERY`.
    &#34;&#34;&#34;
    pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.cipher.LatinStreamCipher" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.LatinStreamCipher">LatinStreamCipher</a></li>
<li><a title="refinery.units.crypto.cipher.StandardCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardCipherUnit">StandardCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.CipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.CipherUnit">CipherUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.chacha.blocksize"><code class="name">var <span class="ident">blocksize</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.chacha.key_sizes"><code class="name">var <span class="ident">key_sizes</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.chacha.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.chacha.stdcipher"><code class="name">var <span class="ident">stdcipher</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.cipher.LatinStreamCipher" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.LatinStreamCipher">LatinStreamCipher</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.des"><code class="flex name class">
<span>class <span class="ident">des</span></span>
<span>(</span><span>mode, key, iv=b'', padding=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.des" href="units/crypto/cipher/des.html">refinery.units.crypto.cipher.des</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: des [-h] [-R] [-Q] [-0] [-v] [-I IV] [-P ALG] mode key

DES encryption and decryption.

positional arguments:
  mode               Choose cipher mode to be used. Possible values are:
                     CBC, CFB, CTR, EAX, ECB, OFB, OPENPGP.
  key                The encryption key.

optional arguments:
  -I, --iv IV        Specifies the initialization vector. If none is
                     specified, then a block of zero bytes is used.
  -P, --padding ALG  Choose a padding algorithm (PKCS7, ISO7816, X923,
                     RAW). The RAW algorithm does nothing. By default, all
                     other algorithms are attempted. In most cases, the
                     data was not correctly decrypted if none of these
                     work.

generic options:
  -h, --help         Show this help message and exit.
  -R, --reverse      Use the reverse operation.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/des.py#L8-L12" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class des(StandardBlockCipherUnit, cipher=DES):
    &#34;&#34;&#34;
    DES encryption and decryption.
    &#34;&#34;&#34;
    pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardBlockCipherUnit">StandardBlockCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.BlockCipherUnitBase" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.BlockCipherUnitBase">BlockCipherUnitBase</a></li>
<li><a title="refinery.units.crypto.cipher.StandardCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardCipherUnit">StandardCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.CipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.CipherUnit">CipherUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.des.blocksize"><code class="name">var <span class="ident">blocksize</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.des.key_sizes"><code class="name">var <span class="ident">key_sizes</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.des.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.des.stdcipher"><code class="name">var <span class="ident">stdcipher</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.des.modespec"><code class="name">var <span class="ident">modespec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardBlockCipherUnit">StandardBlockCipherUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.des3"><code class="flex name class">
<span>class <span class="ident">des3</span></span>
<span>(</span><span>mode, key, iv=b'', padding=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.des3" href="units/crypto/cipher/des3.html">refinery.units.crypto.cipher.des3</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: des3 [-h] [-R] [-Q] [-0] [-v] [-I IV] [-P ALG] mode key

3-DES encryption and decryption.

positional arguments:
  mode               Choose cipher mode to be used. Possible values are:
                     CBC, CFB, CTR, EAX, ECB, OFB, OPENPGP.
  key                The encryption key.

optional arguments:
  -I, --iv IV        Specifies the initialization vector. If none is
                     specified, then a block of zero bytes is used.
  -P, --padding ALG  Choose a padding algorithm (PKCS7, ISO7816, X923,
                     RAW). The RAW algorithm does nothing. By default, all
                     other algorithms are attempted. In most cases, the
                     data was not correctly decrypted if none of these
                     work.

generic options:
  -h, --help         Show this help message and exit.
  -R, --reverse      Use the reverse operation.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/des3.py#L8-L12" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class des3(StandardBlockCipherUnit, cipher=DES3):
    &#34;&#34;&#34;
    3-DES encryption and decryption.
    &#34;&#34;&#34;
    pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardBlockCipherUnit">StandardBlockCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.BlockCipherUnitBase" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.BlockCipherUnitBase">BlockCipherUnitBase</a></li>
<li><a title="refinery.units.crypto.cipher.StandardCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardCipherUnit">StandardCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.CipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.CipherUnit">CipherUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.des3.blocksize"><code class="name">var <span class="ident">blocksize</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.des3.key_sizes"><code class="name">var <span class="ident">key_sizes</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.des3.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.des3.stdcipher"><code class="name">var <span class="ident">stdcipher</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.des3.modespec"><code class="name">var <span class="ident">modespec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardBlockCipherUnit">StandardBlockCipherUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.hc128"><code class="flex name class">
<span>class <span class="ident">hc128</span></span>
<span>(</span><span>key)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.hc128" href="units/crypto/cipher/hc128.html">refinery.units.crypto.cipher.hc128</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: hc128 [-h] [-R] [-Q] [-0] [-v] key

HC-128 encryption and decryption.

positional arguments:
  key            The encryption key.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/hc128.py#L79-L86" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class hc128(StreamCipherUnit):
    &#34;&#34;&#34;
    HC-128 encryption and decryption.
    &#34;&#34;&#34;
    key_sizes = 32

    def keystream(self) -&gt; Iterable[int]:
        return hc128cipher(self.key)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.cipher.StreamCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StreamCipherUnit">StreamCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.CipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.CipherUnit">CipherUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.hc128.key_sizes"><code class="name">var <span class="ident">key_sizes</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.hc128.blocksize"><code class="name">var <span class="ident">blocksize</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.hc128.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.cipher.StreamCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StreamCipherUnit">StreamCipherUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.rc2"><code class="flex name class">
<span>class <span class="ident">rc2</span></span>
<span>(</span><span>mode, key, iv=b'', padding=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.rc2" href="units/crypto/cipher/rc2.html">refinery.units.crypto.cipher.rc2</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: rc2 [-h] [-R] [-Q] [-0] [-v] [-I IV] [-P ALG] mode key

RC2 encryption and decryption.

positional arguments:
  mode               Choose cipher mode to be used. Possible values are:
                     CBC, CFB, CTR, EAX, ECB, OFB, OPENPGP.
  key                The encryption key.

optional arguments:
  -I, --iv IV        Specifies the initialization vector. If none is
                     specified, then a block of zero bytes is used.
  -P, --padding ALG  Choose a padding algorithm (PKCS7, ISO7816, X923,
                     RAW). The RAW algorithm does nothing. By default, all
                     other algorithms are attempted. In most cases, the
                     data was not correctly decrypted if none of these
                     work.

generic options:
  -h, --help         Show this help message and exit.
  -R, --reverse      Use the reverse operation.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/rc2.py#L8-L12" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class rc2(StandardBlockCipherUnit, cipher=ARC2):
    &#34;&#34;&#34;
    RC2 encryption and decryption.
    &#34;&#34;&#34;
    pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardBlockCipherUnit">StandardBlockCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.BlockCipherUnitBase" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.BlockCipherUnitBase">BlockCipherUnitBase</a></li>
<li><a title="refinery.units.crypto.cipher.StandardCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardCipherUnit">StandardCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.CipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.CipherUnit">CipherUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.rc2.blocksize"><code class="name">var <span class="ident">blocksize</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.rc2.key_sizes"><code class="name">var <span class="ident">key_sizes</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.rc2.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.rc2.stdcipher"><code class="name">var <span class="ident">stdcipher</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.rc2.modespec"><code class="name">var <span class="ident">modespec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardBlockCipherUnit">StandardBlockCipherUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardBlockCipherUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.rc4"><code class="flex name class">
<span>class <span class="ident">rc4</span></span>
<span>(</span><span>key)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.rc4" href="units/crypto/cipher/rc4.html">refinery.units.crypto.cipher.rc4</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: rc4 [-h] [-R] [-Q] [-0] [-v] key

RC4 encryption and decryption.

positional arguments:
  key            The encryption key.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/rc4.py#L10-L14" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class rc4(StandardCipherUnit, cipher=ARC4):
    &#34;&#34;&#34;
    RC4 encryption and decryption.
    &#34;&#34;&#34;
    def __init__(self, key): super().__init__(key)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.cipher.StandardCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardCipherUnit">StandardCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.CipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.CipherUnit">CipherUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.rc4.blocksize"><code class="name">var <span class="ident">blocksize</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.rc4.key_sizes"><code class="name">var <span class="ident">key_sizes</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.rc4.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.rc4.stdcipher"><code class="name">var <span class="ident">stdcipher</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.cipher.StandardCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardCipherUnit">StandardCipherUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StandardCipherUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.rncrypt"><code class="flex name class">
<span>class <span class="ident">rncrypt</span></span>
<span>(</span><span>password)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.rncrypt" href="units/crypto/cipher/rncrypt.html">refinery.units.crypto.cipher.rncrypt</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: rncrypt [-h] [-R] [-Q] [-0] [-v] password

Implements encryption and decryption using the RNCryptor specification.
See also: https://github.com/RNCryptor

positional arguments:
  password

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/rncrypt.py#L46-L94" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class rncrypt(Unit):
    &#34;&#34;&#34;
    Implements encryption and decryption using the RNCryptor specification.
    See also: https://github.com/RNCryptor
    &#34;&#34;&#34;
    def __init__(self, password: bytearray):
        super().__init__(password=password)

    def process(self, data: bytes) -&gt; bytes:
        encryption_salt = data[2:10]
        hmac_salt = data[10:18]
        iv = data[18:34]
        cipher_text = data[34:-32]
        hmac_signature = data[-32:]
        encryption_key = self._pbkdf2(self.args.password, encryption_salt)
        hmac_key = self._pbkdf2(self.args.password, hmac_salt)
        if not hmac.compare_digest(self._hmac(hmac_key, data[:-32]), hmac_signature):
            raise ValueError(&#34;Failed to verify signature.&#34;)
        return unpad(
            self._aes_decrypt(encryption_key, iv, cipher_text),
            block_size=AES.block_size
        )

    def reverse(self, data: bytes) -&gt; bytes:
        prng = Random.new()
        data = pad(data, block_size=AES.block_size)
        encryption_salt = prng.read(8)
        encryption_key = self._pbkdf2(self.args.password, encryption_salt)
        hmac_salt = prng.read(8)
        hmac_key = self._pbkdf2(self.args.password, hmac_salt)
        iv = prng.read(AES.block_size)
        cipher_text = self._aes_encrypt(encryption_key, iv, data)
        new_data = b&#39;\x03\x01&#39; + encryption_salt + hmac_salt + iv + cipher_text
        return new_data + self._hmac(hmac_key, new_data)

    def _aes_encrypt(self, key, iv, text):
        return AES.new(key, AES.MODE_CBC, iv).encrypt(text)

    def _aes_decrypt(self, key, iv, text):
        return AES.new(key, AES.MODE_CBC, iv).decrypt(text)

    def _hmac(self, key, data):
        return hmac.new(key, data, hashlib.sha256).digest()

    def _prf(self, secret, salt):
        return hmac.new(secret, salt, hashlib.sha1).digest()

    def _pbkdf2(self, password, salt, iterations=10000, key_length=32):
        return KDF.PBKDF2(password, salt, dkLen=key_length, count=iterations, prf=self._prf)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.rncrypt.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.rot"><code class="flex name class">
<span>class <span class="ident">rot</span></span>
<span>(</span><span>amount=13)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.rot" href="units/crypto/cipher/rot.html">refinery.units.crypto.cipher.rot</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: rot [-h] [-Q] [-0] [-v] [amount]

Rotate the characters of the alphabet by the given amount. The default
amount is 13, providing the common (and weak) string obfuscation method.

positional arguments:
  amount         Number of letters to rotate by; Default is 13.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/rot.py#L7-L23" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class rot(Unit):
    &#34;&#34;&#34;
    Rotate the characters of the alphabet by the given amount. The default
    amount is 13, providing the common (and weak) string obfuscation method.
    &#34;&#34;&#34;

    def __init__(self, amount: arg(help=&#39;Number of letters to rotate by; Default is 13.&#39;, type=number[1:25]) = 13):
        super().__init__(amount=amount)

    def process(self, data):
        def rotate(char):
            if 0x41 &lt;= char &lt;= 0x5A:  # A-Z
                return (char - 0x41 + self.args.amount) % 26 + 0x41
            if 0x61 &lt;= char &lt;= 0x7A:  # a-z
                return (char - 0x61 + self.args.amount) % 26 + 0x61
            return char
        return bytes(rotate(char) for char in data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.rot.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.rsa"><code class="flex name class">
<span>class <span class="ident">rsa</span></span>
<span>(</span><span>key, swapkeys=False, textbook=False, padding=PAD.AUTO, rsautl=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.rsa" href="units/crypto/cipher/rsa.html">refinery.units.crypto.cipher.rsa</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: rsa [-h] [-R] [-Q] [-0] [-v] [-s] [-t | -p PAD | -r] key

Implements single block RSA encryption and decryption. This unit can be
used to encrypt and decrypt blocks generated by openssl's rsautl tool when
using the mode -verify. When it is executed with a public key for
decryption or with a private key for encryption, it will perform a raw RSA
operation. The result of these operations are (un)padded using EMSA-
PKCS1-v1_5.

positional arguments:
  key                RSA key in PEM, DER, or Microsoft BLOB format.

optional arguments:
  -s, --swapkeys     Swap public and private exponent.
  -t, --textbook     Equivalent to --padding=NONE.
  -p, --padding PAD  Choose one of the following padding modes: AUTO,
                     NONE, OAEP, PKCS15, PKCS10. The default is AUTO.
  -r, --rsautl       Act as rsautl from OpenSSH; This is equivalent to
                     --swapkeys --padding=PKCS10

generic options:
  -h, --help         Show this help message and exit.
  -R, --reverse      Use the reverse operation.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/rsa.py#L23-L214" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class rsa(Unit):
    &#34;&#34;&#34;
    Implements single block RSA encryption and decryption. This unit can be used to encrypt
    and decrypt blocks generated by openssl&#39;s `rsautl` tool when using the mode `-verify`.
    When it is executed with a public key for decryption or with a private key for encryption,
    it will perform a raw RSA operation. The result of these operations are (un)padded using
    EMSA-PKCS1-v1_5.
    &#34;&#34;&#34;
    def __init__(
        self,
        key: arg(help=&#39;RSA key in PEM, DER, or Microsoft BLOB format.&#39;),
        swapkeys: arg.switch(&#39;-s&#39;, help=&#39;Swap public and private exponent.&#39;) = False,
        textbook: arg.switch(&#39;-t&#39;, group=&#39;PAD&#39;, help=&#39;Equivalent to --padding=NONE.&#39;) = False,
        padding : arg.option(&#39;-p&#39;, group=&#39;PAD&#39;, choices=PAD,
            help=&#39;Choose one of the following padding modes: {choices}. The default is AUTO.&#39;) = PAD.AUTO,
        rsautl  : arg.switch(&#39;-r&#39;, group=&#39;PAD&#39;,
            help=&#39;Act as rsautl from OpenSSH; This is equivalent to --swapkeys --padding=PKCS10&#39;) = False,
    ):
        padding = makeinstance(PAD, padding)
        if textbook:
            if padding != PAD.AUTO:
                raise ValueError(&#39;Conflicting padding options!&#39;)
            padding = padding.NONE
        if rsautl:
            if padding and padding != PAD.PKCS10:
                raise ValueError(&#39;Conflicting padding options!&#39;)
            swapkeys = True
            padding = PAD.PKCS10

        super().__init__(textbook=textbook, padding=padding, swapkeys=swapkeys)

        try:
            blob = CRYPTOKEY(key)
        except ValueError:
            self.key: RSA.RsaKey = RSA.import_key(key)
        else:
            if blob.header.type not in {TYPES.PUBLICKEYBLOB, TYPES.PRIVATEKEYBLOB}:
                raise ValueError(F&#39;The provided key is of invalid type {blob.header.type!s}, the algorithm is {blob.header.algorithm!s}.&#39;)
            self.key: RSA.RsaKey = blob.key.convert()

    @property
    def blocksize(self) -&gt; int:
        return self.key.size_in_bytes()

    @property
    def blocksize_plain(self) -&gt; int:
        # PKCS#1 v1.5 padding is at least 11 bytes.
        return self.blocksize - 11

    @property
    def pub(self):
        return self.key.d if self.args.swapkeys else self.key.e

    @property
    def prv(self):
        return self.key.e if self.args.swapkeys else self.key.d

    def _get_msg(self, data):
        msg = int.from_bytes(data, byteorder=&#39;big&#39;)
        if msg &gt; self.key.n:
            raise ValueError(F&#39;This key can only handle messages of size {self.blocksize}.&#39;)
        return msg

    def _encrypt_raw(self, data):
        return pow(
            self._get_msg(data),
            self.pub,
            self.key.n
        ).to_bytes(self.blocksize, byteorder=&#39;big&#39;)

    def _decrypt_raw(self, data):
        return pow(
            self._get_msg(data),
            self.prv,
            self.key.n
        ).to_bytes(self.blocksize, byteorder=&#39;big&#39;)

    def _unpad(self, data, head, padbyte=None):
        if len(data) &gt; self.blocksize:
            raise ValueError(F&#39;This key can only handle messages of size {self.blocksize}.&#39;)
        if data.startswith(head):
            pos = data.find(B&#39;\0&#39;, 2)
            if pos &gt; 0:
                pad = data[2:pos]
                if padbyte is None or all(b == padbyte for b in pad):
                    return data[pos + 1:]
        raise ValueError(&#39;Incorrect padding&#39;)

    def _pad(self, data, head, padbyte=None):
        if len(data) &gt; self.blocksize_plain:
            raise ValueError(F&#39;This key can only encrypt messages of size at most {self.blocksize_plain}.&#39;)
        pad = self.blocksize - len(data) - len(head) - 1
        if padbyte is not None:
            padding = pad * bytes((padbyte,))
        else:
            padding = bytearray(1)
            while not all(padding):
                padding = bytearray(filter(None, padding))
                padding.extend(get_random_bytes(pad - len(padding)))
        return head + padding + B&#39;\0&#39; + data

    def _unpad_pkcs10(self, data):
        return self._unpad(data, B&#39;\x00\x01&#39;, 0xFF)

    def _unpad_pkcs15(self, data):
        return self._unpad(data, B&#39;\x00\x02&#39;, None)

    def _pad_pkcs10(self, data):
        return self._pad(data, B&#39;\x00\x01&#39;, 0xFF)

    def _pad_pkcs15(self, data):
        return self._pad(data, B&#39;\x00\x02&#39;, None)

    def _decrypt_block_OAEP(self, data):
        self.log_debug(&#39;Attempting decryption with PyCrypto PKCS1 OAEP.&#39;)
        result = PKCS1_OAEP.new(self.key).decrypt(data)
        if result is not None:
            return result
        raise ValueError(&#39;OAEP decryption was unsuccessful.&#39;)

    def _encrypt_block_OAEP(self, data):
        self.log_debug(&#39;Attempting encryption with PyCrypto PKCS1 OAEP.&#39;)
        result = PKCS1_OAEP.new(self.key).encrypt(data)
        if result is None:
            return result
        raise ValueError(&#39;OAEP encryption was unsuccessful.&#39;)

    def _decrypt_block(self, data):
        if self._oaep and self._pads in {PAD.AUTO, PAD.OAEP}:
            try:
                return self._decrypt_block_OAEP(data)
            except ValueError:
                if self._pads: raise
                self.log_debug(&#39;PyCrypto primitives failed, no longer attempting OAEP.&#39;)
                self._oaep = False

        result = self._decrypt_raw(data)

        if self._pads == PAD.NONE:
            return result
        elif self._pads == PAD.PKCS10:
            return self._unpad_pkcs10(result)
        elif self._pads == PAD.PKCS15:
            return self._unpad_pkcs15(result)
        elif self._pads == PAD.AUTO:
            with suppress(ValueError):
                data = self._unpad_pkcs10(result)
                self.log_info(&#39;Detected PKCS1.0 padding.&#39;)
                self._pads = PAD.PKCS10
                return data
            with suppress(ValueError):
                data = self._unpad_pkcs15(result)
                self.log_info(&#39;Detected PKCS1.5 padding.&#39;)
                self._pads = PAD.PKCS15
                return data
            self.log_warn(&#39;No padding worked, returning raw decrypted blocks.&#39;)
            self._pads = PAD.NONE
            return result
        else:
            raise ValueError(F&#39;Invalid padding value: {self._pads!r}&#39;)

        return result

    def _encrypt_block(self, data):
        if self._pads in {PAD.AUTO, PAD.OAEP}:
            try:
                return self._encrypt_block_OAEP(data)
            except ValueError:
                if self._pads: raise
                self.log_debug(&#39;PyCrypto primitives for OAEP failed, falling back to PKCS1.5.&#39;)
                self._pads = PAD.PKCS15

        if self._pads == PAD.PKCS15:
            data = self._pad_pkcs15(data)
        elif self._pads == PAD.PKCS10:
            data = self._pad_pkcs10(data)

        return self._encrypt_raw(data)

    def process(self, data):
        if not self.key.has_private():
            try:
                return self._unpad_pkcs10(self._encrypt_raw(data))
            except Exception as E:
                raise ValueError(&#39;A public key was given for decryption and rsautl mode resulted in an error.&#39;) from E
        self._oaep = True
        self._pads = self.args.padding
        return B&#39;&#39;.join(self._decrypt_block(block) for block in splitchunks(data, self.blocksize))

    def reverse(self, data):
        self._pads = self.args.padding
        return B&#39;&#39;.join(self._encrypt_block(block) for block in splitchunks(data, self.blocksize_plain))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.rsa.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="refinery.rsa.blocksize"><code class="name">var <span class="ident">blocksize</span></code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/rsa.py#L63-L65" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@property
def blocksize(self) -&gt; int:
    return self.key.size_in_bytes()</code></pre>
</details>
</dd>
<dt id="refinery.rsa.blocksize_plain"><code class="name">var <span class="ident">blocksize_plain</span></code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/rsa.py#L67-L70" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@property
def blocksize_plain(self) -&gt; int:
    # PKCS#1 v1.5 padding is at least 11 bytes.
    return self.blocksize - 11</code></pre>
</details>
</dd>
<dt id="refinery.rsa.pub"><code class="name">var <span class="ident">pub</span></code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/rsa.py#L72-L74" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@property
def pub(self):
    return self.key.d if self.args.swapkeys else self.key.e</code></pre>
</details>
</dd>
<dt id="refinery.rsa.prv"><code class="name">var <span class="ident">prv</span></code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/rsa.py#L76-L78" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@property
def prv(self):
    return self.key.e if self.args.swapkeys else self.key.d</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.salsa"><code class="flex name class">
<span>class <span class="ident">salsa</span></span>
<span>(</span><span>key, nonce=b'REFINERY')</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.salsa" href="units/crypto/cipher/salsa.html">refinery.units.crypto.cipher.salsa</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: salsa [-h] [-R] [-Q] [-0] [-v] [-N NONCE] key

Salsa20 encryption and decryption. The default IV (nonce) value is the
string value REFINERY.

positional arguments:
  key                The encryption key.

optional arguments:
  -N, --nonce NONCE  Specify the one-time use nonce; the default value is
                     &quot;REFINERY&quot;.

generic options:
  -h, --help         Show this help message and exit.
  -R, --reverse      Use the reverse operation.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/salsa.py#L8-L13" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class salsa(LatinStreamCipher, cipher=Salsa20):
    &#34;&#34;&#34;
    Salsa20 encryption and decryption. The default IV (nonce) value is the
    string value `REFINERY`.
    &#34;&#34;&#34;
    pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.cipher.LatinStreamCipher" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.LatinStreamCipher">LatinStreamCipher</a></li>
<li><a title="refinery.units.crypto.cipher.StandardCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StandardCipherUnit">StandardCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.CipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.CipherUnit">CipherUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.salsa.blocksize"><code class="name">var <span class="ident">blocksize</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.salsa.key_sizes"><code class="name">var <span class="ident">key_sizes</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.salsa.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.salsa.stdcipher"><code class="name">var <span class="ident">stdcipher</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.cipher.LatinStreamCipher" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.LatinStreamCipher">LatinStreamCipher</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.LatinStreamCipher.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.seal"><code class="flex name class">
<span>class <span class="ident">seal</span></span>
<span>(</span><span>key)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.seal" href="units/crypto/cipher/seal.html">refinery.units.crypto.cipher.seal</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: seal [-h] [-R] [-Q] [-0] [-v] key

SEAL encryption and decryption.

positional arguments:
  key            The encryption key.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/seal.py#L192-L199" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class seal(StreamCipherUnit):
    &#34;&#34;&#34;
    SEAL encryption and decryption.
    &#34;&#34;&#34;
    key_sizes = 20

    def keystream(self) -&gt; Iterable[bytes]:
        return SEAL_Cipher(self.key)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.cipher.StreamCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StreamCipherUnit">StreamCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.CipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.CipherUnit">CipherUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.seal.key_sizes"><code class="name">var <span class="ident">key_sizes</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.seal.blocksize"><code class="name">var <span class="ident">blocksize</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.seal.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.cipher.StreamCipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.StreamCipherUnit">StreamCipherUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.secstr"><code class="flex name class">
<span>class <span class="ident">secstr</span></span>
<span>(</span><span>key=b'\x01\x02\x03\x04\x05\x06\x07\x08\t\n\x0b\x0c\r\x0e\x0f\x10', iv=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.secstr" href="units/crypto/cipher/secstr.html">refinery.units.crypto.cipher.secstr</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: secstr [-h] [-R] [-Q] [-0] [-v] [-I IV] [key]

Implements the AES-based encryption scheme used by the PowerShell commands
ConvertFrom-SecureString and ConvertTo-SecureString.

positional arguments:
  key            Secure string encryption 16-byte AES key; the default are
                 the bytes from 1 to 16.

optional arguments:
  -I, --iv IV    Optionally specify an IV to use for encryption.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/secstr.py#L11-L73" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class secstr(Unit):
    &#34;&#34;&#34;
    Implements the AES-based encryption scheme used by the PowerShell commands
    `ConvertFrom-SecureString` and `ConvertTo-SecureString`.
    &#34;&#34;&#34;

    # This is a magic header value used for PowerShell secure strings.
    _MAGIC = bytes((
        0xEF, 0xAE, 0x3D, 0xD9, 0xDD, 0x75, 0xD7, 0xAE, 0xF8, 0xDD, 0xFD, 0x38,
        0xDB, 0x7E, 0x35, 0xDD, 0xBD, 0x7A, 0xD3, 0x9D, 0x1A, 0xE7, 0x7E, 0x39))

    # Secure strings include a decimal number formatted as a string directly
    # following the header. Presumably, this is the PowerShell version.
    _PSVER = 2

    def __init__(
        self, key: arg(
            help=&#39;Secure string encryption 16-byte AES key; the default are the bytes from 1 to 16.&#39;
        ) = bytes(range(1, 17)),
        iv: arg(&#39;-I&#39;, help=&#39;Optionally specify an IV to use for encryption.&#39;) = None
    ):
        if len(key) != 0x10:
            raise ValueError(&#39;The encryption key has to be 16 bytes long.&#39;)
        if iv is not None and len(iv) != 0x10:
            raise ValueError(&#39;The IV has to be 16 bytes long.&#39;)
        super().__init__(key=key, iv=iv)

    def reverse(self, data):
        ivec = self.args.iv or urandom(0x10)
        if len(ivec) != 0x10:
            raise ValueError(self._IVERR)
        cipher = AES.new(self.args.key, AES.MODE_CBC, ivec)
        data = data.decode(&#39;latin-1&#39;).encode(&#39;utf-16LE&#39;)
        data = cipher.encrypt(pad(data, block_size=0x10))
        data = base64.b16encode(data).lower().decode(&#39;ascii&#39;)
        ivec = base64.b64encode(ivec).decode(&#39;ascii&#39;)
        data = &#39;|&#39;.join((&#39;%d&#39; % self._PSVER, ivec, data)).encode(&#39;utf-16LE&#39;)
        return base64.b64encode(self._MAGIC + data)

    def process(self, data):
        head, ivec, data = base64.b64decode(data).split(b&#39;|\0&#39;)
        self.log_info(&#39;head:&#39;, head.hex())
        ivec = base64.b64decode(ivec.decode(&#39;utf-16LE&#39;))
        self.log_info(&#39;ivec:&#39;, ivec.hex())
        data = base64.b16decode(data.decode(&#39;utf-16LE&#39;), casefold=True)
        if len(data) % 0x10 != 0:
            self.log_info(&#39;data not block-aligned, padding with zeros&#39;)
            data += B&#39;\0&#39; * (0x10 - len(data) % 0x10)
        cipher = AES.new(self.args.key, AES.MODE_CBC, ivec)
        data = cipher.decrypt(data)
        try:
            data = unpad(data, block_size=0x10)
        except Exception:
            self.log_warn(&#39;decrypted data does not have PKCS7 padding&#39;)
        for p in range(0x10):
            try:
                return data[-p:].decode(&#39;utf-16LE&#39;).encode(&#39;latin-1&#39;)
            except UnicodeDecodeError:
                pass
            except UnicodeEncodeError:
                pass
        self.log_warn(&#39;result is not a padded unicode string, key is likely wrong&#39;)
        return data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.secstr.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.vigenere"><code class="flex name class">
<span>class <span class="ident">vigenere</span></span>
<span>(</span><span>key, alphabet='abcdefghijklmnopqrstuvwxyz', case_sensitive=False, ignore_unknown=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.vigenere" href="units/crypto/cipher/vigenere.html">refinery.units.crypto.cipher.vigenere</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: vigenere [-h] [-R] [-Q] [-0] [-v] [-c] [-i] key [alphabet]

Encryption and decryption using the Vigenère-Bellaso polyalphabetic
cipher.

positional arguments:
  key                   The encryption key
  alphabet              The alphabet, by default the Latin one is used:
                        &quot;abcdefghijklmnopqrstuvwxyz&quot;

optional arguments:
  -c, --case-sensitive  Unless this option is set, the key will be case
                        insensitive and the alphabet is assumed to contain
                        only lowercase letters. Any uppercase letter is
                        transformed using the same shift as would be the
                        lowercase variant, but case is retained.
  -i, --ignore-unknown  Unless this option is set, the key stream will be
                        iterated even for letters that are not contained
                        in the alphabet.

generic options:
  -h, --help            Show this help message and exit.
  -R, --reverse         Use the reverse operation.
  -Q, --quiet           Disables all log output.
  -0, --devnull         Do not produce any output.
  -v, --verbose         Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/vigenere.py#L9-L68" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class vigenere(Unit):
    &#34;&#34;&#34;
    Encryption and decryption using the Vigenère-Bellaso polyalphabetic cipher.
    &#34;&#34;&#34;

    def __init__(
        self,
        key: arg(type=str, help=&#39;The encryption key&#39;),
        alphabet: arg(
            help=&#39;The alphabet, by default the Latin one is used: &#34;{default}&#34;&#39;
        ) = &#39;abcdefghijklmnopqrstuvwxyz&#39;,
        case_sensitive: arg.switch(&#39;-c&#39;, help=(
            &#39;Unless this option is set, the key will be case insensitive and &#39;
            &#39;the alphabet is assumed to contain only lowercase letters. Any &#39;
            &#39;uppercase letter is transformed using the same shift as would be &#39;
            &#39;the lowercase variant, but case is retained.&#39;
        )) = False,
        ignore_unknown: arg.switch(&#39;-i&#39;, help=(
            &#39;Unless this option is set, the key stream will be iterated even &#39;
            &#39;for letters that are not contained in the alphabet.&#39;
        )) = False
    ):
        if not case_sensitive:
            key = key.lower()
            alphabet = alphabet.lower()
            if len(set(alphabet)) != len(alphabet):
                raise ValueError(&#39;Duplicate entries detected in alphabet.&#39;)
        if not set(key) &lt;= set(alphabet):
            raise ValueError(&#39;key contains letters which are not from the given alphabet&#39;)
        self.superinit(super(), **vars())

    def _tabula_recta(self, data, reverse=True):
        keystream = cycle(self.args.key)
        alphabet_size = len(self.args.alphabet)
        for letter in data:
            uppercase = not self.args.case_sensitive and letter.isupper()
            if uppercase:
                letter = letter.lower()
            try:
                position = self.args.alphabet.index(letter)
            except ValueError:
                yield letter
                if not self.args.ignore_unknown:
                    next(keystream)
                continue
            shift = self.args.alphabet.index(next(keystream))
            if reverse:
                position -= shift
            else:
                position += shift
            result = self.args.alphabet[position % alphabet_size]
            yield result.upper() if uppercase else result

    @unicoded
    def process(self, data):
        return &#39;&#39;.join(self._tabula_recta(data, True))

    @unicoded
    def reverse(self, data):
        return &#39;&#39;.join(self._tabula_recta(data, False))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.vigenere.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.xtea"><code class="flex name class">
<span>class <span class="ident">xtea</span></span>
<span>(</span><span>key, padding=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.cipher.xtea" href="units/crypto/cipher/xtea.html">refinery.units.crypto.cipher.xtea</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: xtea [-h] [-R] [-Q] [-0] [-v] [-P ALG] key

XTEA encryption and decryption.

positional arguments:
  key                The encryption key.

optional arguments:
  -P, --padding ALG  Choose a padding algorithm (PKCS7, ISO7816, X923,
                     RAW). The RAW algorithm does nothing. By default, all
                     other algorithms are attempted. In most cases, the
                     data was not correctly decrypted if none of these
                     work.

generic options:
  -h, --help         Show this help message and exit.
  -R, --reverse      Use the reverse operation.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/xtea.py#L8-L60" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class xtea(BlockCipherUnitBase):
    &#34;&#34;&#34;
    XTEA encryption and decryption.
    &#34;&#34;&#34;
    blocksize = 16
    key_sizes = 16

    def __init__(self, key, padding=None):
        super().__init__(key=key, padding=padding)

    @property
    def key(self):
        return struct.unpack(&#39;4I&#39;, super().key)

    def encrypt(self, data):
        it = iter(self._load32(data))
        return self._stor64(self._encrypt_block(y, z, *self.key) for y, z in zip(it, it))

    def decrypt(self, data):
        it = iter(self._load32(data))
        return self._stor64(self._decrypt_block(y, z, *self.key) for y, z in zip(it, it))

    @staticmethod
    def _encrypt_block(y, z, k1, k2, k3, k4):
        sum_t = 0
        delta = 0x9E3779B9
        for _ in range(32, 0, -1):
            sum_t = (sum_t + delta) &amp; 0xFFFFFFFF
            y = y + ((z &lt;&lt; 4) + k1 ^ z + sum_t ^ (z &gt;&gt; 5) + k2) &amp; 0xFFFFFFFF
            z = z + ((y &lt;&lt; 4) + k3 ^ y + sum_t ^ (y &gt;&gt; 5) + k4) &amp; 0xFFFFFFFF
        return y + (z &lt;&lt; 0x20)

    @staticmethod
    def _decrypt_block(y, z, k1, k2, k3, k4):
        sum_t = 0xC6EF3720
        delta = 0x9E3779B9
        for _ in range(32, 0, -1):
            z = z - ((y &lt;&lt; 4) + k3 ^ y + sum_t ^ (y &gt;&gt; 5) + k4) &amp; 0xFFFFFFFF
            y = y - ((z &lt;&lt; 4) + k1 ^ z + sum_t ^ (z &gt;&gt; 5) + k2) &amp; 0xFFFFFFFF
            sum_t = (sum_t - delta) &amp; 0xFFFFFFFF
        return y + (z &lt;&lt; 0x20)

    @staticmethod
    def _load32(vector):
        Q, R = divmod(len(vector), 4)
        if R &gt; 0:
            raise ValueError(&#39;Data not padded to a 16 byte boundary.&#39;)
        yield from struct.unpack(F&#39;{Q}I&#39;, vector)

    @staticmethod
    def _stor64(vector):
        vector = tuple(vector)
        return struct.pack(F&#39;{len(vector)}Q&#39;, *vector)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.cipher.BlockCipherUnitBase" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.BlockCipherUnitBase">BlockCipherUnitBase</a></li>
<li><a title="refinery.units.crypto.cipher.CipherUnit" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.CipherUnit">CipherUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.xtea.blocksize"><code class="name">var <span class="ident">blocksize</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.xtea.key_sizes"><code class="name">var <span class="ident">key_sizes</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.xtea.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="refinery.xtea.key"><code class="name">var <span class="ident">key</span></code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/cipher/xtea.py#L18-L20" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@property
def key(self):
    return struct.unpack(&#39;4I&#39;, super().key)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.cipher.BlockCipherUnitBase" href="units/crypto/cipher/index.html#refinery.units.crypto.cipher.BlockCipherUnitBase">BlockCipherUnitBase</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.cipher.BlockCipherUnitBase.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.BlockCipherUnitBase.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.BlockCipherUnitBase.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.BlockCipherUnitBase.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.BlockCipherUnitBase.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.BlockCipherUnitBase.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.BlockCipherUnitBase.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.BlockCipherUnitBase.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.BlockCipherUnitBase.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.BlockCipherUnitBase.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.BlockCipherUnitBase.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.BlockCipherUnitBase.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.BlockCipherUnitBase.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.BlockCipherUnitBase.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.adler32"><code class="flex name class">
<span>class <span class="ident">adler32</span></span>
<span>(</span><span>text=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.hash.checksums" href="units/crypto/hash/checksums.html">refinery.units.crypto.hash.checksums</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: adler32 [-h] [-Q] [-0] [-v] [-t]

Returns the Adler32 Hash of the input data.

optional arguments:
  -t, --text     Output a hexadecimal representation of the hash.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/hash/checksums.py#L21-L27" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class adler32(HashUnit):
    &#34;&#34;&#34;
    Returns the Adler32 Hash of the input data.
    &#34;&#34;&#34;
    @classmethod
    def _algorithm(cls, data: bytes) -&gt; bytes:
        return struct.pack(&#39;&lt;I&#39;, zlib.adler32(data))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.adler32.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.hash.HashUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.crc32"><code class="flex name class">
<span>class <span class="ident">crc32</span></span>
<span>(</span><span>text=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.hash.checksums" href="units/crypto/hash/checksums.html">refinery.units.crypto.hash.checksums</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: crc32 [-h] [-Q] [-0] [-v] [-t]

Returns the CRC32 Hash of the input data.

optional arguments:
  -t, --text     Output a hexadecimal representation of the hash.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/hash/checksums.py#L12-L18" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class crc32(HashUnit):
    &#34;&#34;&#34;
    Returns the CRC32 Hash of the input data.
    &#34;&#34;&#34;
    @classmethod
    def _algorithm(cls, data: bytes) -&gt; bytes:
        return struct.pack(&#39;&lt;I&#39;, zlib.crc32(data))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.crc32.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.hash.HashUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.blk224"><code class="flex name class">
<span>class <span class="ident">blk224</span></span>
<span>(</span><span>text=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.hash.cryptographic" href="units/crypto/hash/cryptographic.html">refinery.units.crypto.hash.cryptographic</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: blk224 [-h] [-Q] [-0] [-v] [-t]

Returns the BLK224 Hash of the input data.

optional arguments:
  -t, --text     Output a hexadecimal representation of the hash.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/hash/cryptographic.py#L59-L64" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class blk224(HashUnit):
    &#34;&#34;&#34;
    Returns the BLK224 Hash of the input data.
    &#34;&#34;&#34;
    @classmethod
    def _algorithm(cls, data): return hashlib.blake2b(data, digest_size=28)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.blk224.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.hash.HashUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.blk256"><code class="flex name class">
<span>class <span class="ident">blk256</span></span>
<span>(</span><span>text=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.hash.cryptographic" href="units/crypto/hash/cryptographic.html">refinery.units.crypto.hash.cryptographic</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: blk256 [-h] [-Q] [-0] [-v] [-t]

Returns the BLK256 Hash of the input data.

optional arguments:
  -t, --text     Output a hexadecimal representation of the hash.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/hash/cryptographic.py#L67-L72" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class blk256(HashUnit):
    &#34;&#34;&#34;
    Returns the BLK256 Hash of the input data.
    &#34;&#34;&#34;
    @classmethod
    def _algorithm(cls, data): return hashlib.blake2b(data, digest_size=32)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.blk256.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.hash.HashUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.blk384"><code class="flex name class">
<span>class <span class="ident">blk384</span></span>
<span>(</span><span>text=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.hash.cryptographic" href="units/crypto/hash/cryptographic.html">refinery.units.crypto.hash.cryptographic</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: blk384 [-h] [-Q] [-0] [-v] [-t]

Returns the BLK384 Hash of the input data.

optional arguments:
  -t, --text     Output a hexadecimal representation of the hash.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/hash/cryptographic.py#L75-L80" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class blk384(HashUnit):
    &#34;&#34;&#34;
    Returns the BLK384 Hash of the input data.
    &#34;&#34;&#34;
    @classmethod
    def _algorithm(cls, data): return hashlib.blake2b(data, digest_size=48)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.blk384.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.hash.HashUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.blk512"><code class="flex name class">
<span>class <span class="ident">blk512</span></span>
<span>(</span><span>text=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.hash.cryptographic" href="units/crypto/hash/cryptographic.html">refinery.units.crypto.hash.cryptographic</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: blk512 [-h] [-Q] [-0] [-v] [-t]

Returns the BLK512 Hash of the input data.

optional arguments:
  -t, --text     Output a hexadecimal representation of the hash.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/hash/cryptographic.py#L83-L88" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class blk512(HashUnit):
    &#34;&#34;&#34;
    Returns the BLK512 Hash of the input data.
    &#34;&#34;&#34;
    @classmethod
    def _algorithm(cls, data): return hashlib.blake2b(data, digest_size=64)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.blk512.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.hash.HashUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.md5"><code class="flex name class">
<span>class <span class="ident">md5</span></span>
<span>(</span><span>text=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.hash.cryptographic" href="units/crypto/hash/cryptographic.html">refinery.units.crypto.hash.cryptographic</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: md5 [-h] [-Q] [-0] [-v] [-t]

Returns the MD5 hash of the input data.

optional arguments:
  -t, --text     Output a hexadecimal representation of the hash.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/hash/cryptographic.py#L11-L16" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class md5(HashUnit):
    &#34;&#34;&#34;
    Returns the MD5 hash of the input data.
    &#34;&#34;&#34;
    @classmethod
    def _algorithm(cls, data): return hashlib.md5(data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.md5.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.hash.HashUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.sha1"><code class="flex name class">
<span>class <span class="ident">sha1</span></span>
<span>(</span><span>text=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.hash.cryptographic" href="units/crypto/hash/cryptographic.html">refinery.units.crypto.hash.cryptographic</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: sha1 [-h] [-Q] [-0] [-v] [-t]

Returns the SHA1 Hash of the input data.

optional arguments:
  -t, --text     Output a hexadecimal representation of the hash.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/hash/cryptographic.py#L19-L24" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class sha1(HashUnit):
    &#34;&#34;&#34;
    Returns the SHA1 Hash of the input data.
    &#34;&#34;&#34;
    @classmethod
    def _algorithm(cls, data): return hashlib.sha1(data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.sha1.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.hash.HashUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.sha224"><code class="flex name class">
<span>class <span class="ident">sha224</span></span>
<span>(</span><span>text=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.hash.cryptographic" href="units/crypto/hash/cryptographic.html">refinery.units.crypto.hash.cryptographic</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: sha224 [-h] [-Q] [-0] [-v] [-t]

Returns the SHA224 Hash of the input data.

optional arguments:
  -t, --text     Output a hexadecimal representation of the hash.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/hash/cryptographic.py#L27-L32" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class sha224(HashUnit):
    &#34;&#34;&#34;
    Returns the SHA224 Hash of the input data.
    &#34;&#34;&#34;
    @classmethod
    def _algorithm(cls, data): return hashlib.sha224(data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.sha224.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.hash.HashUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.sha256"><code class="flex name class">
<span>class <span class="ident">sha256</span></span>
<span>(</span><span>text=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.hash.cryptographic" href="units/crypto/hash/cryptographic.html">refinery.units.crypto.hash.cryptographic</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: sha256 [-h] [-Q] [-0] [-v] [-t]

Returns the SHA256 Hash of the input data.

optional arguments:
  -t, --text     Output a hexadecimal representation of the hash.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/hash/cryptographic.py#L35-L40" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class sha256(HashUnit):
    &#34;&#34;&#34;
    Returns the SHA256 Hash of the input data.
    &#34;&#34;&#34;
    @classmethod
    def _algorithm(cls, data): return hashlib.sha256(data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.sha256.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.hash.HashUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.sha384"><code class="flex name class">
<span>class <span class="ident">sha384</span></span>
<span>(</span><span>text=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.hash.cryptographic" href="units/crypto/hash/cryptographic.html">refinery.units.crypto.hash.cryptographic</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: sha384 [-h] [-Q] [-0] [-v] [-t]

Returns the SHA384 Hash of the input data.

optional arguments:
  -t, --text     Output a hexadecimal representation of the hash.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/hash/cryptographic.py#L43-L48" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class sha384(HashUnit):
    &#34;&#34;&#34;
    Returns the SHA384 Hash of the input data.
    &#34;&#34;&#34;
    @classmethod
    def _algorithm(cls, data): return hashlib.sha384(data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.sha384.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.hash.HashUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.sha512"><code class="flex name class">
<span>class <span class="ident">sha512</span></span>
<span>(</span><span>text=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.hash.cryptographic" href="units/crypto/hash/cryptographic.html">refinery.units.crypto.hash.cryptographic</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: sha512 [-h] [-Q] [-0] [-v] [-t]

Returns the SHA512 Hash of the input data.

optional arguments:
  -t, --text     Output a hexadecimal representation of the hash.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/hash/cryptographic.py#L51-L56" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class sha512(HashUnit):
    &#34;&#34;&#34;
    Returns the SHA512 Hash of the input data.
    &#34;&#34;&#34;
    @classmethod
    def _algorithm(cls, data): return hashlib.sha512(data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.sha512.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.hash.HashUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.imphash"><code class="flex name class">
<span>class <span class="ident">imphash</span></span>
<span>(</span><span>text=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.hash.imphash" href="units/crypto/hash/imphash.html">refinery.units.crypto.hash.imphash</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: imphash [-h] [-Q] [-0] [-v] [-t]

Implements the import hash for PE files.

optional arguments:
  -t, --text     Output a hexadecimal representation of the hash.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/hash/imphash.py#L8-L15" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class imphash(HashUnit):
    &#34;&#34;&#34;
    Implements the import hash for PE files.
    &#34;&#34;&#34;

    def process(self, data):
        th = pefile.PE(data=data).get_imphash()
        return th.encode(self.codec) if self.args.text else bytes.fromhex(th)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.imphash.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.hash.HashUnit" href="units/crypto/hash/index.html#refinery.units.crypto.hash.HashUnit">HashUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.hash.HashUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.hash.HashUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.CryptDeriveKey"><code class="flex name class">
<span>class <span class="ident">CryptDeriveKey</span></span>
<span>(</span><span>size, hash='MD5')</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.keyderive.CryptDeriveKey" href="units/crypto/keyderive/CryptDeriveKey.html">refinery.units.crypto.keyderive.CryptDeriveKey</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: CryptDeriveKey [-h] [-Q] [-0] [-v] [-H HASH] size

An implementation of the CryptDeriveKey routine available from the Win32
API.

positional arguments:
  size             The number of bytes to generate.

optional arguments:
  -H, --hash HASH  Specify the hash algorithm, default is MD5. May be any
                   of the following: MD2, MD4, MD5, SHA1, SHA256, SHA512,
                   SHA224, SHA384

generic options:
  -h, --help       Show this help message and exit.
  -Q, --quiet      Disables all log output.
  -0, --devnull    Do not produce any output.
  -v, --verbose    Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/keyderive/CryptDeriveKey.py#L11-L36" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class CryptDeriveKey(KeyDerivation):
    &#34;&#34;&#34;
    An implementation of the CryptDeriveKey routine available from the Win32 API.
    &#34;&#34;&#34;

    def __init__(self, size, hash=&#39;MD5&#39;):
        super().__init__(size=size, salt=None, hash=hash)

    def process(self, data):
        def digest(x):
            return self.hash.new(x).digest()
        max_size = 2 * self.hash.digest_size
        value = digest(data)
        del data
        buffer1 = bytearray([0x36] * 64)
        buffer2 = bytearray([0x5C] * 64)
        for k, b in enumerate(value):
            buffer1[k] ^= b
            buffer2[k] ^= b
        buffer = digest(buffer1) + digest(buffer2)
        if self.args.size &gt; max_size:
            raise RefineryPartialResult(
                F&#39;too many bytes requested, can only provide {max_size}&#39;,
                partial=buffer
            )
        return buffer[:self.args.size]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.keyderive.KeyDerivation" href="units/crypto/keyderive/index.html#refinery.units.crypto.keyderive.KeyDerivation">KeyDerivation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.CryptDeriveKey.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.keyderive.KeyDerivation" href="units/crypto/keyderive/index.html#refinery.units.crypto.keyderive.KeyDerivation">KeyDerivation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.DESDerive"><code class="flex name class">
<span>class <span class="ident">DESDerive</span></span>
<span>(</span><span>size=8)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.keyderive.DESDerive" href="units/crypto/keyderive/DESDerive.html">refinery.units.crypto.keyderive.DESDerive</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: DESDerive [-h] [-Q] [-0] [-v] [size]

Implements the same functionality as DES_string_to_key in OpenSSL. It
converts a string to an 8 byte DES key with odd byte parity, per FIPS
specification. This is not a modern key derivation function.

positional arguments:
  size           The number of bytes to generate, default is the maximum
                 of 8.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/keyderive/DESDerive.py#L12-L82" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class DESDerive(KeyDerivation):
    &#34;&#34;&#34;
    Implements the same functionality as `DES_string_to_key` in OpenSSL. It
    converts a string to an 8 byte DES key with odd byte parity, per FIPS
    specification. This is not a modern key derivation function.
    &#34;&#34;&#34;

    _TABLE = bytearray((
        0x01, 0x01, 0x02, 0x02, 0x04, 0x04, 0x07, 0x07,
        0x08, 0x08, 0x0B, 0x0B, 0x0D, 0x0D, 0x0E, 0x0E,
        0x10, 0x10, 0x13, 0x13, 0x15, 0x15, 0x16, 0x16,
        0x19, 0x19, 0x1A, 0x1A, 0x1C, 0x1C, 0x1F, 0x1F,
        0x20, 0x20, 0x23, 0x23, 0x25, 0x25, 0x26, 0x26,
        0x29, 0x29, 0x2A, 0x2A, 0x2C, 0x2C, 0x2F, 0x2F,
        0x31, 0x31, 0x32, 0x32, 0x34, 0x34, 0x37, 0x37,
        0x38, 0x38, 0x3B, 0x3B, 0x3D, 0x3D, 0x3E, 0x3E,
        0x40, 0x40, 0x43, 0x43, 0x45, 0x45, 0x46, 0x46,
        0x49, 0x49, 0x4A, 0x4A, 0x4C, 0x4C, 0x4F, 0x4F,
        0x51, 0x51, 0x52, 0x52, 0x54, 0x54, 0x57, 0x57,
        0x58, 0x58, 0x5B, 0x5B, 0x5D, 0x5D, 0x5E, 0x5E,
        0x61, 0x61, 0x62, 0x62, 0x64, 0x64, 0x67, 0x67,
        0x68, 0x68, 0x6B, 0x6B, 0x6D, 0x6D, 0x6E, 0x6E,
        0x70, 0x70, 0x73, 0x73, 0x75, 0x75, 0x76, 0x76,
        0x79, 0x79, 0x7A, 0x7A, 0x7C, 0x7C, 0x7F, 0x7F,
        0x80, 0x80, 0x83, 0x83, 0x85, 0x85, 0x86, 0x86,
        0x89, 0x89, 0x8A, 0x8A, 0x8C, 0x8C, 0x8F, 0x8F,
        0x91, 0x91, 0x92, 0x92, 0x94, 0x94, 0x97, 0x97,
        0x98, 0x98, 0x9B, 0x9B, 0x9D, 0x9D, 0x9E, 0x9E,
        0xA1, 0xA1, 0xA2, 0xA2, 0xA4, 0xA4, 0xA7, 0xA7,
        0xA8, 0xA8, 0xAB, 0xAB, 0xAD, 0xAD, 0xAE, 0xAE,
        0xB0, 0xB0, 0xB3, 0xB3, 0xB5, 0xB5, 0xB6, 0xB6,
        0xB9, 0xB9, 0xBA, 0xBA, 0xBC, 0xBC, 0xBF, 0xBF,
        0xC1, 0xC1, 0xC2, 0xC2, 0xC4, 0xC4, 0xC7, 0xC7,
        0xC8, 0xC8, 0xCB, 0xCB, 0xCD, 0xCD, 0xCE, 0xCE,
        0xD0, 0xD0, 0xD3, 0xD3, 0xD5, 0xD5, 0xD6, 0xD6,
        0xD9, 0xD9, 0xDA, 0xDA, 0xDC, 0xDC, 0xDF, 0xDF,
        0xE0, 0xE0, 0xE3, 0xE3, 0xE5, 0xE5, 0xE6, 0xE6,
        0xE9, 0xE9, 0xEA, 0xEA, 0xEC, 0xEC, 0xEF, 0xEF,
        0xF1, 0xF1, 0xF2, 0xF2, 0xF4, 0xF4, 0xF7, 0xF7,
        0xF8, 0xF8, 0xFB, 0xFB, 0xFD, 0xFD, 0xFE, 0xFE
    ))

    def __init__(self, size: arg(help=&#39;The number of bytes to generate, default is the maximum of 8.&#39;) = 8):
        super().__init__(size=size, salt=None)

    def process(self, password):
        key = bytearray(8)

        for i, j in enumerate(password):
            if ((i % 16) &lt; 8):
                key[i % 8] ^= (j &lt;&lt; 1) &amp; 0xFF
            else:
                j = (((j &lt;&lt; 4) &amp; 0xf0) | ((j &gt;&gt; 4) &amp; 0x0f))
                j = (((j &lt;&lt; 2) &amp; 0xcc) | ((j &gt;&gt; 2) &amp; 0x33))
                j = (((j &lt;&lt; 1) &amp; 0xaa) | ((j &gt;&gt; 1) &amp; 0x55))
                key[7 - (i % 8)] ^= j

        key[:] = (self._TABLE[b] for b in key)

        if password:
            n = len(password)
            password = password.ljust(n + 7 - ((n - 1) % 8), b&#39;\0&#39;)
            des = DES.new(key, DES.MODE_ECB)
            for k in range(0, n, 8):
                key = des.encrypt(strxor(password[k:k + 8], key))
            key = bytes(self._TABLE[b] for b in key)

        if self.args.size &gt; 8:
            raise RefineryPartialResult(&#39;DESDerive can provide at most 8 bytes.&#39;, partial=key)

        return key[:self.args.size]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.keyderive.KeyDerivation" href="units/crypto/keyderive/index.html#refinery.units.crypto.keyderive.KeyDerivation">KeyDerivation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.DESDerive.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.keyderive.KeyDerivation" href="units/crypto/keyderive/index.html#refinery.units.crypto.keyderive.KeyDerivation">KeyDerivation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.PasswordDeriveBytes"><code class="flex name class">
<span>class <span class="ident">PasswordDeriveBytes</span></span>
<span>(</span><span>size, salt, iter=100, hash='SHA1')</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.keyderive.PasswordDeriveBytes" href="units/crypto/keyderive/PasswordDeriveBytes.html">refinery.units.crypto.keyderive.PasswordDeriveBytes</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: PasswordDeriveBytes [-h] [-Q] [-0] [-v] [-I N] [-H HASH] size salt

An implementation of the PasswordDeriveBytes routine available from the
.NET standard library. According to documentation, it is an extension of
PBKDF1.

positional arguments:
  size             The number of bytes to generate.
  salt             Salt for the derivation.

optional arguments:
  -I, --iter N     Number of iterations; default is 100.
  -H, --hash HASH  Specify the hash algorithm, default is SHA1. May be any
                   of the following: MD2, MD4, MD5, SHA1, SHA256, SHA512,
                   SHA224, SHA384

generic options:
  -h, --help       Show this help message and exit.
  -Q, --quiet      Disables all log output.
  -0, --devnull    Do not produce any output.
  -v, --verbose    Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/keyderive/PasswordDeriveBytes.py#L6-L25" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class PasswordDeriveBytes(KeyDerivation):
    &#34;&#34;&#34;
    An implementation of the PasswordDeriveBytes routine available from the .NET
    standard library. According to documentation, it is an extension of PBKDF1.
    &#34;&#34;&#34;
    def __init__(self, size, salt, iter=100, hash=&#39;SHA1&#39;):
        self.superinit(super(), **vars())

    def process(self, data):
        if self.codec != &#39;UTF8&#39;:
            data = data.decode(self.codec).encode(&#39;UTF8&#39;)
        data += self.args.salt
        for _ in range(self.args.iter - 1):
            data = self.hash.new(data).digest()
        counter, seedhash = 1, data
        data = self.hash.new(data).digest()
        while len(data) &lt; self.args.size:
            data += self.hash.new(B&#39;%d%s&#39; % (counter, seedhash)).digest()
            counter += 1
        return data[:self.args.size]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.keyderive.KeyDerivation" href="units/crypto/keyderive/index.html#refinery.units.crypto.keyderive.KeyDerivation">KeyDerivation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.PasswordDeriveBytes.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.keyderive.KeyDerivation" href="units/crypto/keyderive/index.html#refinery.units.crypto.keyderive.KeyDerivation">KeyDerivation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.HKDF"><code class="flex name class">
<span>class <span class="ident">HKDF</span></span>
<span>(</span><span>size, salt, hash='SHA512')</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.keyderive.hkdf" href="units/crypto/keyderive/hkdf.html">refinery.units.crypto.keyderive.hkdf</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: HKDF [-h] [-Q] [-0] [-v] [-H HASH] size salt

HKDF Key derivation

positional arguments:
  size             The number of bytes to generate.
  salt             Salt for the derivation.

optional arguments:
  -H, --hash HASH  Specify the hash algorithm, default is SHA512. May be
                   any of the following: MD2, MD4, MD5, SHA1, SHA256,
                   SHA512, SHA224, SHA384

generic options:
  -h, --help       Show this help message and exit.
  -Q, --quiet      Disables all log output.
  -0, --devnull    Do not produce any output.
  -v, --verbose    Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/keyderive/hkdf.py#L8-L15" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class HKDF(KeyDerivation):
    &#34;&#34;&#34;HKDF Key derivation&#34;&#34;&#34;

    def __init__(self, size, salt, hash=&#39;SHA512&#39;):
        super().__init__(size=size, salt=salt, hash=hash)

    def process(self, data):
        return HKDF_(data, self.args.size, self.args.salt, self.hash)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.keyderive.KeyDerivation" href="units/crypto/keyderive/index.html#refinery.units.crypto.keyderive.KeyDerivation">KeyDerivation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.HKDF.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.keyderive.KeyDerivation" href="units/crypto/keyderive/index.html#refinery.units.crypto.keyderive.KeyDerivation">KeyDerivation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.kblob"><code class="flex name class">
<span>class <span class="ident">kblob</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.keyderive.kblob" href="units/crypto/keyderive/kblob.html">refinery.units.crypto.keyderive.kblob</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: kblob [-h] [-Q] [-0] [-v]

Extracts a key from a Microsoft Crypto API BLOB structure.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/keyderive/kblob.py#L7-L17" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class kblob(Unit):
    &#34;&#34;&#34;Extracts a key from a Microsoft Crypto API BLOB structure.&#34;&#34;&#34;

    def process(self, data):
        blob = CRYPTOKEY(data)
        self.log_info(F&#39;BLOB Type: {blob.header.type!s}&#39;)
        self.log_info(F&#39;Algorithm: {blob.header.algorithm!s}&#39;)
        try:
            return bytes(blob.key)
        except AttributeError as A:
            raise ValueError(F&#39;unable to derive key from {blob.header.type!s}&#39;) from A</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.kblob.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.PBKDF1"><code class="flex name class">
<span>class <span class="ident">PBKDF1</span></span>
<span>(</span><span>size, salt=b'\x00\x00\x00\x00\x00\x00\x00\x00', iter=1000, hash='SHA1')</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.keyderive.pbkdf1" href="units/crypto/keyderive/pbkdf1.html">refinery.units.crypto.keyderive.pbkdf1</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: PBKDF1 [-h] [-Q] [-0] [-v] [-I N] [-H HASH] size [salt]

PBKDF1 Key derivation

positional arguments:
  size             The number of bytes to generate.
  salt             Salt for the derivation; default are 8 null bytes.

optional arguments:
  -I, --iter N     Number of iterations; default is 1000.
  -H, --hash HASH  Specify the hash algorithm, default is SHA1. May be any
                   of the following: MD2, MD4, MD5, SHA1, SHA256, SHA512,
                   SHA224, SHA384

generic options:
  -h, --help       Show this help message and exit.
  -Q, --quiet      Disables all log output.
  -0, --devnull    Do not produce any output.
  -v, --verbose    Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/keyderive/pbkdf1.py#L8-L22" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class PBKDF1(KeyDerivation):
    &#34;&#34;&#34;PBKDF1 Key derivation&#34;&#34;&#34;

    @arg(&#39;salt&#39;, help=&#39;Salt for the derivation; default are 8 null bytes.&#39;)
    def __init__(self, size, salt=bytes(8), iter=1000, hash=&#39;SHA1&#39;):
        self.superinit(super(), **vars())

    def process(self, data):
        return PBKDF1_(
            data.decode(self.codec),
            self.args.salt,
            dkLen=self.args.size,
            count=self.args.iter,
            hashAlgo=self.hash
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.keyderive.KeyDerivation" href="units/crypto/keyderive/index.html#refinery.units.crypto.keyderive.KeyDerivation">KeyDerivation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.PBKDF1.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.keyderive.KeyDerivation" href="units/crypto/keyderive/index.html#refinery.units.crypto.keyderive.KeyDerivation">KeyDerivation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.PBKDF2"><code class="flex name class">
<span>class <span class="ident">PBKDF2</span></span>
<span>(</span><span>size, salt, iter=1000, hash='SHA1')</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.keyderive.pbkdf2" href="units/crypto/keyderive/pbkdf2.html">refinery.units.crypto.keyderive.pbkdf2</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: PBKDF2 [-h] [-Q] [-0] [-v] [-I N] [-H HASH] size salt

PBKDF2 Key derivation

positional arguments:
  size             The number of bytes to generate.
  salt             Salt for the derivation.

optional arguments:
  -I, --iter N     Number of iterations; default is 1000.
  -H, --hash HASH  Specify the hash algorithm, default is SHA1. May be any
                   of the following: MD2, MD4, MD5, SHA1, SHA256, SHA512,
                   SHA224, SHA384

generic options:
  -h, --help       Show this help message and exit.
  -Q, --quiet      Disables all log output.
  -0, --devnull    Do not produce any output.
  -v, --verbose    Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/keyderive/pbkdf2.py#L8-L21" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class PBKDF2(KeyDerivation):
    &#34;&#34;&#34;PBKDF2 Key derivation&#34;&#34;&#34;

    def __init__(self, size, salt, iter=1000, hash=&#39;SHA1&#39;):
        self.superinit(super(), **vars())

    def process(self, data):
        return PBKDF2_(
            data.decode(self.codec),
            self.args.salt,
            dkLen=self.args.size,
            hmac_hash_module=self.hash,
            count=self.args.iter
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.keyderive.KeyDerivation" href="units/crypto/keyderive/index.html#refinery.units.crypto.keyderive.KeyDerivation">KeyDerivation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.PBKDF2.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.keyderive.KeyDerivation" href="units/crypto/keyderive/index.html#refinery.units.crypto.keyderive.KeyDerivation">KeyDerivation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.ucrypt"><code class="flex name class">
<span>class <span class="ident">ucrypt</span></span>
<span>(</span><span>size=13, salt=b'AA')</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.crypto.keyderive.unixcrypt" href="units/crypto/keyderive/unixcrypt.html">refinery.units.crypto.keyderive.unixcrypt</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: ucrypt [-h] [-Q] [-0] [-v] [size] [salt]

Implements the classic Unix crypt algorithm.

positional arguments:
  size           The number of bytes to generate, default is 13.
  salt           Salt for the derivation, the default is &quot;AA&quot;.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/crypto/keyderive/unixcrypt.py#L336-L354" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ucrypt(KeyDerivation):
    &#34;&#34;&#34;
    Implements the classic Unix crypt algorithm.
    &#34;&#34;&#34;
    def __init__(
        self,
        size: arg(help=&#39;The number of bytes to generate, default is 13.&#39;) = 13,
        salt: arg(help=&#39;Salt for the derivation, the default is &#34;AA&#34;.&#39;) = B&#39;AA&#39;
    ):
        super().__init__(size=size, salt=salt)

    def process(self, data):
        crypted = bytes(UnixCrypt(data, salt=self.args.salt))
        if len(crypted) &lt; self.args.size:
            raise RefineryPartialResult(
                F&#39;unix crypt only provided {len(crypted)} bytes, but {self.args.size} &#39;
                F&#39;were requested.&#39;, partial=crypted
            )
        return crypted[:self.args.size]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.keyderive.KeyDerivation" href="units/crypto/keyderive/index.html#refinery.units.crypto.keyderive.KeyDerivation">KeyDerivation</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.ucrypt.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.keyderive.KeyDerivation" href="units/crypto/keyderive/index.html#refinery.units.crypto.keyderive.KeyDerivation">KeyDerivation</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.keyderive.KeyDerivation.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.b32"><code class="flex name class">
<span>class <span class="ident">b32</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.encoding.b32" href="units/encoding/b32.html">refinery.units.encoding.b32</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: b32 [-h] [-R] [-Q] [-0] [-v]

Base32 encoding and decoding.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/b32.py#L8-L18" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class b32(Unit):
    &#34;&#34;&#34;
    Base32 encoding and decoding.
    &#34;&#34;&#34;
    def __init__(self): super().__init__()

    def reverse(self, data):
        return base64.b32encode(data)

    def process(self, data):
        return base64.b32decode(data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.b32.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.b64"><code class="flex name class">
<span>class <span class="ident">b64</span></span>
<span>(</span><span>urlsafe=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.encoding.b64" href="units/encoding/b64.html">refinery.units.encoding.b64</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: b64 [-h] [-R] [-Q] [-0] [-v] [-u]

Base64 encoding and decoding.

optional arguments:
  -u, --urlsafe  use URL-safe alphabet

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/b64.py#L8-L28" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class b64(Unit):
    &#34;&#34;&#34;
    Base64 encoding and decoding.
    &#34;&#34;&#34;
    def __init__(self, urlsafe: arg.switch(&#39;-u&#39;, help=&#39;use URL-safe alphabet&#39;) = False):
        super().__init__(urlsafe=urlsafe)

    @property
    def altchars(self):
        if self.args.urlsafe:
            return B&#39;-_&#39;

    def reverse(self, data):
        return base64.b64encode(data, altchars=self.altchars)

    def process(self, data):
        if len(data) &lt;= 1:
            raise ValueError(&#39;single byte can not be base64-decoded.&#39;)
        if data:
            data += B&#39;=&#39; * (-len(data) % 4)
            return base64.b64decode(data, altchars=self.altchars)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.b64.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="refinery.b64.altchars"><code class="name">var <span class="ident">altchars</span></code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/b64.py#L15-L18" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@property
def altchars(self):
    if self.args.urlsafe:
        return B&#39;-_&#39;</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.b85"><code class="flex name class">
<span>class <span class="ident">b85</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.encoding.b85" href="units/encoding/b85.html">refinery.units.encoding.b85</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: b85 [-h] [-R] [-Q] [-0] [-v]

Base85 encoding and decoding.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/b85.py#L8-L16" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class b85(Unit):
    &#34;&#34;&#34;
    Base85 encoding and decoding.
    &#34;&#34;&#34;
    def reverse(self, data):
        return base64.b85encode(data)

    def process(self, data):
        return base64.b85decode(data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.b85.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.base"><code class="flex name class">
<span>class <span class="ident">base</span></span>
<span>(</span><span>base=0, bigendian=True)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.encoding.base" href="units/encoding/base.html">refinery.units.encoding.base</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: base [-h] [-R] [-Q] [-0] [-v] [-e] [base]

Encodes and decodes integers in arbitrary base, using the letters of the
alphabet as an additional possible 26 digits. The largest base that can be
represented in this manner is 36.

positional arguments:
  base           Base to be used for conversion; default value of 0 uses
                 common python syntax such as the 0x prefix for
                 hexadecimal.

optional arguments:
  -e, --lend     Use little endian instead of the default big endian byte
                 order

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/base.py#L7-L58" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class base(Unit):
    &#34;&#34;&#34;
    Encodes and decodes integers in arbitrary base, using the letters of the
    alphabet as an additional possible 26 digits. The largest base that can
    be represented in this manner is 36.
    &#34;&#34;&#34;

    _DIGITS = B&#39;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;

    def __init__(
        self,
        base: arg(type=number[2:36], help=(
            &#39;Base to be used for conversion; default value of 0 uses common &#39;
            &#39;python syntax such as the 0x prefix for hexadecimal.&#39;)) = 0,
        bigendian: arg(&#39;-e&#39;, &#39;--lend&#39;, help=(
            &#39;Use little endian instead of the default big endian byte order&#39;)) = True
    ):
        if base and base not in range(2, 37):
            raise ValueError(&#39;base may only be an integer between 2 and 36&#39;)
        super().__init__(base=base, bigendian=bigendian)

    @property
    def byteorder(self):
        return &#39;big&#39; if self.args.bigendian else &#39;little&#39;

    def reverse(self, data):
        self.log_info(&#39;using byte order&#39;, self.byteorder)
        number = int.from_bytes(data, byteorder=self.byteorder)

        if number == 0:
            return B&#39;0&#39;
        if self.args.base == 0:
            return B&#39;0x%X&#39; % number
        if self.args.base &gt; len(self._DIGITS):
            raise ValueError(
                F&#39;Only {len(self._DIGITS)} available; not enough to &#39;
                F&#39;encode base {self.args.base}&#39;
            )

        def reverse_result(number):
            while number:
                yield self._DIGITS[number % self.args.base]
                number //= self.args.base

        return bytes(reversed(tuple(reverse_result(number))))

    def process(self, data):
        data = data.strip()
        number = int(data, self.args.base)
        size, rest = divmod(number.bit_length(), 8)
        if rest: size += 1
        return number.to_bytes(size, byteorder=self.byteorder)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.base.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="refinery.base.byteorder"><code class="name">var <span class="ident">byteorder</span></code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/base.py#L28-L30" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@property
def byteorder(self):
    return &#39;big&#39; if self.args.bigendian else &#39;little&#39;</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.cp1252"><code class="flex name class">
<span>class <span class="ident">cp1252</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.encoding.cp1252" href="units/encoding/cp1252.html">refinery.units.encoding.cp1252</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: cp1252 [-h] [-R] [-Q] [-0] [-v]

Encodes and decodes Windows CP 1252 (aka Latin1) encoded string data.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/cp1252.py#L6-L15" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class cp1252(Unit):
    &#34;&#34;&#34;
    Encodes and decodes Windows CP 1252 (aka Latin1) encoded string data.
    &#34;&#34;&#34;

    def process(self, data):
        return data.decode(self.codec).encode(&#39;cp1252&#39;)

    def reverse(self, data):
        return data.decode(&#39;cp1252&#39;).encode(self.codec)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.cp1252.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.esc"><code class="flex name class">
<span>class <span class="ident">esc</span></span>
<span>(</span><span>hex=False, unicode=False, greedy=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.encoding.esc" href="units/encoding/esc.html">refinery.units.encoding.esc</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: esc [-h] [-R] [-Q] [-0] [-v] [-x] [-u] [-g]

Encodes and decodes common ASCII escape sequences.

optional arguments:
  -x, --hex      Hex encode everything, do not use C escape sequences.
  -u, --unicode  Use unicode escape sequences and UTF-8 encoding.
  -g, --greedy   Replace \x by x and \u by u when not followed by two or
                 four hex digits, respectively.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/esc.py#L8-L75" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class esc(Unit):
    &#34;&#34;&#34;
    Encodes and decodes common ASCII escape sequences.
    &#34;&#34;&#34;
    _ESCAPE = {
        0x00: BR&#39;\0&#39;,
        0x07: BR&#39;\a&#39;,
        0x08: BR&#39;\b&#39;,
        0x0C: BR&#39;\f&#39;,
        0x0A: BR&#39;\n&#39;,
        0x0D: BR&#39;\r&#39;,
        0x09: BR&#39;\t&#39;,
        0x0B: BR&#39;\v&#39;,
        0x5C: BR&#39;\\&#39;,
        0x27: BR&#39;\&#39;&#39;,
        0x22: BR&#39;\&#34;&#39;
    }
    _UNESCAPE = {
        BR&#39;0&#39;: B&#39;\x00&#39;,
        BR&#39;a&#39;: B&#39;\x07&#39;,
        BR&#39;b&#39;: B&#39;\x08&#39;,
        BR&#39;f&#39;: B&#39;\x0C&#39;,
        BR&#39;n&#39;: B&#39;\x0A&#39;,
        BR&#39;r&#39;: B&#39;\x0D&#39;,
        BR&#39;t&#39;: B&#39;\x09&#39;,
        BR&#39;v&#39;: B&#39;\x0B&#39;,
        B&#39;\\&#39;: B&#39;\x5C&#39;,
        BR&#34;&#39;&#34;: B&#39;\x27&#39;,
        BR&#39;&#34;&#39;: B&#39;\x22&#39;
    }

    def __init__(self,
        hex     : arg.switch(&#39;-x&#39;, help=&#39;Hex encode everything, do not use C escape sequences.&#39;) = False,
        unicode : arg.switch(&#39;-u&#39;, help=&#39;Use unicode escape sequences and UTF-8 encoding.&#39;) = False,
        greedy  : arg.switch(&#39;-g&#39;, help=&#39;Replace \\x by x and \\u by u when not followed by two or four hex digits, respectively.&#39;) = False
    ) -&gt; Unit: pass  # noqa

    def process(self, data):
        if self.args.unicode:
            return data.decode(&#39;UNICODE_ESCAPE&#39;).encode(self.codec)

        def unescape(match):
            c = match[1]
            if len(c) &gt; 1:
                if c[0] in B&#39;u&#39;:  # unicode
                    return bytes((int(c[3:5], 16), int(c[1:3], 16)))
                if c[0] in B&#39;x&#39;:  # hexadecimal
                    return bytes((int(c[1:3], 16),))
            elif c in B&#39;ux&#39;:
                return c if self.args.greedy else match[0]
            return self._UNESCAPE.get(c, c)
        data = re.sub(
            RB&#39;\\(u[a-fA-F0-9]{4}|x[a-fA-F0-9]{2}|.)&#39;, unescape, data)
        return data

    def reverse(self, data):
        if self.args.unicode:
            return data.decode(self.codec).encode(&#39;UNICODE_ESCAPE&#39;)
        elif not self.args.hex:
            def escape(match):
                c = match[0][0]
                return self._ESCAPE.get(c, RB&#39;\x%02x&#39; % c)
        else:
            def escape(match):
                c = match[0][0]
                return RB&#39;\x%02x&#39; % c

        return re.sub(RB&#39;[\x00-\x1F\x22\x27\x5C\x7F-\xFF]&#39;, escape, data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.esc.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.hex"><code class="flex name class">
<span>class <span class="ident">hex</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.encoding.hex" href="units/encoding/hex.html">refinery.units.encoding.hex</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: hex [-h] [-R] [-Q] [-0] [-v]

Hex-decodes and encodes binary data. Non hex characters are removed from
the input. For decoding, any odd trailing hex digits are stripped as two
hex digits are required to represent a byte.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/hex.py#L6-L23" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class hex(Unit):
    &#34;&#34;&#34;
    Hex-decodes and encodes binary data. Non hex characters are removed from
    the input. For decoding, any odd trailing hex digits are stripped as two
    hex digits are required to represent a byte.
    &#34;&#34;&#34;

    def reverse(self, data):
        import base64
        return base64.b16encode(data)

    def process(self, data):
        import re
        import base64
        data = re.sub(B&#39;[^A-Fa-f0-9]+&#39;, B&#39;&#39;, data)
        if len(data) % 2:
            data = data[:-1]
        return base64.b16decode(data, casefold=True)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.hex.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.html"><code class="flex name class">
<span>class <span class="ident">html</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.encoding.htm" href="units/encoding/htm.html">refinery.units.encoding.htm</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: html [-h] [-R] [-Q] [-0] [-v]

Encodes and decodes common ASCII escape sequences.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/htm.py#L9-L20" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class html(Unit):
    &#34;&#34;&#34;
    Encodes and decodes common ASCII escape sequences.
    &#34;&#34;&#34;

    @unicoded
    def process(self, data: str) -&gt; str:
        return html_.unescape(data)

    @unicoded
    def reverse(self, data: str) -&gt; str:
        return html_.escape(data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.html.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.netbios"><code class="flex name class">
<span>class <span class="ident">netbios</span></span>
<span>(</span><span>key=b'A')</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.encoding.netbios" href="units/encoding/netbios.html">refinery.units.encoding.netbios</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: netbios [-h] [-R] [-Q] [-0] [-v] [key]

Encodes and decodes strings using the same algorithm that is used for
NetBIOS labels. Each byte 0xUL is encoded as two bytes, which are the sum
of 0xU and 0xL with an offset character, respectively. The default offset
is the capital letter A.

positional arguments:
  key            Provide a single letter to use as the offset.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/netbios.py#L6-L38" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class netbios(Unit):
    &#34;&#34;&#34;
    Encodes and decodes strings using the same algorithm that is used for NetBIOS
    labels. Each byte 0xUL is encoded as two bytes, which are the sum of 0xU and
    0xL with an offset character, respectively. The default offset is the capital
    letter A.
    &#34;&#34;&#34;

    def __init__(self, key: arg(help=&#34;Provide a single letter to use as the offset.&#34;) = B&#39;A&#39;):
        if len(key) != 1:
            raise ValueError(&#34;The key must be a binary string of length exactly 1&#34;)
        super().__init__(key=key[0])

    def reverse(self, data):
        result = bytearray(2 * len(data))
        for k, byte in enumerate(data):
            hi, lo = byte &gt;&gt; 4, byte &amp; 15
            result[2 * k + 0] = hi + self.args.key
            result[2 * k + 1] = lo + self.args.key
        return result

    def process(self, data):
        def merge(it):
            while True:
                try:
                    hi = next(it) - self.args.key
                    lo = next(it) - self.args.key
                    if hi not in range(16) or lo not in range(16):
                        raise ValueError(F&#39;Invalid character encoding detected: hi={hi:X}, lo={lo:X}.&#39;)
                    yield (hi &lt;&lt; 4) | lo
                except StopIteration:
                    break
        return bytearray(merge(iter(data)))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.netbios.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.ps1str"><code class="flex name class">
<span>class <span class="ident">ps1str</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.encoding.ps1str" href="units/encoding/ps1str.html">refinery.units.encoding.ps1str</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: ps1str [-h] [-R] [-Q] [-0] [-v]

Escapes and unescapes PowerShell strings.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/ps1str.py#L9-L69" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ps1str(Unit):
    &#34;&#34;&#34;
    Escapes and unescapes PowerShell strings.
    &#34;&#34;&#34;
    UNESCAPE = {
        &#39;`0&#39;: &#39;\0&#39;,
        &#39;`a&#39;: &#39;\a&#39;,
        &#39;`b&#39;: &#39;\b&#39;,
        &#39;`f&#39;: &#39;\f&#39;,
        &#39;`n&#39;: &#39;\n&#39;,
        &#39;`r&#39;: &#39;\r&#39;,
        &#39;`t&#39;: &#39;\t&#39;,
        &#39;`v&#39;: &#39;\v&#39;,
        &#39;``&#39;: &#39;`&#39;,
        &#34;`&#39;&#34;: &#39;\&#39;&#39;,
        &#39;`&#34;&#39;: &#39;\&#34;&#39;,
    }
    ESCAPE = {
        &#39;`&#39; : &#39;``&#39;,
        &#39;$&#39; : &#39;`$&#39;,
        &#39;\0&#39;: &#39;`0&#39;,
        &#39;\a&#39;: &#39;`a&#39;,
        &#39;\b&#39;: &#39;`b&#39;,
        &#39;\f&#39;: &#39;`f&#39;,
        &#39;\n&#39;: &#39;`n&#39;,
        &#39;\r&#39;: &#39;`r&#39;,
        &#39;\t&#39;: &#39;`t&#39;,
        &#39;\v&#39;: &#39;`v&#39;,
        &#39;\&#39;&#39;: &#34;`&#39;&#34;,
        &#39;\&#34;&#39;: &#39;`&#34;&#39;,
    }

    def __init__(self): pass

    @unicoded
    def process(self, data):
        if data[0] not in &#39;&#39;&#39;&#39;&#34;&#39;&#39;&#39; or data[-1] != data[0]:
            raise ValueError(
                &#39;No quotes found at beginning of input. To escape a PowerShell string, the &#39;
                &#39;quotes must be included because quote escaping depends on whether a single &#39;
                &#39;or double quote was used.&#39;)

        quote, data = data[0], data[1:-1]

        def unescape(match):
            string = match[0]
            return self.UNESCAPE.get(string, string[1:])

        if quote == &#39;&#34;&#39;:
            if re.search(R&#39;(?&lt;!`)\$(?=[\w\(\{\$\?\^:])&#39;, data):
                self.log_warn(&#39;Loss of information: double quoted string contains variable substitutions.&#39;)
            data = re.sub(&#39;`.&#39;, unescape, data)

        return data.replace(quote + quote, quote)

    @unicoded
    def reverse(self, data):
        def escaper(match):
            char = match[0]
            return ps1str.ESCAPE.get(char, char)
        return &#39;&#34;{}&#34;&#39;.format(re.sub(R&#39;&#39;&#39;[\x00\x07-\x0D`$&#39;&#34;]&#39;&#39;&#39;, escaper, data))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.ps1str.UNESCAPE"><code class="name">var <span class="ident">UNESCAPE</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.ps1str.ESCAPE"><code class="name">var <span class="ident">ESCAPE</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.ps1str.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.recode"><code class="flex name class">
<span>class <span class="ident">recode</span></span>
<span>(</span><span>decode=None, encode='UTF8', decerr=None, encerr=None, errors=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.encoding.recode" href="units/encoding/recode.html">refinery.units.encoding.recode</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: recode [-h] [-R] [-Q] [-0] [-v] [-d Handler] [-e Handler]
              [-E Handler]
              [decode-as] [encode-as]

Expects input string data encoded in the from encoding and encodes it in
the to encoding, then outputs the result.

positional arguments:
  decode-as             Input encoding; Guess encoding by default.
  encode-as             Output encoding; The default is UTF8.

optional arguments:
  -d, --decerr Handler  Specify an error handler for decoding.
  -e, --encerr Handler  Specify an error handler for encoding.
  -E, --errors Handler  Specify an error handler for both encoding and
                        decoding. The possible choices are the following:
                        STRICT, IGNORE, REPLACE, XMLREF, BACKSLASH,
                        SURROGATE

generic options:
  -h, --help            Show this help message and exit.
  -R, --reverse         Use the reverse operation.
  -Q, --quiet           Disables all log output.
  -0, --devnull         Do not produce any output.
  -v, --verbose         Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/recode.py#L19-L62" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class recode(Unit):
    &#34;&#34;&#34;
    Expects input string data encoded in the `from` encoding and encodes it in
    the `to` encoding, then outputs the result.
    &#34;&#34;&#34;

    def __init__(
        self,
        decode: arg(metavar=&#39;decode-as&#39;, type=str, help=&#39;Input encoding; Guess encoding by default.&#39;) = None,
        encode: arg(metavar=&#39;encode-as&#39;, type=str, help=F&#39;Output encoding; The default is {Unit.codec}.&#39;) = Unit.codec,
        decerr: arg.option(&#39;-d&#39;, choices=Handler,
            help=&#39;Specify an error handler for decoding.&#39;) = None,
        encerr: arg.option(&#39;-e&#39;, choices=Handler,
            help=&#39;Specify an error handler for encoding.&#39;) = None,
        errors: arg.option(&#39;-E&#39;, choices=Handler, help=(
            &#39;Specify an error handler for both encoding and decoding. &#39;
            &#39;The possible choices are the following: {choices}&#39;)) = None,
    ):
        super().__init__(
            decode=decode,
            encode=encode,
            decerr=makeinstance(Handler, decerr or errors or &#39;STRICT&#39;).value,
            encerr=makeinstance(Handler, encerr or errors or &#39;STRICT&#39;).value
        )

    def detect(self, data):
        mv = memoryview(data)
        if not any(mv[1::2]): return &#39;utf-16le&#39;
        if not any(mv[0::2]): return &#39;utf-16be&#39;
        import chardet
        detection = chardet.detect(data)
        codec = detection[&#39;encoding&#39;]
        self.log_info(lambda: F&#39;Using input encoding: {codec}, detected with {int(detection[&#34;confidence&#34;]*100)}% confidence.&#39;)
        return codec

    def _recode(self, enc, dec, encerr, decerr, data):
        dec = dec or self.detect(data)
        return codecs.encode(codecs.decode(data, dec, errors=decerr), enc, errors=encerr)

    def reverse(self, data):
        return self._recode(self.args.decode, self.args.encode, self.args.decerr, self.args.encerr, data)

    def process(self, data):
        return self._recode(self.args.encode, self.args.decode, self.args.encerr, self.args.decerr, data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.recode.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="refinery.recode.detect"><code class="name flex">
<span>def <span class="ident">detect</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/recode.py#L44-L52" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def detect(self, data):
    mv = memoryview(data)
    if not any(mv[1::2]): return &#39;utf-16le&#39;
    if not any(mv[0::2]): return &#39;utf-16be&#39;
    import chardet
    detection = chardet.detect(data)
    codec = detection[&#39;encoding&#39;]
    self.log_info(lambda: F&#39;Using input encoding: {codec}, detected with {int(detection[&#34;confidence&#34;]*100)}% confidence.&#39;)
    return codec</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.u16"><code class="flex name class">
<span>class <span class="ident">u16</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.encoding.u16" href="units/encoding/u16.html">refinery.units.encoding.u16</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: u16 [-h] [-R] [-Q] [-0] [-v]

Encodes and decodes UTF-16LE encoded string data.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/u16.py#L6-L15" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class u16(Unit):
    &#34;&#34;&#34;
    Encodes and decodes UTF-16LE encoded string data.
    &#34;&#34;&#34;

    def reverse(self, data):
        return data.decode(self.codec).encode(&#39;utf-16LE&#39;)

    def process(self, data):
        return data.decode(&#39;utf-16LE&#39;).encode(self.codec)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.u16.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.url"><code class="flex name class">
<span>class <span class="ident">url</span></span>
<span>(</span><span>plus=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.encoding.url" href="units/encoding/url.html">refinery.units.encoding.url</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: url [-h] [-R] [-Q] [-0] [-v] [-p]

Decodes and encodes URL-Encoding, which preserves only alphanumeric
characters and the symbols _, ., -, ~, \, and /. Every other character is
escaped by hex-encoding it and prefixing it with a percent symbol.

optional arguments:
  -p, --plus     also replace plus signs by spaces

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/url.py#L8-L37" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class url(Unit):
    &#34;&#34;&#34;
    Decodes and encodes URL-Encoding, which preserves only alphanumeric
    characters and the symbols `_`, `.`, `-`, `~`, `\\`, and `/`.
    Every other character is escaped by hex-encoding it and prefixing it
    with a percent symbol.
    &#34;&#34;&#34;

    def __init__(self, plus: arg.switch(&#39;-p&#39;, help=&#39;also replace plus signs by spaces&#39;) = False):
        super().__init__(plus=plus)

    def process(self, data):
        data = re.sub(
            B&#39;\\%([0-9a-fA-F]{2})&#39;,
            lambda m: bytes((int(m[1], 16),)),
            data
        )
        if self.args.plus:
            data = data.replace(B&#39;+&#39;, B&#39; &#39;)
        return data

    def reverse(self, data):
        if self.args.plus:
            data = data.replace(B&#39; &#39;, B&#39;+&#39;)
        data = re.sub(
            B&#39;[^a-zA-Z0-9_.-~\\/]&#39;,
            lambda m: B&#39;%%%02X&#39; % ord(m[0]),
            data
        )
        return data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.url.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.vbe"><code class="flex name class">
<span>class <span class="ident">vbe</span></span>
<span>(</span><span>marker=True)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.encoding.vbe" href="units/encoding/vbe.html">refinery.units.encoding.vbe</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: vbe [-h] [-R] [-Q] [-0] [-v] [-m]

Encoding and decoding of Visual Basic Scripts.

optional arguments:
  -m, --no-marker  Do not require magic marker when encoding and do not
                   search for marker when decoding.

generic options:
  -h, --help       Show this help message and exit.
  -R, --reverse    Use the reverse operation.
  -Q, --quiet      Disables all log output.
  -0, --devnull    Do not produce any output.
  -v, --verbose    Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/encoding/vbe.py#L9-L164" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class vbe(Unit):
    &#34;&#34;&#34;
    Encoding and decoding of Visual Basic Scripts.
    &#34;&#34;&#34;

    _MARKER_INIT = RB&#39;#@~^BINREF==&#39;
    _MARKER_STOP = RB&#39;BINREF==^#~@&#39;

    _CHUNKS = (
        0x57, 0x6E, 0x7B, 0x4A, 0x4C, 0x41, 0x0B, 0x0B, 0x0B, 0x0C, 0x0C, 0x0C, 0x4A, 0x4C, 0x41,
        0x0E, 0x0E, 0x0E, 0x0F, 0x0F, 0x0F, 0x10, 0x10, 0x10, 0x11, 0x11, 0x11, 0x12, 0x12, 0x12,
        0x13, 0x13, 0x13, 0x14, 0x14, 0x14, 0x15, 0x15, 0x15, 0x16, 0x16, 0x16, 0x17, 0x17, 0x17,
        0x18, 0x18, 0x18, 0x19, 0x19, 0x19, 0x1A, 0x1A, 0x1A, 0x1B, 0x1B, 0x1B, 0x1C, 0x1C, 0x1C,
        0x1D, 0x1D, 0x1D, 0x1E, 0x1E, 0x1E, 0x1F, 0x1F, 0x1F, 0x2E, 0x2D, 0x32, 0x47, 0x75, 0x30,
        0x7A, 0x52, 0x21, 0x56, 0x60, 0x29, 0x42, 0x71, 0x5B, 0x6A, 0x5E, 0x38, 0x2F, 0x49, 0x33,
        0x26, 0x5C, 0x3D, 0x49, 0x62, 0x58, 0x41, 0x7D, 0x3A, 0x34, 0x29, 0x35, 0x32, 0x36, 0x65,
        0x5B, 0x20, 0x39, 0x76, 0x7C, 0x5C, 0x72, 0x7A, 0x56, 0x43, 0x7F, 0x73, 0x38, 0x6B, 0x66,
        0x39, 0x63, 0x4E, 0x70, 0x33, 0x45, 0x45, 0x2B, 0x6B, 0x68, 0x68, 0x62, 0x71, 0x51, 0x59,
        0x4F, 0x66, 0x78, 0x09, 0x76, 0x5E, 0x62, 0x31, 0x7D, 0x44, 0x64, 0x4A, 0x23, 0x54, 0x6D,
        0x75, 0x43, 0x71, 0x4A, 0x4C, 0x41, 0x7E, 0x3A, 0x60, 0x4A, 0x4C, 0x41, 0x5E, 0x7E, 0x53,
        0x40, 0x4C, 0x40, 0x77, 0x45, 0x42, 0x4A, 0x2C, 0x27, 0x61, 0x2A, 0x48, 0x5D, 0x74, 0x72,
        0x22, 0x27, 0x75, 0x4B, 0x37, 0x31, 0x6F, 0x44, 0x37, 0x4E, 0x79, 0x4D, 0x3B, 0x59, 0x52,
        0x4C, 0x2F, 0x22, 0x50, 0x6F, 0x54, 0x67, 0x26, 0x6A, 0x2A, 0x72, 0x47, 0x7D, 0x6A, 0x64,
        0x74, 0x39, 0x2D, 0x54, 0x7B, 0x20, 0x2B, 0x3F, 0x7F, 0x2D, 0x38, 0x2E, 0x2C, 0x77, 0x4C,
        0x30, 0x67, 0x5D, 0x6E, 0x53, 0x7E, 0x6B, 0x47, 0x6C, 0x66, 0x34, 0x6F, 0x35, 0x78, 0x79,
        0x25, 0x5D, 0x74, 0x21, 0x30, 0x43, 0x64, 0x23, 0x26, 0x4D, 0x5A, 0x76, 0x52, 0x5B, 0x25,
        0x63, 0x6C, 0x24, 0x3F, 0x48, 0x2B, 0x7B, 0x55, 0x28, 0x78, 0x70, 0x23, 0x29, 0x69, 0x41,
        0x28, 0x2E, 0x34, 0x73, 0x4C, 0x09, 0x59, 0x21, 0x2A, 0x33, 0x24, 0x44, 0x7F, 0x4E, 0x3F,
        0x6D, 0x50, 0x77, 0x55, 0x09, 0x3B, 0x53, 0x56, 0x55, 0x7C, 0x73, 0x69, 0x3A, 0x35, 0x61,
        0x5F, 0x61, 0x63, 0x65, 0x4B, 0x50, 0x46, 0x58, 0x67, 0x58, 0x3B, 0x51, 0x31, 0x57, 0x49,
        0x69, 0x22, 0x4F, 0x6C, 0x6D, 0x46, 0x5A, 0x4D, 0x68, 0x48, 0x25, 0x7C, 0x27, 0x28, 0x36,
        0x5C, 0x46, 0x70, 0x3D, 0x4A, 0x6E, 0x24, 0x32, 0x7A, 0x79, 0x41, 0x2F, 0x37, 0x3D, 0x5F,
        0x60, 0x5F, 0x4B, 0x51, 0x4F, 0x5A, 0x20, 0x42, 0x2C, 0x36, 0x65, 0x57)
    _OFFSETS = (
        0, 1, 2, 0, 1, 2, 1, 2, 2, 1, 2, 1, 0, 2, 1, 2, 0, 2, 1, 2, 0, 0, 1, 2, 2, 1, 0, 2, 1, 2, 2, 1,
        0, 0, 2, 1, 2, 1, 2, 0, 2, 0, 0, 1, 2, 0, 2, 1, 0, 2, 1, 2, 0, 0, 1, 2, 2, 0, 0, 1, 2, 0, 2, 1)
    _ENCODER = {
        0x09 : [0x37, 0x69, 0x64], 0x0B : [0x0B, 0x0B, 0x0B], 0x0C : [0x0C, 0x0C, 0x0C],
        0x0E : [0x0E, 0x0E, 0x0E], 0x0F : [0x0F, 0x0F, 0x0F], 0x10 : [0x10, 0x10, 0x10],
        0x11 : [0x11, 0x11, 0x11], 0x12 : [0x12, 0x12, 0x12], 0x13 : [0x13, 0x13, 0x13],
        0x14 : [0x14, 0x14, 0x14], 0x15 : [0x15, 0x15, 0x15], 0x16 : [0x16, 0x16, 0x16],
        0x17 : [0x17, 0x17, 0x17], 0x18 : [0x18, 0x18, 0x18], 0x19 : [0x19, 0x19, 0x19],
        0x1A : [0x1A, 0x1A, 0x1A], 0x1B : [0x1B, 0x1B, 0x1B], 0x1C : [0x1C, 0x1C, 0x1C],
        0x1D : [0x1D, 0x1D, 0x1D], 0x1E : [0x1E, 0x1E, 0x1E], 0x1F : [0x1F, 0x1F, 0x1F],
        0x20 : [0x7E, 0x2C, 0x50], 0x21 : [0x5A, 0x65, 0x22], 0x22 : [0x45, 0x72, 0x4A],
        0x23 : [0x3A, 0x5B, 0x61], 0x24 : [0x79, 0x66, 0x5E], 0x25 : [0x59, 0x75, 0x5D],
        0x26 : [0x27, 0x4C, 0x5B], 0x27 : [0x76, 0x45, 0x42], 0x28 : [0x63, 0x76, 0x60],
        0x29 : [0x62, 0x2A, 0x23], 0x2A : [0x4D, 0x43, 0x65], 0x2B : [0x51, 0x33, 0x5F],
        0x2C : [0x53, 0x42, 0x7E], 0x2D : [0x52, 0x20, 0x4F], 0x2E : [0x20, 0x63, 0x52],
        0x2F : [0x26, 0x4A, 0x7A], 0x30 : [0x54, 0x5A, 0x21], 0x31 : [0x71, 0x38, 0x46],
        0x32 : [0x2B, 0x79, 0x20], 0x33 : [0x66, 0x32, 0x26], 0x34 : [0x2A, 0x57, 0x63],
        0x35 : [0x58, 0x6C, 0x2A], 0x36 : [0x7F, 0x2B, 0x76], 0x37 : [0x7B, 0x46, 0x47],
        0x38 : [0x30, 0x52, 0x25], 0x39 : [0x31, 0x4F, 0x2C], 0x3A : [0x6C, 0x3D, 0x29],
        0x3B : [0x49, 0x70, 0x69], 0x3D : [0x78, 0x7B, 0x27], 0x3F : [0x5F, 0x51, 0x67],
        0x40 : [0x40, None, 0x40], 0x41 : [0x29, 0x7A, 0x62], 0x42 : [0x24, 0x7E, 0x41],
        0x43 : [0x2F, 0x3B, 0x5A], 0x44 : [0x39, 0x47, 0x66], 0x45 : [0x33, 0x41, 0x32],
        0x46 : [0x6F, 0x77, 0x73], 0x47 : [0x21, 0x56, 0x4D], 0x48 : [0x75, 0x5F, 0x43],
        0x49 : [0x28, 0x26, 0x71], 0x4A : [0x42, 0x78, 0x39], 0x4B : [0x46, 0x6E, 0x7C],
        0x4C : [0x4A, 0x64, 0x53], 0x4D : [0x5C, 0x74, 0x48], 0x4E : [0x48, 0x67, 0x31],
        0x4F : [0x36, 0x7D, 0x72], 0x50 : [0x4B, 0x68, 0x6E], 0x51 : [0x7D, 0x35, 0x70],
        0x52 : [0x5D, 0x22, 0x49], 0x53 : [0x6A, 0x55, 0x3F], 0x54 : [0x50, 0x3A, 0x4B],
        0x55 : [0x69, 0x60, 0x6A], 0x56 : [0x23, 0x6A, 0x2E], 0x57 : [0x09, 0x71, 0x7F],
        0x58 : [0x70, 0x6F, 0x28], 0x59 : [0x65, 0x49, 0x35], 0x5A : [0x74, 0x5C, 0x7D],
        0x5B : [0x2C, 0x5D, 0x24], 0x5C : [0x77, 0x27, 0x2D], 0x5D : [0x44, 0x59, 0x54],
        0x5E : [0x3F, 0x25, 0x37], 0x5F : [0x6D, 0x7C, 0x7B], 0x60 : [0x7C, 0x23, 0x3D],
        0x61 : [0x43, 0x6D, 0x6C], 0x62 : [0x38, 0x28, 0x34], 0x63 : [0x5E, 0x31, 0x6D],
        0x64 : [0x5B, 0x39, 0x4E], 0x65 : [0x6E, 0x7F, 0x2B], 0x66 : [0x57, 0x36, 0x30],
        0x67 : [0x4C, 0x54, 0x6F], 0x68 : [0x34, 0x34, 0x74], 0x69 : [0x72, 0x62, 0x6B],
        0x6A : [0x25, 0x4E, 0x4C], 0x6B : [0x56, 0x30, 0x33], 0x6C : [0x73, 0x5E, 0x56],
        0x6D : [0x68, 0x73, 0x3A], 0x6E : [0x55, 0x09, 0x78], 0x6F : [0x47, 0x4B, 0x57],
        0x70 : [0x32, 0x61, 0x77], 0x71 : [0x35, 0x24, 0x3B], 0x72 : [0x2E, 0x4D, 0x44],
        0x73 : [0x64, 0x6B, 0x2F], 0x74 : [0x4F, 0x44, 0x59], 0x75 : [0x3B, 0x21, 0x45],
        0x76 : [0x2D, 0x37, 0x5C], 0x77 : [0x41, 0x53, 0x68], 0x78 : [0x61, 0x58, 0x36],
        0x79 : [0x7A, 0x48, 0x58], 0x7A : [0x22, 0x2E, 0x79], 0x7B : [0x60, 0x50, 0x09],
        0x7C : [0x6B, 0x2D, 0x75], 0x7D : [0x4E, 0x29, 0x38], 0x7E : [0x3D, 0x3F, 0x55],
        0x7F : [0x67, 0x2F, 0x51]
    }

    _ESCAPE = {
        0x40: B&#39;@$&#39;,
        0x3C: B&#39;@!&#39;,
        0x3E: B&#39;@*&#39;,
        0x0D: B&#39;@#&#39;,
        0x0A: B&#39;@&amp;&#39;,
    }

    _UNESCAPE = {
        B&#39;@$&#39;: B&#39;@&#39;,
        B&#39;@!&#39;: B&#39;&lt;&#39;,
        B&#39;@*&#39;: B&#39;&gt;&#39;,
        B&#39;@#&#39;: B&#39;\r&#39;,
        B&#39;@&amp;&#39;: B&#39;\n&#39;,
    }

    def __init__(
        self,
        marker: arg.switch(&#39;-m&#39;, &#39;--no-marker&#39;, off=True, help=(
            &#39;Do not require magic marker when encoding and do not search for &#39;
            &#39;marker when decoding.&#39;)
        ) = True
    ):
        super().__init__(marker=marker)

    @classmethod
    def _chunk(cls, byte, index):
        k = byte - 9
        c = cls._CHUNKS[k * 3 : k * 3 + 3]
        return c[cls._OFFSETS[index % 64]]

    def _escape(self, iterable):
        escapes = bytes(self._ESCAPE)
        if self.args.marker:
            yield from self._MARKER_INIT
        for byte in iterable:
            if byte in escapes:
                yield from self._ESCAPE[byte]
            else:
                yield byte
        if self.args.marker:
            yield from self._MARKER_STOP

    def _unescape(self, data):
        def unescaper(m): return self._UNESCAPE[m[0]]
        return re.sub(RB&#39;@[$!*#&amp;]&#39;, unescaper, data)

    @classmethod
    def _decoded(cls, data):
        index = -1
        for byte in data:
            if byte &lt; 128:
                index += 1
            if (byte == 9 or 31 &lt; byte &lt; 128) and byte != 60 and byte != 62 and byte != 64:
                byte = cls._chunk(byte, index)
            yield byte

    @classmethod
    def _encoded(cls, data):
        for i, byte in enumerate(data):
            try:
                sequence = cls._ENCODER[byte]
            except KeyError:
                yield byte
            else:
                offset = cls._OFFSETS[i % 0x40]
                yield sequence[offset]

    def reverse(self, data):
        return bytearray(self._escape(self._encoded(data)))

    def process(self, data):
        if self.args.marker:
            match = formats.vbe.search(data)
            if not match:
                raise ValueError(&#39;Encoded script marker was not found.&#39;)
            data = match[0][12:-12]
        return bytearray(self._decoded(self._unescape(data)))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.vbe.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.dsjava"><code class="flex name class">
<span>class <span class="ident">dsjava</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.deserialize_java" href="units/formats/deserialize_java.html">refinery.units.formats.deserialize_java</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: dsjava [-h] [-Q] [-0] [-v]

Deserialize Java serialized data and re-serialize as JSON.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/deserialize_java.py#L55-L61" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class dsjava(Unit):
    &#34;&#34;&#34;
    Deserialize Java serialized data and re-serialize as JSON.
    &#34;&#34;&#34;
    def process(self, data):
        with JavaEncoder as encoder:
            return encoder.dumps(java.loads(data)).encode(self.codec)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.dsjava.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.dsphp"><code class="flex name class">
<span>class <span class="ident">dsphp</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.deserialize_php" href="units/formats/deserialize_php.html">refinery.units.formats.deserialize_php</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: dsphp [-h] [-Q] [-0] [-v]

Deserialize PHP serialized data and re-serialize as JSON.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/deserialize_php.py#L12-L37" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class dsphp(Unit):
    &#34;&#34;&#34;
    Deserialize PHP serialized data and re-serialize as JSON.
    &#34;&#34;&#34;

    class _encoder(json.JSONEncoder):
        def default(self, obj):
            try:
                return super().default(obj)
            except TypeError:
                pass
            if isinstance(obj, bytes) or isinstance(obj, bytearray):
                return obj.decode(&#39;utf8&#39;)
            if isinstance(obj, php.phpobject):
                return obj._asdict()

    def process(self, data):
        return json.dumps(
            php.loads(
                data,
                object_hook=php.phpobject,
                decode_strings=True
            ),
            indent=4,
            cls=self._encoder
        ).encode(self.codec)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.dsphp.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.elfslice"><code class="flex name class">
<span>class <span class="ident">elfslice</span></span>
<span>(</span><span>offset, end=None, take=0, utf16=False, ascii=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.elf.elfslice" href="units/formats/elf/elfslice.html">refinery.units.formats.elf.elfslice</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: elfslice [-h] [-Q] [-0] [-v] [-e END | -t N | -u | -a] offset

Extract data from ELF executables based on virtual offsets.

positional arguments:
  offset         Specify virtual offset as either .section:OFFSET or just
                 a virtual address in hex.

optional arguments:
  -e, --end END  Read bytes until this offset, which has to be located
                 after the starting offset.
  -t, --take N   The number of bytes to read.
  -u, --utf16    Read the memory at the given offset as an UTF16 string.
  -a, --ascii    Read the memory at the given offset as an ASCII string.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/elf/elfslice.py#L9-L43" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class elfslice(MemoryExtractorUnit):
    &#34;&#34;&#34;
    Extract data from ELF executables based on virtual offsets.
    &#34;&#34;&#34;

    def _get_file_offset(self, elf, offset):
        addr = offset.address
        if offset.section:
            for section in elf.iter_sections():
                if section.name == offset.section:
                    addr = section[&#39;sh_offset&#39;] + addr
                    return addr, addr + section.size
            else:
                raise ValueError(F&#39;unable to find section {offset.section}.&#39;)
        for segment in elf.iter_segments():
            begin = segment.header.p_vaddr
            size = segment.header.p_memsz
            delta = addr - begin
            if delta in range(size + 1):
                return segment.header.p_offset + delta, None
        else:
            raise ValueError(&#39;unable to find offset.&#39;)

    def _slice(self, off):
        end = off + self.args.limit if self.args.limit else None
        return slice(off, end)

    def process(self, data):
        try:
            elf = ELFFile(io.BytesIO(data))
        except Exception:
            raise ValueError(&#39;unable to parse input as ELF file&#39;)

        return self._read_from_memory(data,
            lambda addr: self._get_file_offset(elf, addr))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.formats.MemoryExtractorUnit" href="units/formats/index.html#refinery.units.formats.MemoryExtractorUnit">MemoryExtractorUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.elfslice.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.formats.MemoryExtractorUnit" href="units/formats/index.html#refinery.units.formats.MemoryExtractorUnit">MemoryExtractorUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.xtmail"><code class="flex name class">
<span>class <span class="ident">xtmail</span></span>
<span>(</span><span>*paths, list=False, join=False, **keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.email" href="units/formats/email.html">refinery.units.formats.email</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: xtmail [-h] [-Z] [-Q] [-0] [-v] [-l] [-j] [path [path ...]]

Extract files and body from EMail messages. The unit supports both the
Outlook message format and regular MIME documents.

positional arguments:
  path           Wildcard pattern for the name of the item to be
                 extracted. Each item is returned as a separate output of
                 this unit. Paths may contain wildcards. The default is a
                 single asterix, which means that every item will be
                 extracted.

optional arguments:
  -l, --list     Return all matching paths as UTF8-encoded output chunks.
  -j, --join     Join path names from container with previous path names.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/email.py#L15-L65" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class xtmail(PathExtractorUnit):
    &#34;&#34;&#34;
    Extract files and body from EMail messages. The unit supports both the Outlook message format
    and regular MIME documents.
    &#34;&#34;&#34;
    def _get_headparts(self, head):
        mw = mimewords()
        mw = partial(mw.process.__wrapped__.__wrapped__, mw)
        jh = defaultdict(list)
        for key, value in head:
            jh[key].append(mw(&#39;&#39;.join(t.lstrip() for t in value.splitlines(False))))
        jh = {k: v[0] if len(v) == 1 else v for k, v in jh.items()}
        yield UnpackResult(&#39;HEAD.TXT&#39;,
            lambda h=head: &#39;\n&#39;.join(F&#39;{k}: {v}&#39; for k, v in h).encode(self.codec))
        yield UnpackResult(&#39;HEAD.JSON&#39;,
            lambda jsn=jh: json.dumps(jsn, indent=4).encode(self.codec))

    def _get_parts_outlook(self, data):
        def ensure_bytes(data):
            return data if isinstance(data, bytes) else data.encode(self.codec)

        with Message(bytes(data)) as msg:
            yield from self._get_headparts(msg.header.items())
            if msg.body:
                yield UnpackResult(&#39;BODY.TXT&#39;, ensure_bytes(msg.body))
            if msg.htmlBody:
                yield UnpackResult(&#39;BODY.HTM&#39;, ensure_bytes(msg.htmlBody))
            for attachment in msg.attachments:
                path = attachment.longFilename or attachment.shortFilename
                yield UnpackResult(path, attachment.data)

    def _get_parts_regular(self, data):
        msg = BytesParser().parsebytes(data)

        yield from self._get_headparts(msg.items())

        for part in msg.walk():
            path = part.get_filename()
            data = part.get_payload(decode=True)
            if data is None:
                continue
            if path is None:
                path = F&#39;BODY.{file_extension(part.get_content_subtype(), &#34;TXT&#34;).upper()}&#39;
            yield UnpackResult(path, data)

    def unpack(self, data):
        try:
            yield from self._get_parts_outlook(data)
        except Exception as e:
            self.log_debug(F&#39;failed parsing input as Outlook message: {e}&#39;)
            yield from self._get_parts_regular(data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.formats.PathExtractorUnit" href="units/formats/index.html#refinery.units.formats.PathExtractorUnit">PathExtractorUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.xtmail.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="refinery.xtmail.unpack"><code class="name flex">
<span>def <span class="ident">unpack</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/email.py#L60-L65" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def unpack(self, data):
    try:
        yield from self._get_parts_outlook(data)
    except Exception as e:
        self.log_debug(F&#39;failed parsing input as Outlook message: {e}&#39;)
        yield from self._get_parts_regular(data)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.formats.PathExtractorUnit" href="units/formats/index.html#refinery.units.formats.PathExtractorUnit">PathExtractorUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.formats.PathExtractorUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.httpresponse"><code class="flex name class">
<span>class <span class="ident">httpresponse</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.httpresponse" href="units/formats/httpresponse.html">refinery.units.formats.httpresponse</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: httpresponse [-h] [-Q] [-0] [-v]

Parses HTTP response text, as you would obtain from a packet dump. This
can be useful if chunked or compressed transfer encoding was used.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/httpresponse.py#L13-L23" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class httpresponse(Unit):
    &#34;&#34;&#34;
    Parses HTTP response text, as you would obtain from a packet dump. This can be
    useful if chunked or compressed transfer encoding was used.
    &#34;&#34;&#34;
    def process(self, data):
        with SockWrapper(data) as mock:
            mock.seek(0)
            parser = HTTPResponse(mock)
            parser.begin()
            return parser.read()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.httpresponse.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.xlxtr"><code class="flex name class">
<span>class <span class="ident">xlxtr</span></span>
<span>(</span><span>*refs)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.office.xlxtr" href="units/formats/office/xlxtr.html">refinery.units.formats.office.xlxtr</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: xlxtr [-h] [-Z] [-Q] [-0] [-v] [reference [reference ...]]

Extract data from Microsoft Excel documents, both Legacy and new XML type
documents. A sheet reference is of the form B1 or 1.2, both specifying the
first cell of the second column. A cell range can be specified as B1:C12,
or 1.2:C12, or 1.2:12.3. Finally, the unit will always refer to the first
sheet in the document and to change this, specify the sheet name or index
separated by a hashtag, i.e. sheet#B1:C12 or 1#B1:C12. Note that indices
are 1-based.

positional arguments:
  reference      A sheet reference to be extracted. If no sheet references
                 are given, the unit lists all sheet names.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/office/xlxtr.py#L81-L160" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class xlxtr(Unit):
    &#34;&#34;&#34;
    Extract data from Microsoft Excel documents, both Legacy and new XML type
    documents. A sheet reference is of the form `B1` or `1.2`, both specifying
    the first cell of the second column. A cell range can be specified as
    `B1:C12`, or `1.2:C12`, or `1.2:12.3`. Finally, the unit will always refer
    to the first sheet in the document and to change this, specify the sheet
    name or index separated by a hashtag, i.e. `sheet#B1:C12` or `1#B1:C12`.
    Note that indices are 1-based.
    &#34;&#34;&#34;

    def __init__(self, *refs: arg(metavar=&#39;reference&#39;, type=SheetReference, help=(
        &#39;A sheet reference to be extracted. &#39;
        &#39;If no sheet references are given, the unit lists all sheet names.&#39;
    ))):
        super().__init__(refs=refs)

    def _process_legacy(self, data):
        import io

        logfile = io.StringIO()
        wb = xlrd.open_workbook(
            file_contents=data,
            logfile=logfile,
            verbosity=self.args.verbose - 1,
            on_demand=True
        )

        logfile.seek(0)
        for entry in logfile:
            entry = entry.strip()
            if re.search(R&#39;^[A-Z]+:&#39;, entry) or &#39;***&#39; in entry:
                self.log_info(entry)

        if not self.args.refs:
            self._display_sheet_names(wb.sheet_names())
        for ref in self.args.refs:
            sh = wb.sheet_by_index(ref.get_sheet_index(wb.sheet_names()))
            for cell in ref:
                self.log_debug(&#39;emitting cell: ({},{})&#39;.format(*cell))
                col, row = cell
                try:
                    value = sh.cell_value(col - 1, row - 1)
                except IndexError:
                    continue
                if isinstance(value, str):
                    yield value.encode(self.codec)
                else:
                    self.log_warn(F&#39;value not a string in ({col},{row}):&#39;, value)

    def _process_xlsx(self, wb):
        if not self.args.refs:
            self._display_sheet_names(wb.sheetnames)
        for ref in self.args.refs:
            sh = wb.worksheets[ref.get_sheet_index(wb.sheetnames)]
            for cell in ref:
                self.log_debug(&#39;emitting cell: ({},{})&#39;.format(*cell))
                value = sh.cell(*cell).value
                if value:
                    yield value.encode(self.codec)

    def _display_sheet_names(self, sheets):
        sheets = list(sheets)
        if not sheets:
            return
        width = int(math.log(len(sheets), 10)) + 1
        for k, name in enumerate(sheets):
            self.output(F&#39;sheet {k:{width}d}:&#39;, name)

    def process(self, data):
        try:
            workbook = openpyxl.load_workbook(
                io.BytesIO(data),
                read_only=True
            )
        except Exception:
            self.log_info(&#39;reverting to xlrd module&#39;)
            yield from self._process_legacy(data)
        else:
            yield from self._process_xlsx(workbook)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.xlxtr.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.dncfx"><code class="flex name class">
<span>class <span class="ident">dncfx</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.pe.dotnet.dncfx" href="units/formats/pe/dotnet/dncfx.html">refinery.units.formats.pe.dotnet.dncfx</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: dncfx [-h] [-Z] [-Q] [-0] [-v]

Extracts the encrypted strings from ConfuserX protected .NET execuctables.
Each decrypted string is returned as a single output.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/dotnet/dncfx.py#L14-L109" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class dncfx(Unit):
    &#34;&#34;&#34;
    Extracts the encrypted strings from ConfuserX protected .NET execuctables.
    Each decrypted string is returned as a single output.
    &#34;&#34;&#34;
    _PATTERN_ARRAY_INIT = (
        br&#39;(\x1F.|\x20....)&#39;      # load size of a chunk
        br&#39;\x8D.\x00\x00\x01&#39;     # create a UInt32 array
        br&#39;\x25&#39;                  # dup
        br&#39;\xD0%s\x04&#39;            # ldtoken: RVA of array data
        br&#39;\x28.\x00\x00.&#39;        # call to InitializeArray
    )

    def process(self, data):
        header = DotNetHeader(data, parse_resources=False)
        decompressor = lzma()

        class IntegerAssignment:
            def __init__(self, match):
                self.offset = match.start()
                self.value, = struct.unpack(&#39;&lt;I&#39;, match[1])

        def get_size(match):
            ins = match[1]
            fmt = &#39;&lt;B&#39; if ins[0] == 0x1F else &#39;&lt;I&#39;
            result, = struct.unpack(fmt, ins[-struct.calcsize(fmt):])
            return result

        potential_seeds = [
            IntegerAssignment(m)
            for m in re.finditer(br&#39;\x20(....)&#39;, data, re.DOTALL)
        ]

        for entry in header.meta.RVAs:
            offset = header.pe.get_offset_from_rva(entry.RVA)
            index = struct.pack(&#39;&lt;I&#39;, entry.Field.Index)
            strings_found = 0
            for match in re.finditer(self._PATTERN_ARRAY_INIT % index[:3], data, flags=re.DOTALL):
                ms = match.start()

                def sortkey(t):
                    weight = abs(t.offset - ms)
                    if t.offset &lt; ms:
                        # this weights assignments after the array initialization down, but still
                        # prefers them over assignments that are further away than 2kb
                        weight += 2000
                    return weight

                size = get_size(match)

                if size % 0x10 or size &gt; 10000:
                    continue

                self.log_debug(F&#39;found RVA {entry.Field.Index} initialized with length {size}.&#39;)
                potential_seeds.sort(key=sortkey)

                for seed in potential_seeds[1:400]:
                    # the first potential_seed will always be the assignment of the size variable
                    ciphertext = data[offset:offset + size * 4]
                    key = self._xs64star(seed.value)
                    key = chunks.pack(key, 4) + ciphertext[:-0x40]
                    decrypted = strxor(key, ciphertext)
                    try:
                        decompressed = decompressor(decrypted)
                    except Exception as e:
                        self.log_debug(
                            F&#39;decompression failed for seed {seed.value:08X} at offset {seed.offset:08X}: {e}&#39;)
                        continue
                    else:
                        self.log_info(
                            F&#39;decompression worked for seed {seed.value:08X} at offset {seed.offset:08X}.&#39;)
                    if len(decompressed) &lt; 0x100:
                        continue
                    for string in self._extract_strings(decompressed):
                        strings_found += 1
                        yield string
                    if strings_found &gt; 10:
                        break

    def _xs64star(self, state):
        for i in range(16):
            state ^= (state &gt;&gt; 12) &amp; 0xFFFFFFFF
            state ^= (state &lt;&lt; 25) &amp; 0xFFFFFFFF
            state ^= (state &gt;&gt; 27) &amp; 0xFFFFFFFF
            yield state &amp; 0xFFFFFFFF

    def _extract_strings(self, blob):
        reader = StreamReader(blob)
        while reader.tell() &lt; len(blob):
            try:
                size = reader.expect(UInt32)
                string = reader.expect(StringPrimitive, size=size, codec=&#39;UTF8&#39;, align=4)
            except ParserEOF:
                return
            if string:
                yield string.encode(self.codec)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.dncfx.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.dnds"><code class="flex name class">
<span>class <span class="ident">dnds</span></span>
<span>(</span><span>dereference=True, encode=None, digest=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.pe.dotnet.dnds" href="units/formats/pe/dotnet/dnds.html">refinery.units.formats.pe.dotnet.dnds</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: dnds [-h] [-Q] [-0] [-v] [-r] [-e UNIT | -d HASH]

Expects data that has been formatted with the .NET class BinaryFormatter.
The output is a representation of the deserialized data in JSON format.

optional arguments:
  -r, --keep-references  Do not resolve Object references in serialized
                         data.
  -e, --encode UNIT      Select an encoder unit used to represent binary
                         data in the JSON output. Available are: HEX, ESC,
                         URL, B64.
  -d, --digest HASH      Select a hashing algorithm to digest binary data;
                         instead of the data, only the hash will be
                         displayed. The available algorithms are: MD5,
                         CRC32, SHA1, SHA256, SHA512.

generic options:
  -h, --help             Show this help message and exit.
  -Q, --quiet            Disables all log output.
  -0, --devnull          Do not produce any output.
  -v, --verbose          Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/dotnet/dnds.py#L7-L34" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class dnds(JSONEncoderUnit):
    &#34;&#34;&#34;
    Expects data that has been formatted with the .NET class `BinaryFormatter`.
    The output is a representation of the deserialized data in JSON format.
    &#34;&#34;&#34;

    def __init__(
        self, dereference: arg.switch(&#39;-r&#39;, &#39;--keep-references&#39;, off=True,
            help=&#39;Do not resolve Object references in serialized data.&#39;) = True,
        encode=None, digest=None
    ):
        super().__init__(encode=encode, digest=digest, dereference=dereference)

    def process(self, data):
        self.log_debug(&#39;initializing parser, will fail on malformed stream&#39;)
        bf = BinaryFormatterParser(
            data,
            keep_meta=True,
            dereference=self.args.dereference,
            ignore_errors=not self.log_debug(),
        )

        return self.to_json([
            {
                &#39;Type&#39;: repr(record),
                &#39;Data&#39;: record
            } for record in bf
        ])</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit" href="units/formats/pe/dotnet/index.html#refinery.units.formats.pe.dotnet.JSONEncoderUnit">JSONEncoderUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.dnds.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit" href="units/formats/pe/dotnet/index.html#refinery.units.formats.pe.dotnet.JSONEncoderUnit">JSONEncoderUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.dnfields"><code class="flex name class">
<span>class <span class="ident">dnfields</span></span>
<span>(</span><span>*paths, list=False, join=False, **keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.pe.dotnet.dnfields" href="units/formats/pe/dotnet/dnfields.html">refinery.units.formats.pe.dotnet.dnfields</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: dnfields [-h] [-Z] [-Q] [-0] [-v] [-l] [-j] [path [path ...]]

This unit can extract data from constant field variables in classes of
.NET executables. Since the .NET header stores only the offset and not the
size of constant fields, heuristics are used to search for opcode
sequences that load the data and additional heuristics are used to guess
the size of the data type.

positional arguments:
  path           Wildcard pattern for the name of the item to be
                 extracted. Each item is returned as a separate output of
                 this unit. Paths may contain wildcards. The default is a
                 single asterix, which means that every item will be
                 extracted.

optional arguments:
  -l, --list     Return all matching paths as UTF8-encoded output chunks.
  -j, --join     Join path names from container with previous path names.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/dotnet/dnfields.py#L10-L60" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class dnfields(PathExtractorUnit):
    &#34;&#34;&#34;
    This unit can extract data from constant field variables in classes of .NET
    executables. Since the .NET header stores only the offset and not the size of
    constant fields, heuristics are used to search for opcode sequences that load
    the data and additional heuristics are used to guess the size of the data
    type.
    &#34;&#34;&#34;
    _SIZEMAP = {
        &#39;^s?byte|char$&#39;  : 1,
        &#39;^[us]?int.?16$&#39; : 2,
        &#39;^[us]?int.?32$&#39; : 4,
        &#39;^[us]?int.?64$&#39; : 8,
    }

    def _guess_field_info(self, tables, data, t):
        pattern = (
            BR&#39;(\x20....|\x1F.)&#39;                # ldc.i4  count
            BR&#39;\x8D(...)([\x01\x02])&#39;           # newarr  col|row
            BR&#39;\x25&#39;                            # dup
            BR&#39;\xD0\x%02x\x%02x\x%02x\x04&#39; % (  # ldtoken t
                (t &gt;&gt; 0x00) &amp; 0xFF,
                (t &gt;&gt; 0x08) &amp; 0xFF,
                (t &gt;&gt; 0x10) &amp; 0xFF
            )
        )
        for match in re.finditer(pattern, data, flags=re.DOTALL):
            count, j, r = match.groups()
            count, j, r = struct.unpack(&#39;=LLB&#39;, B&#39;%s%s\0%s&#39; % (count[1:].ljust(4, B&#39;\0&#39;), j, r))
            element = tables[r][j - 1]
            for pattern, size in self._SIZEMAP.items():
                if re.match(pattern, element.TypeName, flags=re.IGNORECASE):
                    return element.TypeName, count, size

    def unpack(self, data):
        header = DotNetHeader(data, parse_resources=False)
        tables = header.meta.Streams.Tables
        iwidth = len(str(len(tables.FieldRVA)))

        for k, rv in enumerate(tables.FieldRVA):
            index = rv.Field.Index
            field = tables.Field[index - 1]
            guess = self._guess_field_info(tables, data, index)
            if guess is None:
                self.log_debug(lambda: F&#39;field {k:0{iwidth}d}: {field.Name} unable to guess type information&#39;)
                continue
            typename, count, size = guess
            totalsize = count * size
            self.log_info(lambda: F&#39;field {k:0{iwidth}d}: {field.Name} of type {typename}, count: {count}&#39;)
            offset = header.pe.get_offset_from_rva(rv.RVA)
            yield UnpackResult(field.Name, lambda t=offset, s=totalsize: data[t:t + s])</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.formats.PathExtractorUnit" href="units/formats/index.html#refinery.units.formats.PathExtractorUnit">PathExtractorUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.dnfields.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="refinery.dnfields.unpack"><code class="name flex">
<span>def <span class="ident">unpack</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/dotnet/dnfields.py#L44-L60" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def unpack(self, data):
    header = DotNetHeader(data, parse_resources=False)
    tables = header.meta.Streams.Tables
    iwidth = len(str(len(tables.FieldRVA)))

    for k, rv in enumerate(tables.FieldRVA):
        index = rv.Field.Index
        field = tables.Field[index - 1]
        guess = self._guess_field_info(tables, data, index)
        if guess is None:
            self.log_debug(lambda: F&#39;field {k:0{iwidth}d}: {field.Name} unable to guess type information&#39;)
            continue
        typename, count, size = guess
        totalsize = count * size
        self.log_info(lambda: F&#39;field {k:0{iwidth}d}: {field.Name} of type {typename}, count: {count}&#39;)
        offset = header.pe.get_offset_from_rva(rv.RVA)
        yield UnpackResult(field.Name, lambda t=offset, s=totalsize: data[t:t + s])</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.formats.PathExtractorUnit" href="units/formats/index.html#refinery.units.formats.PathExtractorUnit">PathExtractorUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.formats.PathExtractorUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.dnhdr"><code class="flex name class">
<span>class <span class="ident">dnhdr</span></span>
<span>(</span><span>resources=False, encode=None, digest=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.pe.dotnet.dnhdr" href="units/formats/pe/dotnet/dnhdr.html">refinery.units.formats.pe.dotnet.dnhdr</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: dnhdr [-h] [-Q] [-0] [-v] [-r] [-e UNIT | -d HASH]

Expects data that has been formatted with the BinaryFormatter class. The
output is a representation of the deserialized data in JSON format.

optional arguments:
  -r, --resources    Also parse .NET resources.
  -e, --encode UNIT  Select an encoder unit used to represent binary data
                     in the JSON output. Available are: HEX, ESC, URL,
                     B64.
  -d, --digest HASH  Select a hashing algorithm to digest binary data;
                     instead of the data, only the hash will be displayed.
                     The available algorithms are: MD5, CRC32, SHA1,
                     SHA256, SHA512.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/dotnet/dnhdr.py#L7-L29" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class dnhdr(JSONEncoderUnit):
    &#34;&#34;&#34;
    Expects data that has been formatted with the `BinaryFormatter` class. The
    output is a representation of the deserialized data in JSON format.
    &#34;&#34;&#34;
    def __init__(
        self,
        resources: arg.switch(&#39;-r&#39;, &#39;--resources&#39;, help=&#39;Also parse .NET resources.&#39;) = False,
        encode=None, digest=None
    ):
        super().__init__(encode=encode, digest=digest, resources=resources)

    def process(self, data):
        dn = DotNetHeader(data, parse_resources=self.args.resources)
        dn = {
            &#39;Head&#39;: dn.head,
            &#39;Meta&#39;: dn.meta
        }

        if self.args.resources:
            dn[&#39;RSRC&#39;] = dn.resources

        return self.to_json(dn)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit" href="units/formats/pe/dotnet/index.html#refinery.units.formats.pe.dotnet.JSONEncoderUnit">JSONEncoderUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.dnhdr.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit" href="units/formats/pe/dotnet/index.html#refinery.units.formats.pe.dotnet.JSONEncoderUnit">JSONEncoderUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.formats.pe.dotnet.JSONEncoderUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.dnmr"><code class="flex name class">
<span>class <span class="ident">dnmr</span></span>
<span>(</span><span>*paths, list=False, join=False, raw=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.pe.dotnet.dnmr" href="units/formats/pe/dotnet/dnmr.html">refinery.units.formats.pe.dotnet.dnmr</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: dnmr [-h] [-Z] [-Q] [-0] [-v] [-l] [-j] [-r] [path [path ...]]

Extracts subfiles from .NET managed resources.

positional arguments:
  path           Wildcard pattern for the name of the item to be
                 extracted. Each item is returned as a separate output of
                 this unit. Paths may contain wildcards. The default is a
                 single asterix, which means that every item will be
                 extracted.

optional arguments:
  -l, --list     Return all matching paths as UTF8-encoded output chunks.
  -j, --join     Join path names from container with previous path names.
  -r, --raw      Do not deserialize the managed resource entry data.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/dotnet/dnmr.py#L8-L30" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class dnmr(PathExtractorUnit):
    &#34;&#34;&#34;
    Extracts subfiles from .NET managed resources.
    &#34;&#34;&#34;
    def __init__(
        self, *paths, list=False, join=False,
        raw: arg.switch(&#39;-r&#39;, help=&#39;Do not deserialize the managed resource entry data.&#39;) = False
    ):
        super().__init__(*paths, list=list, join=join)
        self.args.raw = raw

    def unpack(self, data):
        try:
            managed = NetStructuredResources(data)
        except NoManagedResource:
            managed = None
        if not managed:
            raise ValueError(&#39;no managed resources found.&#39;)
        for entry in managed:
            if entry.Error:
                self.log_warn(F&#39;entry {entry.Name} carried error message: {entry.Error}&#39;)
            yield UnpackResult(entry.Name,
                entry.Value if not self.args.raw and isbuffer(entry.Value) else entry.Data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.formats.PathExtractorUnit" href="units/formats/index.html#refinery.units.formats.PathExtractorUnit">PathExtractorUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.dnmr.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="refinery.dnmr.unpack"><code class="name flex">
<span>def <span class="ident">unpack</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/dotnet/dnmr.py#L19-L30" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def unpack(self, data):
    try:
        managed = NetStructuredResources(data)
    except NoManagedResource:
        managed = None
    if not managed:
        raise ValueError(&#39;no managed resources found.&#39;)
    for entry in managed:
        if entry.Error:
            self.log_warn(F&#39;entry {entry.Name} carried error message: {entry.Error}&#39;)
        yield UnpackResult(entry.Name,
            entry.Value if not self.args.raw and isbuffer(entry.Value) else entry.Data)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.formats.PathExtractorUnit" href="units/formats/index.html#refinery.units.formats.PathExtractorUnit">PathExtractorUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.formats.PathExtractorUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.dnrc"><code class="flex name class">
<span>class <span class="ident">dnrc</span></span>
<span>(</span><span>*paths, list=False, join=False, **keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.pe.dotnet.dnrc" href="units/formats/pe/dotnet/dnrc.html">refinery.units.formats.pe.dotnet.dnrc</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: dnrc [-h] [-Z] [-Q] [-0] [-v] [-l] [-j] [path [path ...]]

Extracts all .NET resources whose name matches any of the given patterns
and outputs them. Use the dnmr unit to extract subfiles from managed .NET
resources.

positional arguments:
  path           Wildcard pattern for the name of the item to be
                 extracted. Each item is returned as a separate output of
                 this unit. Paths may contain wildcards. The default is a
                 single asterix, which means that every item will be
                 extracted.

optional arguments:
  -l, --list     Return all matching paths as UTF8-encoded output chunks.
  -j, --join     Join path names from container with previous path names.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/dotnet/dnrc.py#L7-L22" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class dnrc(PathExtractorUnit):
    &#34;&#34;&#34;
    Extracts all .NET resources whose name matches any of the given patterns
    and outputs them. Use the `refinery.units.formats.pe.dotnet.dnmr` unit to
    extract subfiles from managed .NET resources.
    &#34;&#34;&#34;
    def unpack(self, data):
        header = DotNetHeader(data)

        if not header.resources:
            if self.args.list:
                return
            raise ValueError(&#39;This file contains no resources.&#39;)

        for resource in header.resources:
            yield UnpackResult(resource.Name, resource.Data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.formats.PathExtractorUnit" href="units/formats/index.html#refinery.units.formats.PathExtractorUnit">PathExtractorUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.dnrc.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="refinery.dnrc.unpack"><code class="name flex">
<span>def <span class="ident">unpack</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/dotnet/dnrc.py#L13-L22" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def unpack(self, data):
    header = DotNetHeader(data)

    if not header.resources:
        if self.args.list:
            return
        raise ValueError(&#39;This file contains no resources.&#39;)

    for resource in header.resources:
        yield UnpackResult(resource.Name, resource.Data)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.formats.PathExtractorUnit" href="units/formats/index.html#refinery.units.formats.PathExtractorUnit">PathExtractorUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.formats.PathExtractorUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.dnstr"><code class="flex name class">
<span>class <span class="ident">dnstr</span></span>
<span>(</span><span>user=True, meta=True)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.pe.dotnet.dnstr" href="units/formats/pe/dotnet/dnstr.html">refinery.units.formats.pe.dotnet.dnstr</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: dnstr [-h] [-Z] [-Q] [-0] [-v] [-m | -u]

Extracts all strings defined in the #Strings and #US streams of .NET
executables.

optional arguments:
  -m, --meta     Only extract from #Strings.
  -u, --user     Only extract from #US.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/dotnet/dnstr.py#L7-L29" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class dnstr(Unit):
    &#34;&#34;&#34;
    Extracts all strings defined in the `#Strings` and `#US` streams of .NET
    executables.
    &#34;&#34;&#34;

    def __init__(
        self,
        user: arg.switch(&#39;-m&#39;, &#39;--meta&#39;, off=True, group=&#39;HEAP&#39;, help=&#39;Only extract from #Strings.&#39;) = True,
        meta: arg.switch(&#39;-u&#39;, &#39;--user&#39;, off=True, group=&#39;HEAP&#39;, help=&#39;Only extract from #US.&#39;) = True,
    ):
        if not meta and not user:
            raise ValueError(&#39;Either ascii or utf16 strings must be enabled.&#39;)
        super().__init__(meta=meta, user=user)

    def process(self, data):
        header = DotNetHeader(data, parse_resources=False)
        if self.args.meta:
            for string in header.meta.Streams.Strings.values():
                yield string.encode(self.codec)
        if self.args.user:
            for string in header.meta.Streams.US.values():
                yield string.encode(self.codec)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.dnstr.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.pemeta"><code class="flex name class">
<span>class <span class="ident">pemeta</span></span>
<span>(</span><span>all=True, debug=False, dotnet=False, signatures=False, timestamps=False, version=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.pe.pemeta" href="units/formats/pe/pemeta.html">refinery.units.formats.pe.pemeta</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: pemeta [-h] [-Q] [-0] [-v] [-c] [-D] [-N] [-S] [-T] [-V]

Extract metadata from PE files, including:

- File version resource
- Code signature information
- Timestamps
- If present, .NET header information

optional arguments:
  -c, --custom      Unless enabled, everything will be extracted.
  -D, --debug       Parse the PDB path from the debug directory.
  -N, --dotnet      Parse the .NET header.
  -S, --signatures  Parse digital signatures.
  -T, --timestamps  Extract time stamps.
  -V, --version     Parse the VERSION resource.

generic options:
  -h, --help        Show this help message and exit.
  -Q, --quiet       Disables all log output.
  -0, --devnull     Do not produce any output.
  -v, --verbose     Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/pemeta.py#L16-L544" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class pemeta(Unit):
    &#34;&#34;&#34;
    Extract metadata from PE files, including:

    - File version resource
    - Code signature information
    - Timestamps
    - If present, .NET header information
    &#34;&#34;&#34;
    def __init__(
        self, all : arg(&#39;-c&#39;, &#39;--custom&#39;,
            help=&#39;Unless enabled, everything will be extracted.&#39;) = True,
        debug      : arg(&#39;-D&#39;, help=&#39;Parse the PDB path from the debug directory.&#39;) = False,
        dotnet     : arg(&#39;-N&#39;, help=&#39;Parse the .NET header.&#39;) = False,
        signatures : arg(&#39;-S&#39;, help=&#39;Parse digital signatures.&#39;) = False,
        timestamps : arg(&#39;-T&#39;, help=&#39;Extract time stamps.&#39;) = False,
        version    : arg(&#39;-V&#39;, help=&#39;Parse the VERSION resource.&#39;) = False,
    ):
        super().__init__(
            debug=all or debug,
            dotnet=all or dotnet,
            signatures=all or signatures,
            timestamps=all or timestamps,
            version=all or version,
        )

    def _ensure_string(self, x):
        if not isinstance(x, str):
            x = repr(x) if not isinstance(x, bytes) else x.decode(self.codec, &#39;backslashreplace&#39;)
        return x

    def _parse_pedict(self, bin):
        return dict((
            self._ensure_string(key),
            self._ensure_string(val)
        ) for key, val in bin.items() if val)

    @lru_cache(maxsize=1, typed=False)
    def _getpe(self, data: bytearray) -&gt; PE:
        return PE(data=data, fast_load=True)

    def parse_signature(self, data: bytearray) -&gt; dict:
        &#34;&#34;&#34;
        Extracts a JSON-serializable and human readable dictionary with information about
        time stamp and code signing certificates that are attached to the input PE file.
        &#34;&#34;&#34;
        from .pesig import pesig
        cert, info = pesig()(data), {}

        try:
            signature = cms.ContentInfo.load(cert)
        except Exception as E:
            raise ValueError(F&#39;PKCS7 parser failed with error: {E!s}&#39;)

        def tscrawl(entry, native):
            with suppress(KeyError, TypeError):
                if entry[&#39;type&#39;] == &#39;signing_time&#39;:
                    return entry[&#39;values&#39;]
            try:
                keys = list(entry)
                assert all(isinstance(k, str) for k in keys)
            except Exception:
                try:
                    length = len(entry)
                except TypeError:
                    return None

                for k in range(length):
                    try:
                        item = entry[k]
                    except IndexError:
                        continue
                    results = tscrawl(item, native)
                    if results:
                        return results
            else:
                for key in keys:
                    value = entry[key]
                    results = tscrawl(value, native)
                    if isinstance(results, list) and len(results) == 1:
                        result = dict(Timestamp=str(results[0]))
                        with suppress(Exception):
                            acc = entry if native else entry.native
                            result[&#39;Timestamp Issuer&#39;] = acc[&#39;sid&#39;][&#39;issuer&#39;][&#39;common_name&#39;]
                        return result
                    elif results is not None:
                        return results

            with suppress(Exception):
                return tscrawl(entry.native, True)

        timestamps = []
        for signer in signature[&#39;content&#39;][&#39;signer_infos&#39;]:
            ts = tscrawl(signer, False)
            if ts is not None:
                timestamps.append(ts)
        if len(timestamps) == 1:
            info.update(timestamps[0])

        with suppress(Exception):
            for entry in signature[&#39;content&#39;][&#39;certificates&#39;]:
                cert = x509.Certificate.load(entry.dump())
                if cert.ca: continue
                tbs = cert.native[&#39;tbs_certificate&#39;]
                for extension in tbs[&#39;extensions&#39;]:
                    if extension[&#39;extn_id&#39;] == &#39;extended_key_usage&#39; and &#39;code_signing&#39; in extension[&#39;extn_value&#39;]:
                        Serial = F&#39;{tbs[&#34;serial_number&#34;]:x}&#39;
                        if len(Serial) % 2:
                            Serial = &#39;0&#39; + Serial
                        tbs = dict(
                            Issuer=tbs[&#39;issuer&#39;][&#39;common_name&#39;],
                            Subject=tbs[&#39;subject&#39;][&#39;common_name&#39;],
                            Serial=Serial,
                        )
                        info.update(tbs)
                        return info
        return info

    def parse_file_info(self, data: bytearray) -&gt; dict:
        &#34;&#34;&#34;
        Extracts a JSON-serializable and human readable dictionary with information about
        the version resource of an input PE file, if available.
        &#34;&#34;&#34;
        try:
            pe = self._getpe(data)
            pe.parse_data_directories(directories=[DIRECTORY_ENTRY[&#39;IMAGE_DIRECTORY_ENTRY_RESOURCE&#39;]])
            FileInfoList = pe.FileInfo
        except AttributeError:
            return None
        for FileInfo in FileInfoList:
            for FileInfoEntry in FileInfo:
                with suppress(AttributeError):
                    for StringTableEntry in FileInfoEntry.StringTable:
                        StringTableEntryParsed = self._parse_pedict(StringTableEntry.entries)
                        with suppress(AttributeError):
                            LangID = StringTableEntry.entries.get(&#39;LangID&#39;, None) or StringTableEntry.LangID
                            LangID = int(LangID, 0x10) if not isinstance(LangID, int) else LangID
                            LangHi = LangID &gt;&gt; 0x10
                            LangLo = LangID &amp; 0xFFFF
                            Language = self._LCID.get(LangHi, &#39;Language Neutral&#39;)
                            Charset = self._CHARSET.get(LangLo, &#39;Unknown Charset&#39;)
                            StringTableEntryParsed.update(
                                LangID=F&#39;{LangID:08X}&#39;,
                                Charset=Charset,
                                Language=Language
                            )
                        return StringTableEntryParsed

    def parse_time_stamps(self, data: bytearray) -&gt; dict:
        &#34;&#34;&#34;
        Extracts time stamps from the PE header (link time), as well as from the imports,
        exports, debug, and resource directory. The resource time stamp is also parsed as
        a DOS time stamp and returned as the &#34;Delphi&#34; time stamp.
        &#34;&#34;&#34;
        def dt(ts):
            # parse as UTC but then forget time zone information
            return datetime.fromtimestamp(ts, tz=timezone.utc).replace(tzinfo=None)

        pe = self._getpe(data)
        pe.parse_data_directories(directories=[
            DIRECTORY_ENTRY[&#39;IMAGE_DIRECTORY_ENTRY_IMPORT&#39;],
            DIRECTORY_ENTRY[&#39;IMAGE_DIRECTORY_ENTRY_EXPORT&#39;],
            DIRECTORY_ENTRY[&#39;IMAGE_DIRECTORY_ENTRY_DEBUG&#39;],
            DIRECTORY_ENTRY[&#39;IMAGE_DIRECTORY_ENTRY_RESOURCE&#39;]
        ])

        info = {}

        with suppress(AttributeError):
            info.update(Linker=dt(pe.FILE_HEADER.TimeDateStamp))

        with suppress(AttributeError):
            for entry in pe.DIRECTORY_ENTRY_IMPORT:
                info.update(Import=dt(entry.TimeDateStamp()))

        with suppress(AttributeError):
            for entry in pe.DIRECTORY_ENTRY_DEBUG:
                info.update(DbgDir=dt(entry.struct.TimeDateStamp))

        with suppress(AttributeError):
            Export = pe.DIRECTORY_ENTRY_EXPORT.struct.TimeDateStamp
            if Export: info.update(Export=dt(Export))

        with suppress(AttributeError):
            res_timestamp = pe.DIRECTORY_ENTRY_RESOURCE.struct.TimeDateStamp
            if res_timestamp:
                with suppress(ValueError):
                    from ...misc.datefix import datefix
                    dos = datefix.dostime(res_timestamp)
                    info.update(Delphi=dos)
                    info.update(RsrcTS=dt(res_timestamp))

        return {key: str(value) for key, value in info.items()}

    def parse_dotnet(self, data):
        &#34;&#34;&#34;
        Extracts a JSON-serializable and human readable dictionary with information about
        the .NET metadata of an input PE file.
        &#34;&#34;&#34;
        header = DotNetHeader(data, pe=self._getpe(data))
        tables = header.meta.Streams.Tables
        info = dict(
            RuntimeVersion=F&#39;{header.head.MajorRuntimeVersion}.{header.head.MinorRuntimeVersion}&#39;,
            Version=F&#39;{header.meta.MajorVersion}.{header.meta.MinorVersion}&#39;,
            VersionString=header.meta.VersionString
        )

        if len(tables.Assembly) == 1:
            assembly = tables.Assembly[0]
            info.update(
                AssemblyName=assembly.Name,
                Release=&#39;{}.{}.{}.{}&#39;.format(
                    assembly.MajorVersion,
                    assembly.MinorVersion,
                    assembly.BuildNumber,
                    assembly.RevisionNumber
                )
            )

        if len(tables.Module) == 1:
            module = tables.Module[0]
            info.update(ModuleName=module.Name)

        return info

    def parse_debug_data(self, data):
        result = {}
        pe = self._getpe(data)
        pe.parse_data_directories(directories=[
            DIRECTORY_ENTRY[&#39;IMAGE_DIRECTORY_ENTRY_DEBUG&#39;]])
        for dbg in pe.DIRECTORY_ENTRY_DEBUG:
            if DEBUG_TYPE.get(dbg.struct.Type, None) != &#39;IMAGE_DEBUG_TYPE_CODEVIEW&#39;:
                continue
            with suppress(Exception):
                pdb = dbg.entry.PdbFileName
                if 0 in pdb:
                    pdb = pdb[:pdb.index(0)]
                result.update(
                    PdbPath=pdb.decode(self.codec),
                    PdbAge=dbg.entry.Age
                )
        return result

    def process(self, data):
        result = {}

        if self.args.version:
            try:
                file_info = self.parse_file_info(data)
            except Exception as E:
                self.log_info(F&#39;failed to obtain file info resource: {E!s}&#39;)
            else:
                if file_info:
                    result[&#39;FileInfo&#39;] = file_info
        if self.args.dotnet:
            try:
                dnet_info = self.parse_dotnet(data)
            except Exception as E:
                self.log_info(F&#39;failed to obtain .NET information: {E!s}&#39;)
            else:
                if dnet_info:
                    result[&#39;DotNet&#39;] = dnet_info
        if self.args.debug:
            try:
                debug_info = self.parse_debug_data(data)
            except Exception as E:
                self.log_info(F&#39;failed to parse debug directory: {E!s}&#39;)
            else:
                if debug_info:
                    result[&#39;Debug&#39;] = debug_info

        signature = {}

        if self.args.timestamps or self.args.signatures:
            with suppress(Exception):
                signature = self.parse_signature(data)

        if self.args.timestamps:
            ts = self.parse_time_stamps(data)
            with suppress(KeyError):
                ts.update(Signed=signature[&#39;Timestamp&#39;])
            result.update(TimeStamp=ts)

        if signature and self.args.signatures:
            result[&#39;Signature&#39;] = signature

        return json.dumps(result, indent=4, ensure_ascii=False).encode(self.codec)

    _LCID = {
        0x0436: &#39;Afrikaans-South Africa&#39;,
        0x041c: &#39;Albanian-Albania&#39;,
        0x045e: &#39;Amharic-Ethiopia&#39;,
        0x0401: &#39;Arabic (Saudi Arabia)&#39;,
        0x1401: &#39;Arabic (Algeria)&#39;,
        0x3c01: &#39;Arabic (Bahrain)&#39;,
        0x0c01: &#39;Arabic (Egypt)&#39;,
        0x0801: &#39;Arabic (Iraq)&#39;,
        0x2c01: &#39;Arabic (Jordan)&#39;,
        0x3401: &#39;Arabic (Kuwait)&#39;,
        0x3001: &#39;Arabic (Lebanon)&#39;,
        0x1001: &#39;Arabic (Libya)&#39;,
        0x1801: &#39;Arabic (Morocco)&#39;,
        0x2001: &#39;Arabic (Oman)&#39;,
        0x4001: &#39;Arabic (Qatar)&#39;,
        0x2801: &#39;Arabic (Syria)&#39;,
        0x1c01: &#39;Arabic (Tunisia)&#39;,
        0x3801: &#39;Arabic (U.A.E.)&#39;,
        0x2401: &#39;Arabic (Yemen)&#39;,
        0x042b: &#39;Armenian-Armenia&#39;,
        0x044d: &#39;Assamese&#39;,
        0x082c: &#39;Azeri (Cyrillic)&#39;,
        0x042c: &#39;Azeri (Latin)&#39;,
        0x042d: &#39;Basque&#39;,
        0x0423: &#39;Belarusian&#39;,
        0x0445: &#39;Bengali (India)&#39;,
        0x0845: &#39;Bengali (Bangladesh)&#39;,
        0x141A: &#39;Bosnian (Bosnia/Herzegovina)&#39;,
        0x0402: &#39;Bulgarian&#39;,
        0x0455: &#39;Burmese&#39;,
        0x0403: &#39;Catalan&#39;,
        0x045c: &#39;Cherokee-United States&#39;,
        0x0804: &#39;Chinese (People\&#39;s Republic of China)&#39;,
        0x1004: &#39;Chinese (Singapore)&#39;,
        0x0404: &#39;Chinese (Taiwan)&#39;,
        0x0c04: &#39;Chinese (Hong Kong SAR)&#39;,
        0x1404: &#39;Chinese (Macao SAR)&#39;,
        0x041a: &#39;Croatian&#39;,
        0x101a: &#39;Croatian (Bosnia/Herzegovina)&#39;,
        0x0405: &#39;Czech&#39;,
        0x0406: &#39;Danish&#39;,
        0x0465: &#39;Divehi&#39;,
        0x0413: &#39;Dutch-Netherlands&#39;,
        0x0813: &#39;Dutch-Belgium&#39;,
        0x0466: &#39;Edo&#39;,
        0x0409: &#39;English (United States)&#39;,
        0x0809: &#39;English (United Kingdom)&#39;,
        0x0c09: &#39;English (Australia)&#39;,
        0x2809: &#39;English (Belize)&#39;,
        0x1009: &#39;English (Canada)&#39;,
        0x2409: &#39;English (Caribbean)&#39;,
        0x3c09: &#39;English (Hong Kong SAR)&#39;,
        0x4009: &#39;English (India)&#39;,
        0x3809: &#39;English (Indonesia)&#39;,
        0x1809: &#39;English (Ireland)&#39;,
        0x2009: &#39;English (Jamaica)&#39;,
        0x4409: &#39;English (Malaysia)&#39;,
        0x1409: &#39;English (New Zealand)&#39;,
        0x3409: &#39;English (Philippines)&#39;,
        0x4809: &#39;English (Singapore)&#39;,
        0x1c09: &#39;English (South Africa)&#39;,
        0x2c09: &#39;English (Trinidad)&#39;,
        0x3009: &#39;English (Zimbabwe)&#39;,
        0x0425: &#39;Estonian&#39;,
        0x0438: &#39;Faroese&#39;,
        0x0429: &#39;Farsi&#39;,
        0x0464: &#39;Filipino&#39;,
        0x040b: &#39;Finnish&#39;,
        0x040c: &#39;French (France)&#39;,
        0x080c: &#39;French (Belgium)&#39;,
        0x2c0c: &#39;French (Cameroon)&#39;,
        0x0c0c: &#39;French (Canada)&#39;,
        0x240c: &#39;French (Democratic Rep. of Congo)&#39;,
        0x300c: &#39;French (Cote d\&#39;Ivoire)&#39;,
        0x3c0c: &#39;French (Haiti)&#39;,
        0x140c: &#39;French (Luxembourg)&#39;,
        0x340c: &#39;French (Mali)&#39;,
        0x180c: &#39;French (Monaco)&#39;,
        0x380c: &#39;French (Morocco)&#39;,
        0xe40c: &#39;French (North Africa)&#39;,
        0x200c: &#39;French (Reunion)&#39;,
        0x280c: &#39;French (Senegal)&#39;,
        0x100c: &#39;French (Switzerland)&#39;,
        0x1c0c: &#39;French (West Indies)&#39;,
        0x0462: &#39;Frisian-Netherlands&#39;,
        0x0467: &#39;Fulfulde-Nigeria&#39;,
        0x042f: &#39;FYRO Macedonian&#39;,
        0x083c: &#39;Gaelic (Ireland)&#39;,
        0x043c: &#39;Gaelic (Scotland)&#39;,
        0x0456: &#39;Galician&#39;,
        0x0437: &#39;Georgian&#39;,
        0x0407: &#39;German (Germany)&#39;,
        0x0c07: &#39;German (Austria)&#39;,
        0x1407: &#39;German (Liechtenstein)&#39;,
        0x1007: &#39;German (Luxembourg)&#39;,
        0x0807: &#39;German (Switzerland)&#39;,
        0x0408: &#39;Greek&#39;,
        0x0474: &#39;Guarani-Paraguay&#39;,
        0x0447: &#39;Gujarati&#39;,
        0x0468: &#39;Hausa-Nigeria&#39;,
        0x0475: &#39;Hawaiian (United States)&#39;,
        0x040d: &#39;Hebrew&#39;,
        0x0439: &#39;Hindi&#39;,
        0x040e: &#39;Hungarian&#39;,
        0x0469: &#39;Ibibio-Nigeria&#39;,
        0x040f: &#39;Icelandic&#39;,
        0x0470: &#39;Igbo-Nigeria&#39;,
        0x0421: &#39;Indonesian&#39;,
        0x045d: &#39;Inuktitut&#39;,
        0x0410: &#39;Italian (Italy)&#39;,
        0x0810: &#39;Italian (Switzerland)&#39;,
        0x0411: &#39;Japanese&#39;,
        0x044b: &#39;Kannada&#39;,
        0x0471: &#39;Kanuri-Nigeria&#39;,
        0x0860: &#39;Kashmiri&#39;,
        0x0460: &#39;Kashmiri (Arabic)&#39;,
        0x043f: &#39;Kazakh&#39;,
        0x0453: &#39;Khmer&#39;,
        0x0457: &#39;Konkani&#39;,
        0x0412: &#39;Korean&#39;,
        0x0440: &#39;Kyrgyz (Cyrillic)&#39;,
        0x0454: &#39;Lao&#39;,
        0x0476: &#39;Latin&#39;,
        0x0426: &#39;Latvian&#39;,
        0x0427: &#39;Lithuanian&#39;,
        0x043e: &#39;Malay-Malaysia&#39;,
        0x083e: &#39;Malay-Brunei Darussalam&#39;,
        0x044c: &#39;Malayalam&#39;,
        0x043a: &#39;Maltese&#39;,
        0x0458: &#39;Manipuri&#39;,
        0x0481: &#39;Maori-New Zealand&#39;,
        0x044e: &#39;Marathi&#39;,
        0x0450: &#39;Mongolian (Cyrillic)&#39;,
        0x0850: &#39;Mongolian (Mongolian)&#39;,
        0x0461: &#39;Nepali&#39;,
        0x0861: &#39;Nepali-India&#39;,
        0x0414: &#39;Norwegian (Bokmål)&#39;,
        0x0814: &#39;Norwegian (Nynorsk)&#39;,
        0x0448: &#39;Oriya&#39;,
        0x0472: &#39;Oromo&#39;,
        0x0479: &#39;Papiamentu&#39;,
        0x0463: &#39;Pashto&#39;,
        0x0415: &#39;Polish&#39;,
        0x0416: &#39;Portuguese-Brazil&#39;,
        0x0816: &#39;Portuguese-Portugal&#39;,
        0x0446: &#39;Punjabi&#39;,
        0x0846: &#39;Punjabi (Pakistan)&#39;,
        0x046B: &#39;Quecha (Bolivia)&#39;,
        0x086B: &#39;Quecha (Ecuador)&#39;,
        0x0C6B: &#39;Quecha (Peru)&#39;,
        0x0417: &#39;Rhaeto-Romanic&#39;,
        0x0418: &#39;Romanian&#39;,
        0x0818: &#39;Romanian (Moldava)&#39;,
        0x0419: &#39;Russian&#39;,
        0x0819: &#39;Russian (Moldava)&#39;,
        0x043b: &#39;Sami (Lappish)&#39;,
        0x044f: &#39;Sanskrit&#39;,
        0x046c: &#39;Sepedi&#39;,
        0x0c1a: &#39;Serbian (Cyrillic)&#39;,
        0x081a: &#39;Serbian (Latin)&#39;,
        0x0459: &#39;Sindhi (India)&#39;,
        0x0859: &#39;Sindhi (Pakistan)&#39;,
        0x045b: &#39;Sinhalese-Sri Lanka&#39;,
        0x041b: &#39;Slovak&#39;,
        0x0424: &#39;Slovenian&#39;,
        0x0477: &#39;Somali&#39;,
        0x042e: &#39;Sorbian&#39;,
        0x0c0a: &#39;Spanish (Modern Sort)&#39;,
        0x040a: &#39;Spanish (Traditional Sort)&#39;,
        0x2c0a: &#39;Spanish (Argentina)&#39;,
        0x400a: &#39;Spanish (Bolivia)&#39;,
        0x340a: &#39;Spanish (Chile)&#39;,
        0x240a: &#39;Spanish (Colombia)&#39;,
        0x140a: &#39;Spanish (Costa Rica)&#39;,
        0x1c0a: &#39;Spanish (Dominican Republic)&#39;,
        0x300a: &#39;Spanish (Ecuador)&#39;,
        0x440a: &#39;Spanish (El Salvador)&#39;,
        0x100a: &#39;Spanish (Guatemala)&#39;,
        0x480a: &#39;Spanish (Honduras)&#39;,
        0x580a: &#39;Spanish (Latin America)&#39;,
        0x080a: &#39;Spanish (Mexico)&#39;,
        0x4c0a: &#39;Spanish (Nicaragua)&#39;,
        0x180a: &#39;Spanish (Panama)&#39;,
        0x3c0a: &#39;Spanish (Paraguay)&#39;,
        0x280a: &#39;Spanish (Peru)&#39;,
        0x500a: &#39;Spanish (Puerto Rico)&#39;,
        0x540a: &#39;Spanish (United States)&#39;,
        0x380a: &#39;Spanish (Uruguay)&#39;,
        0x200a: &#39;Spanish (Venezuela)&#39;,
        0x0430: &#39;Sutu&#39;,
        0x0441: &#39;Swahili&#39;,
        0x041d: &#39;Swedish&#39;,
        0x081d: &#39;Swedish-Finland&#39;,
        0x045a: &#39;Syriac&#39;,
        0x0428: &#39;Tajik&#39;,
        0x045f: &#39;Tamazight (Arabic)&#39;,
        0x085f: &#39;Tamazight (Latin)&#39;,
        0x0449: &#39;Tamil&#39;,
        0x0444: &#39;Tatar&#39;,
        0x044a: &#39;Telugu&#39;,
        0x041e: &#39;Thai&#39;,
        0x0851: &#39;Tibetan (Bhutan)&#39;,
        0x0451: &#39;Tibetan (People\&#39;s Republic of China)&#39;,
        0x0873: &#39;Tigrigna (Eritrea)&#39;,
        0x0473: &#39;Tigrigna (Ethiopia)&#39;,
        0x0431: &#39;Tsonga&#39;,
        0x0432: &#39;Tswana&#39;,
        0x041f: &#39;Turkish&#39;,
        0x0442: &#39;Turkmen&#39;,
        0x0480: &#39;Uighur-China&#39;,
        0x0422: &#39;Ukrainian&#39;,
        0x0420: &#39;Urdu&#39;,
        0x0820: &#39;Urdu-India&#39;,
        0x0843: &#39;Uzbek (Cyrillic)&#39;,
        0x0443: &#39;Uzbek (Latin)&#39;,
        0x0433: &#39;Venda&#39;,
        0x042a: &#39;Vietnamese&#39;,
        0x0452: &#39;Welsh&#39;,
        0x0434: &#39;Xhosa&#39;,
        0x0478: &#39;Yi&#39;,
        0x043d: &#39;Yiddish&#39;,
        0x046a: &#39;Yoruba&#39;,
        0x0435: &#39;Zulu&#39;,
        0x04ff: &#39;HID (Human Interface Device)&#39;
    }

    _CHARSET = {
        0x0000: &#39;7-bit ASCII&#39;,
        0x03A4: &#39;Japan (Shift ? JIS X-0208)&#39;,
        0x03B5: &#39;Korea (Shift ? KSC 5601)&#39;,
        0x03B6: &#39;Taiwan (Big5)&#39;,
        0x04B0: &#39;Unicode&#39;,
        0x04E2: &#39;Latin-2 (Eastern European)&#39;,
        0x04E3: &#39;Cyrillic&#39;,
        0x04E4: &#39;Multilingual&#39;,
        0x04E5: &#39;Greek&#39;,
        0x04E6: &#39;Turkish&#39;,
        0x04E7: &#39;Hebrew&#39;,
        0x04E8: &#39;Arabic&#39;,
    }</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.pemeta.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="refinery.pemeta.parse_signature"><code class="name flex">
<span>def <span class="ident">parse_signature</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<section class="desc"><p>Extracts a JSON-serializable and human readable dictionary with information about
time stamp and code signing certificates that are attached to the input PE file.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/pemeta.py#L57-L132" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def parse_signature(self, data: bytearray) -&gt; dict:
    &#34;&#34;&#34;
    Extracts a JSON-serializable and human readable dictionary with information about
    time stamp and code signing certificates that are attached to the input PE file.
    &#34;&#34;&#34;
    from .pesig import pesig
    cert, info = pesig()(data), {}

    try:
        signature = cms.ContentInfo.load(cert)
    except Exception as E:
        raise ValueError(F&#39;PKCS7 parser failed with error: {E!s}&#39;)

    def tscrawl(entry, native):
        with suppress(KeyError, TypeError):
            if entry[&#39;type&#39;] == &#39;signing_time&#39;:
                return entry[&#39;values&#39;]
        try:
            keys = list(entry)
            assert all(isinstance(k, str) for k in keys)
        except Exception:
            try:
                length = len(entry)
            except TypeError:
                return None

            for k in range(length):
                try:
                    item = entry[k]
                except IndexError:
                    continue
                results = tscrawl(item, native)
                if results:
                    return results
        else:
            for key in keys:
                value = entry[key]
                results = tscrawl(value, native)
                if isinstance(results, list) and len(results) == 1:
                    result = dict(Timestamp=str(results[0]))
                    with suppress(Exception):
                        acc = entry if native else entry.native
                        result[&#39;Timestamp Issuer&#39;] = acc[&#39;sid&#39;][&#39;issuer&#39;][&#39;common_name&#39;]
                    return result
                elif results is not None:
                    return results

        with suppress(Exception):
            return tscrawl(entry.native, True)

    timestamps = []
    for signer in signature[&#39;content&#39;][&#39;signer_infos&#39;]:
        ts = tscrawl(signer, False)
        if ts is not None:
            timestamps.append(ts)
    if len(timestamps) == 1:
        info.update(timestamps[0])

    with suppress(Exception):
        for entry in signature[&#39;content&#39;][&#39;certificates&#39;]:
            cert = x509.Certificate.load(entry.dump())
            if cert.ca: continue
            tbs = cert.native[&#39;tbs_certificate&#39;]
            for extension in tbs[&#39;extensions&#39;]:
                if extension[&#39;extn_id&#39;] == &#39;extended_key_usage&#39; and &#39;code_signing&#39; in extension[&#39;extn_value&#39;]:
                    Serial = F&#39;{tbs[&#34;serial_number&#34;]:x}&#39;
                    if len(Serial) % 2:
                        Serial = &#39;0&#39; + Serial
                    tbs = dict(
                        Issuer=tbs[&#39;issuer&#39;][&#39;common_name&#39;],
                        Subject=tbs[&#39;subject&#39;][&#39;common_name&#39;],
                        Serial=Serial,
                    )
                    info.update(tbs)
                    return info
    return info</code></pre>
</details>
</dd>
<dt id="refinery.pemeta.parse_file_info"><code class="name flex">
<span>def <span class="ident">parse_file_info</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<section class="desc"><p>Extracts a JSON-serializable and human readable dictionary with information about
the version resource of an input PE file, if available.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/pemeta.py#L134-L162" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def parse_file_info(self, data: bytearray) -&gt; dict:
    &#34;&#34;&#34;
    Extracts a JSON-serializable and human readable dictionary with information about
    the version resource of an input PE file, if available.
    &#34;&#34;&#34;
    try:
        pe = self._getpe(data)
        pe.parse_data_directories(directories=[DIRECTORY_ENTRY[&#39;IMAGE_DIRECTORY_ENTRY_RESOURCE&#39;]])
        FileInfoList = pe.FileInfo
    except AttributeError:
        return None
    for FileInfo in FileInfoList:
        for FileInfoEntry in FileInfo:
            with suppress(AttributeError):
                for StringTableEntry in FileInfoEntry.StringTable:
                    StringTableEntryParsed = self._parse_pedict(StringTableEntry.entries)
                    with suppress(AttributeError):
                        LangID = StringTableEntry.entries.get(&#39;LangID&#39;, None) or StringTableEntry.LangID
                        LangID = int(LangID, 0x10) if not isinstance(LangID, int) else LangID
                        LangHi = LangID &gt;&gt; 0x10
                        LangLo = LangID &amp; 0xFFFF
                        Language = self._LCID.get(LangHi, &#39;Language Neutral&#39;)
                        Charset = self._CHARSET.get(LangLo, &#39;Unknown Charset&#39;)
                        StringTableEntryParsed.update(
                            LangID=F&#39;{LangID:08X}&#39;,
                            Charset=Charset,
                            Language=Language
                        )
                    return StringTableEntryParsed</code></pre>
</details>
</dd>
<dt id="refinery.pemeta.parse_time_stamps"><code class="name flex">
<span>def <span class="ident">parse_time_stamps</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<section class="desc"><p>Extracts time stamps from the PE header (link time), as well as from the imports,
exports, debug, and resource directory. The resource time stamp is also parsed as
a DOS time stamp and returned as the "Delphi" time stamp.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/pemeta.py#L164-L208" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def parse_time_stamps(self, data: bytearray) -&gt; dict:
    &#34;&#34;&#34;
    Extracts time stamps from the PE header (link time), as well as from the imports,
    exports, debug, and resource directory. The resource time stamp is also parsed as
    a DOS time stamp and returned as the &#34;Delphi&#34; time stamp.
    &#34;&#34;&#34;
    def dt(ts):
        # parse as UTC but then forget time zone information
        return datetime.fromtimestamp(ts, tz=timezone.utc).replace(tzinfo=None)

    pe = self._getpe(data)
    pe.parse_data_directories(directories=[
        DIRECTORY_ENTRY[&#39;IMAGE_DIRECTORY_ENTRY_IMPORT&#39;],
        DIRECTORY_ENTRY[&#39;IMAGE_DIRECTORY_ENTRY_EXPORT&#39;],
        DIRECTORY_ENTRY[&#39;IMAGE_DIRECTORY_ENTRY_DEBUG&#39;],
        DIRECTORY_ENTRY[&#39;IMAGE_DIRECTORY_ENTRY_RESOURCE&#39;]
    ])

    info = {}

    with suppress(AttributeError):
        info.update(Linker=dt(pe.FILE_HEADER.TimeDateStamp))

    with suppress(AttributeError):
        for entry in pe.DIRECTORY_ENTRY_IMPORT:
            info.update(Import=dt(entry.TimeDateStamp()))

    with suppress(AttributeError):
        for entry in pe.DIRECTORY_ENTRY_DEBUG:
            info.update(DbgDir=dt(entry.struct.TimeDateStamp))

    with suppress(AttributeError):
        Export = pe.DIRECTORY_ENTRY_EXPORT.struct.TimeDateStamp
        if Export: info.update(Export=dt(Export))

    with suppress(AttributeError):
        res_timestamp = pe.DIRECTORY_ENTRY_RESOURCE.struct.TimeDateStamp
        if res_timestamp:
            with suppress(ValueError):
                from ...misc.datefix import datefix
                dos = datefix.dostime(res_timestamp)
                info.update(Delphi=dos)
                info.update(RsrcTS=dt(res_timestamp))

    return {key: str(value) for key, value in info.items()}</code></pre>
</details>
</dd>
<dt id="refinery.pemeta.parse_dotnet"><code class="name flex">
<span>def <span class="ident">parse_dotnet</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<section class="desc"><p>Extracts a JSON-serializable and human readable dictionary with information about
the .NET metadata of an input PE file.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/pemeta.py#L210-L239" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def parse_dotnet(self, data):
    &#34;&#34;&#34;
    Extracts a JSON-serializable and human readable dictionary with information about
    the .NET metadata of an input PE file.
    &#34;&#34;&#34;
    header = DotNetHeader(data, pe=self._getpe(data))
    tables = header.meta.Streams.Tables
    info = dict(
        RuntimeVersion=F&#39;{header.head.MajorRuntimeVersion}.{header.head.MinorRuntimeVersion}&#39;,
        Version=F&#39;{header.meta.MajorVersion}.{header.meta.MinorVersion}&#39;,
        VersionString=header.meta.VersionString
    )

    if len(tables.Assembly) == 1:
        assembly = tables.Assembly[0]
        info.update(
            AssemblyName=assembly.Name,
            Release=&#39;{}.{}.{}.{}&#39;.format(
                assembly.MajorVersion,
                assembly.MinorVersion,
                assembly.BuildNumber,
                assembly.RevisionNumber
            )
        )

    if len(tables.Module) == 1:
        module = tables.Module[0]
        info.update(ModuleName=module.Name)

    return info</code></pre>
</details>
</dd>
<dt id="refinery.pemeta.parse_debug_data"><code class="name flex">
<span>def <span class="ident">parse_debug_data</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/pemeta.py#L241-L257" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def parse_debug_data(self, data):
    result = {}
    pe = self._getpe(data)
    pe.parse_data_directories(directories=[
        DIRECTORY_ENTRY[&#39;IMAGE_DIRECTORY_ENTRY_DEBUG&#39;]])
    for dbg in pe.DIRECTORY_ENTRY_DEBUG:
        if DEBUG_TYPE.get(dbg.struct.Type, None) != &#39;IMAGE_DEBUG_TYPE_CODEVIEW&#39;:
            continue
        with suppress(Exception):
            pdb = dbg.entry.PdbFileName
            if 0 in pdb:
                pdb = pdb[:pdb.index(0)]
            result.update(
                PdbPath=pdb.decode(self.codec),
                PdbAge=dbg.entry.Age
            )
    return result</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.peoverlay"><code class="flex name class">
<span>class <span class="ident">peoverlay</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.pe.peoverlay" href="units/formats/pe/peoverlay.html">refinery.units.formats.pe.peoverlay</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: peoverlay [-h] [-Q] [-0] [-v]

Returns the overlay of a PE file, i.e. anything that may have been
appended to the file. This does not include digital signatures. Use
pestrip to obtain only the body of the PE file after removing the overlay.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/peoverlay.py#L7-L20" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class peoverlay(Unit):
    &#34;&#34;&#34;
    Returns the overlay of a PE file, i.e. anything that may have been appended to the file.
    This does not include digital signatures. Use `refinery.pestrip` to obtain only the body
    of the PE file after removing the overlay.
    &#34;&#34;&#34;
    def __init__(self, ): pass

    def process(self, data: bytearray) -&gt; bytearray:
        size = get_pe_size(data)
        if isinstance(data, bytearray):
            data[:size] = []
            return data
        return data[size:]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.peoverlay.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.perc"><code class="flex name class">
<span>class <span class="ident">perc</span></span>
<span>(</span><span>*entries)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.pe.perc" href="units/formats/pe/perc.html">refinery.units.formats.pe.perc</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: perc [-h] [-Z] [-Q] [-0] [-v] [entry [entry ...]]

Extract PE file resources.

positional arguments:
  entry          A resource path for the resource to be extracted. May
                 contain numeric literals and name strings with wildcards.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/perc.py#L68-L119" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class perc(Unit):
    &#34;&#34;&#34;
    Extract PE file resources.
    &#34;&#34;&#34;

    def __init__(self, *entries: arg(metavar=&#39;entry&#39;, type=rsrc, help=(
        &#39;A resource path for the resource to be extracted. May contain numeric &#39;
        &#39;literals and name strings with wildcards.&#39;
    ))):
        super().__init__(entries=entries)

    def _match(self, level, needle, e):
        if e.id == needle or str(e.id) == needle:
            return True
        if level == 0 and rsrc.to_name(needle) == str(e.name):
            return True
        elif fnmatch(str(e.name), str(needle)):
            return True
        return False

    def _search(self, pe, directory, needles, level=0, path=(&#39;.rsrc&#39;,)):
        try:
            needle = needles[level]
        except IndexError:
            if level &gt;= 3:
                self.log_warn(F&#39;unexpected resource tree level {level + 1:d}&#39;)
            needle = &#39;*&#39;

        for e in directory.entries:
            if self._match(level, needle, e):
                id_string = e.id if level else rsrc.to_name(e.id)
                new_path = path + (str(e.name if e.name else id_string),)
                if e.struct.DataIsDirectory:
                    yield from self._search(pe, e.directory, needles, level + 1, new_path)
                elif needles:
                    yield dict(
                        data=pe.get_data(e.data.struct.OffsetToData, e.data.struct.Size),
                        path=&#39;/&#39;.join(new_path[1:])
                    )
                else:
                    yield &#39;/&#39;.join(new_path[1:]).encode(&#39;UTF8&#39;)

    def process(self, data):
        pe = pefile.PE(data=data)
        if not self.args.entries:
            yield from self._search(pe, pe.DIRECTORY_ENTRY_RESOURCE, [])
            return
        for entry in self.args.entries:
            while len(entry.needles) &lt;= 3:
                self.log_info(&#39;searching pattern:&#39;, str(entry))
                yield from self._search(pe, pe.DIRECTORY_ENTRY_RESOURCE, entry.needles)
                entry = entry.relax()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.perc.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.pesig"><code class="flex name class">
<span>class <span class="ident">pesig</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.pe.pesig" href="units/formats/pe/pesig.html">refinery.units.formats.pe.pesig</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: pesig [-h] [-Q] [-0] [-v]

Extracts the contents of the IMAGE_DIRECTORY_ENTRY_SECURITY entry of a PE
file, i.e. the digital signatures in DER format.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/pesig.py#L9-L37" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class pesig(Unit):
    &#34;&#34;&#34;
    Extracts the contents of the IMAGE_DIRECTORY_ENTRY_SECURITY entry of a PE file,
    i.e. the digital signatures in DER format.
    &#34;&#34;&#34;

    _SECDIRID = DIRECTORY_ENTRY[&#39;IMAGE_DIRECTORY_ENTRY_SECURITY&#39;]

    def __init__(self): pass

    def process(self, data: bytearray) -&gt; bytearray:
        &#34;&#34;&#34;
        Extracts the raw digital signature from a PE file.
        &#34;&#34;&#34;
        pe = PE(data=data, fast_load=True)
        pe.parse_data_directories(directories=[self._SECDIRID])
        security = pe.OPTIONAL_HEADER.DATA_DIRECTORY[self._SECDIRID]

        sgnoff = security.VirtualAddress + 8
        sgnend = sgnoff + security.Size
        length, revision, certtype = unpack(&#39;&lt;IHH&#39;, data[sgnoff - 8:sgnoff])
        signature = data[sgnoff:sgnend]

        if len(signature) + 8 != length:
            raise RefineryPartialResult(
                F&#39;Found {len(signature) + 8} bytes of signature, but length should be {length}.&#39;,
                partial=signature)

        return signature</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.pesig.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="refinery.pesig.process"><code class="name flex">
<span>def <span class="ident">process</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<section class="desc"><p>Extracts the raw digital signature from a PE file.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/pesig.py#L19-L37" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def process(self, data: bytearray) -&gt; bytearray:
    &#34;&#34;&#34;
    Extracts the raw digital signature from a PE file.
    &#34;&#34;&#34;
    pe = PE(data=data, fast_load=True)
    pe.parse_data_directories(directories=[self._SECDIRID])
    security = pe.OPTIONAL_HEADER.DATA_DIRECTORY[self._SECDIRID]

    sgnoff = security.VirtualAddress + 8
    sgnend = sgnoff + security.Size
    length, revision, certtype = unpack(&#39;&lt;IHH&#39;, data[sgnoff - 8:sgnoff])
    signature = data[sgnoff:sgnend]

    if len(signature) + 8 != length:
        raise RefineryPartialResult(
            F&#39;Found {len(signature) + 8} bytes of signature, but length should be {length}.&#39;,
            partial=signature)

    return signature</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.peslice"><code class="flex name class">
<span>class <span class="ident">peslice</span></span>
<span>(</span><span>offset, base=0, end=None, take=0, utf16=False, ascii=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.pe.peslice" href="units/formats/pe/peslice.html">refinery.units.formats.pe.peslice</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: peslice [-h] [-Q] [-0] [-v] [-b N] [-e END | -t N | -u | -a] offset

Extract data from PE files based on virtual offsets.

positional arguments:
  offset         Specify virtual offset as either .section:OFFSET or just
                 a virtual address in hex.

optional arguments:
  -b, --base N   Optionally specify a custom base address.
  -e, --end END  Read bytes until this offset, which has to be located
                 after the starting offset.
  -t, --take N   The number of bytes to read.
  -u, --utf16    Read the memory at the given offset as an UTF16 string.
  -a, --ascii    Read the memory at the given offset as an ASCII string.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/peslice.py#L8-L46" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class peslice(MemoryExtractorUnit):
    &#34;&#34;&#34;
    Extract data from PE files based on virtual offsets.
    &#34;&#34;&#34;

    def __init__(
        self, offset,
        base: arg.number(&#39;-b&#39;, help=&#39;Optionally specify a custom base address.&#39;) = 0,
        end=None, take=0, utf16=False, ascii=False
    ):
        self.superinit(super(), **vars())
        self.args.base = base

    def _get_file_offset(self, pe, offset):
        addr = offset.address
        end = None
        if offset.section:
            name = offset.section.encode(&#39;latin-1&#39;)
            for section in pe.sections:
                if section.Name.find(name) in (0, 1, 2):
                    addr += section.PointerToRawData
                    end = addr + section.SizeOfRawData
                    self.log_debug(&#39;found section&#39;, name, F&#39;at offset 0x{addr:08X}&#39;)
                    break
            else:
                raise ValueError(F&#39;section {offset.section} was not found.&#39;)
        else:
            base = self.args.base or pe.OPTIONAL_HEADER.ImageBase
            addr = pe.get_offset_from_rva(addr - base)
        return addr, end

    def process(self, data):
        try:
            pe = pefile.PE(data=data, fast_load=True)
        except Exception:
            raise ValueError(&#39;unable to parse input as PE file&#39;)

        return self._read_from_memory(data,
            lambda addr: self._get_file_offset(pe, addr))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.formats.MemoryExtractorUnit" href="units/formats/index.html#refinery.units.formats.MemoryExtractorUnit">MemoryExtractorUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.peslice.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.formats.MemoryExtractorUnit" href="units/formats/index.html#refinery.units.formats.MemoryExtractorUnit">MemoryExtractorUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.formats.MemoryExtractorUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.pestrip"><code class="flex name class">
<span>class <span class="ident">pestrip</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.pe.pestrip" href="units/formats/pe/pestrip.html">refinery.units.formats.pe.pestrip</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: pestrip [-h] [-Q] [-0] [-v]

Removes the overlay of a PE file and returns the stipped executable. Use
peoverlay to extract the overlay.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pe/pestrip.py#L7-L19" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class pestrip(Unit):
    &#34;&#34;&#34;
    Removes the overlay of a PE file and returns the stipped executable. Use `refinery.peoverlay`
    to extract the overlay.
    &#34;&#34;&#34;
    def __init__(self): pass

    def process(self, data: bytearray) -&gt; bytearray:
        size = get_pe_size(data)
        if isinstance(data, bytearray):
            data[size:] = []
            return data
        return data[:size]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.pestrip.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.pkcs7"><code class="flex name class">
<span>class <span class="ident">pkcs7</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.pkcs7" href="units/formats/pkcs7.html">refinery.units.formats.pkcs7</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: pkcs7 [-h] [-Q] [-0] [-v]

Converts PKCS7 encoded data to a JSON representation.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/pkcs7.py#L63-L70" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class pkcs7(Unit):
    &#34;&#34;&#34;
    Converts PKCS7 encoded data to a JSON representation.
    &#34;&#34;&#34;
    def process(self, data: bytes):
        signature = asn1crypto.cms.ContentInfo.load(data)
        with PKCS7Encoder as encoder:
            return encoder.dumps(signature).encode(self.codec)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.pkcs7.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.winreg"><code class="flex name class">
<span>class <span class="ident">winreg</span></span>
<span>(</span><span>*paths, list=False, join=False, **keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.winreg" href="units/formats/winreg.html">refinery.units.formats.winreg</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: winreg [-h] [-Z] [-Q] [-0] [-v] [-l] [-j] [path [path ...]]

Extract values from a Windows registry hive.

positional arguments:
  path           Wildcard pattern for the name of the item to be
                 extracted. Each item is returned as a separate output of
                 this unit. Paths may contain wildcards. The default is a
                 single asterix, which means that every item will be
                 extracted.

optional arguments:
  -l, --list     Return all matching paths as UTF8-encoded output chunks.
  -j, --join     Join path names from container with previous path names.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/winreg.py#L13-L29" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class winreg(PathExtractorUnit):
    &#34;&#34;&#34;
    Extract values from a Windows registry hive.
    &#34;&#34;&#34;
    def _walk(self, key, *path):
        here = &#39;/&#39;.join(path)
        if not self._check_reachable(here):
            return
        for value in key.values():
            vpath = F&#39;{here}/{value.name()}&#39;
            yield UnpackResult(vpath, lambda v=value: v.raw_data())
        for subkey in key.subkeys():
            yield from self._walk(subkey, *path, subkey.name())

    def unpack(self, data):
        with io.BytesIO(data) as stream:
            yield from self._walk(Registry(stream).root())</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.formats.PathExtractorUnit" href="units/formats/index.html#refinery.units.formats.PathExtractorUnit">PathExtractorUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.winreg.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="refinery.winreg.unpack"><code class="name flex">
<span>def <span class="ident">unpack</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/winreg.py#L27-L29" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def unpack(self, data):
    with io.BytesIO(data) as stream:
        yield from self._walk(Registry(stream).root())</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.formats.PathExtractorUnit" href="units/formats/index.html#refinery.units.formats.PathExtractorUnit">PathExtractorUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.formats.PathExtractorUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.xtzip"><code class="flex name class">
<span>class <span class="ident">xtzip</span></span>
<span>(</span><span>*paths, list=False, join=False, pwd=b'')</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.formats.zipfile" href="units/formats/zipfile.html">refinery.units.formats.zipfile</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: xtzip [-h] [-Z] [-Q] [-0] [-v] [-l] [-j] [-p PWD] [path [path ...]]

Extract files from a Zip archive.

positional arguments:
  path           Wildcard pattern for the name of the item to be
                 extracted. Each item is returned as a separate output of
                 this unit. Paths may contain wildcards. The default is a
                 single asterix, which means that every item will be
                 extracted.

optional arguments:
  -l, --list     Return all matching paths as UTF8-encoded output chunks.
  -j, --join     Join path names from container with previous path names.
  -p, --pwd PWD  Optionally specify an extraction password.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/zipfile.py#L9-L26" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class xtzip(PathExtractorUnit):
    &#34;&#34;&#34;
    Extract files from a Zip archive.
    &#34;&#34;&#34;
    def __init__(
        self, *paths, list=False, join=False,
        pwd: arg(&#39;-p&#39;, help=&#39;Optionally specify an extraction password.&#39;) = B&#39;&#39;
    ):
        super().__init__(*paths, list=list, join=join, pwd=pwd)

    def unpack(self, data):
        with io.BytesIO(data) as stream:
            with zipfile.ZipFile(stream) as archive:
                for info in archive.infolist():
                    if info.is_dir():
                        continue
                    yield UnpackResult(info.filename,
                        lambda info=info, pwd=self.args.pwd: archive.read(info.filename, pwd=pwd))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.formats.PathExtractorUnit" href="units/formats/index.html#refinery.units.formats.PathExtractorUnit">PathExtractorUnit</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.xtzip.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="refinery.xtzip.unpack"><code class="name flex">
<span>def <span class="ident">unpack</span></span>(<span>self, data)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/formats/zipfile.py#L19-L26" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def unpack(self, data):
    with io.BytesIO(data) as stream:
        with zipfile.ZipFile(stream) as archive:
            for info in archive.infolist():
                if info.is_dir():
                    continue
                yield UnpackResult(info.filename,
                    lambda info=info, pwd=self.args.pwd: archive.read(info.filename, pwd=pwd))</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.formats.PathExtractorUnit" href="units/formats/index.html#refinery.units.formats.PathExtractorUnit">PathExtractorUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.formats.PathExtractorUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.formats.PathExtractorUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.chop"><code class="flex name class">
<span>class <span class="ident">chop</span></span>
<span>(</span><span>size, truncate=False, into=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.meta.chop" href="units/meta/chop.html">refinery.units.meta.chop</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: chop [-h] [-Z] [-Q] [-0] [-v] [-t] [-i] N

Reinterprets the input as a sequence of equally sized chunks and outputs
this sequence.

positional arguments:
  N               Chop data into chunks of this size.

optional arguments:
  -t, --truncate  Truncate possible excess bytes at the end of the input,
                  by default they are appended as a single chunk.
  -i, --into      If this flag is specified, the size parameter determines
                  the number of blocks to be produced rather than the size
                  of each block. In this case, truncation is performed
                  before the data is split.

generic options:
  -h, --help      Show this help message and exit.
  -Z, --squeeze   Fuse outputs, do not insert line breaks.
  -Q, --quiet     Disables all log output.
  -0, --devnull   Do not produce any output.
  -v, --verbose   Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/chop.py#L7-L37" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class chop(Unit):
    &#34;&#34;&#34;
    Reinterprets the input as a sequence of equally sized chunks and outputs this sequence.
    &#34;&#34;&#34;

    def __init__(
        self, size: arg.number(&#39;size&#39;, help=&#39;Chop data into chunks of this size.&#39;),
        truncate: arg.switch(&#39;-t&#39;, help=(
            &#39;Truncate possible excess bytes at the end of the input, by default they are appended as a single chunk.&#39;)) = False,
        into: arg.switch(&#39;-i&#39;, help=(
            &#39;If this flag is specified, the size parameter determines the number of blocks to be produced rather than the size &#39;
            &#39;of each block. In this case, truncation is performed before the data is split.&#39;)) = False
    ):
        if size &lt; 1:
            raise ValueError(&#39;The chunk size has to be a positive integer value.&#39;)
        return super().__init__(size=size, into=into, truncate=truncate)

    def process(self, data):

        size = self.args.size

        if self.args.into:
            size, remainder = divmod(len(data), size)
            if remainder and not self.args.truncate:
                partition = remainder * (size + 1)
                part1, part2 = data[:partition], data[partition:]
                yield from splitchunks(part1, size + 1)
                yield from splitchunks(part2, size)
                return

        yield from splitchunks(data, size, self.args.truncate)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.chop.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.couple"><code class="flex name class">
<span>class <span class="ident">couple</span></span>
<span>(</span><span>*commandline, buffer=False, timeout=0.0)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.meta.couple" href="units/meta/couple.html">refinery.units.meta.couple</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: couple [-h] [-Z] [-Q] [-0] [-v] [-b] [-t T] ...

Turns any command into a refinery unit. Data is processed by feeding it to
the standard input of a process spawned from the given command line, and
then reading the standard output of that process as the result of the
operation. The main purpose of this unit is to allow using the syntax from
frame with other command line tools. By default, couple streams the output
from the executed command as individual outputs, but the buffer option can
be set to buffer all output of a single execution.

positional arguments:
  (all remaining)  An arbitrary command line to be executed.

optional arguments:
  -b, --buffer     Buffer the command output for one execution rather than
                   streaming it.
  -t, --timeout T  Set an execution timeout as a floating point number in
                   seconds, there is none by default.

generic options:
  -h, --help       Show this help message and exit.
  -Z, --squeeze    Fuse outputs, do not insert line breaks.
  -Q, --quiet      Disables all log output.
  -0, --devnull    Do not produce any output.
  -v, --verbose    Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/couple.py#L11-L145" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class couple(Unit):
    &#34;&#34;&#34;
    Turns any command into a refinery unit. Data is processed by feeding it to the
    standard input of a process spawned from the given command line, and then reading
    the standard output of that process as the result of the operation. The main
    purpose of this unit is to allow using the syntax from `refinery.lib.frame` with
    other command line tools. By default, `refinery.couple` streams the output from
    the executed command as individual outputs, but the `buffer` option can be set to
    buffer all output of a single execution.
    &#34;&#34;&#34;

    def __init__(
        self, *commandline : arg(nargs=&#39;...&#39;, metavar=&#39;(all remaining)&#39;,
            help=&#39;An arbitrary command line to be executed.&#39;),
        buffer: arg.switch(&#39;-b&#39;, help=&#39;Buffer the command output for one execution rather than streaming it.&#39;) = False,
        timeout: arg(&#39;-t&#39;, metavar=&#39;T&#39;,
            help=&#39;Set an execution timeout as a floating point number in seconds, there is none by default.&#39;) = 0.0
    ):
        if not commandline:
            raise ValueError(&#39;you need to provide a command line.&#39;)
        super().__init__(commandline=commandline, buffer=buffer, timeout=timeout)

    def process(self, data):
        def shlexjoin():
            import shlex
            return &#39; &#39;.join(shlex.quote(cmd) for cmd in commandline)

        commandline = [cmd.decode(self.codec) for cmd in self.args.commandline]
        self.log_debug(shlexjoin)

        posix = &#39;posix&#39; in sys.builtin_module_names
        shell = os.name == &#39;nt&#39;
        process = Popen(commandline,
            stdin=PIPE, stdout=PIPE, stderr=PIPE, shell=shell, close_fds=posix)

        if self.args.buffer and not self.args.timeout:
            out, err = process.communicate(data)
            for line in err.splitlines():
                self.log_debug(line)
            yield out
            return

        import io
        from threading import Thread, Event
        from queue import Queue, Empty
        from time import process_time, sleep

        start = 0
        result = None

        qerr = Queue()
        qout = Queue()
        done = Event()

        def adapter(stream, queue: Queue, event: Event):
            while not event.is_set():
                out = stream.read1()
                if out: queue.put(out)
                else: break
            stream.close()

        recvout = Thread(target=adapter, args=(process.stdout, qout, done), daemon=True)
        recverr = Thread(target=adapter, args=(process.stderr, qerr, done), daemon=True)

        recvout.start()
        recverr.start()

        process.stdin.write(data)
        process.stdin.close()
        start = process_time()

        if self.args.buffer or self.args.timeout:
            result = io.BytesIO()

        def queue_read(q: Queue):
            try: return q.get_nowait()
            except Empty: return None

        errbuf = io.BytesIO()

        while True:

            err = queue_read(qerr)
            out = queue_read(qout)
            if err and self.log_info():
                errbuf.write(err)
                errbuf.seek(0)
                lines = errbuf.readlines()
                errbuf.seek(0)
                errbuf.truncate()
                if lines:
                    if not (done.is_set() or lines[~0].endswith(B&#39;\n&#39;)):
                        errbuf.write(lines.pop())
                    for line in lines:
                        msg = line.rstrip(B&#39;\n&#39;)
                        if msg: self.log_info(msg)
            if out:
                if self.args.buffer or self.args.timeout:
                    result.write(out)
                if not self.args.buffer:
                    yield out

            if done.is_set():
                if recverr.is_alive():
                    self.log_warn(&#39;stderr receiver thread zombied&#39;)
                if recvout.is_alive():
                    self.log_warn(&#39;stdout receiver thread zombied&#39;)
                break
            elif not err and not out and process.poll() is not None:
                recverr.join(0.4)
                recvout.join(0.4)
                done.set()
            elif self.args.timeout:
                if process_time() - start &gt; self.args.timeout:
                    self.log_info(&#39;terminating process after timeout expired&#39;)
                    done.set()
                    process.terminate()
                    for wait in range(4):
                        if process.poll() is not None: break
                        sleep(.1)
                    else:
                        self.log_warn(&#39;process termination may have failed&#39;)
                    recverr.join(0.4)
                    recvout.join(0.4)
                    if not len(result.getbuffer()):
                        result = RuntimeError(&#39;timeout reached, process had no output&#39;)
                    else:
                        result = RefineryPartialResult(
                            &#39;timeout reached, returning all collected output&#39;,
                            partial=result.getvalue())

        if isinstance(result, Exception):
            raise result
        elif self.args.buffer:
            yield result.getvalue()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.couple.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.dedup"><code class="flex name class">
<span>class <span class="ident">dedup</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.meta.dedup" href="units/meta/dedup.html">refinery.units.meta.dedup</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: dedup [-h] [-Q] [-0] [-v]

Deduplicates a sequence of multiple inputs, and optionally sorts them.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/dedup.py#L6-L20" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class dedup(Unit):
    &#34;&#34;&#34;
    Deduplicates a sequence of multiple inputs, and optionally sorts them.
    &#34;&#34;&#34;

    def filter(self, chunks):
        barrier = set()
        for chunk in chunks:
            if not chunk.visible:
                yield chunk
                continue
            hashed = hash(chunk)
            if hashed not in barrier:
                barrier.add(hashed)
                yield chunk</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.dedup.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.emit"><code class="flex name class">
<span>class <span class="ident">emit</span></span>
<span>(</span><span>*data)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.meta.emit" href="units/meta/emit.html">refinery.units.meta.emit</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: emit [-h] [-Z] [-Q] [-0] [-v] [data [data ...]]

positional arguments:
  data           Data to be emitted. If no argument is specified, data is
                 retrieved from the clipboard. Multiple arguments are
                 output in framed format.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/emit.py#L10-L39" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class emit(Unit):

    def __init__(self, *data: arg(help=(
        &#39;Data to be emitted. If no argument is specified, data &#39;
        &#39;is retrieved from the clipboard. Multiple arguments are &#39;
        &#39;output in framed format.&#39;
    ))):
        super().__init__(data=data)

    def process(self, data):
        if not self.args.data:
            import pyperclip
            data = pyperclip.paste()
            try:
                data = data.encode(self.codec)
            except AttributeError:
                # data is None
                data = B&#39;&#39;
            except UnicodeDecodeError:
                data = data.encode(&#39;utf-16le&#39;)
            yield data
        else:
            yield from self.args.data

    @classmethod
    def run(cls, argv=None, stream=None):
        super(emit, cls).run(
            argv=argv,
            stream=stream or open(__import__(&#39;os&#39;).devnull, &#39;rb&#39;)
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.emit.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.fread"><code class="flex name class">
<span>class <span class="ident">fread</span></span>
<span>(</span><span>*filenames, size=0, linewise=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.meta.fread" href="units/meta/fread.html">refinery.units.meta.fread</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: fread [-h] [-Z] [-Q] [-0] [-v] [-s N] [-l] FILEMASK [FILEMASK ...]

Reads files from disk and outputs them individually. Has the ability to
read large files in chunks.

positional arguments:
  FILEMASK        A list of file masks (with wildcard patterns). Each
                  matching file will be read from disk and emitted. In
                  addition to glob patterns, the file mask can include
                  format string expressions which will be substituted from
                  the current meta variables.

optional arguments:
  -s, --size N    If specified, files will be read in chunks of size N and
                  each chunk is emitted as one element in the output list.
  -l, --linewise  Read the file linewise. By default, one line is read at
                  a time. In line mode, the --size argument can be used to
                  read the given number of lines in each chunk.

generic options:
  -h, --help      Show this help message and exit.
  -Z, --squeeze   Fuse outputs, do not insert line breaks.
  -Q, --quiet     Disables all log output.
  -0, --devnull   Do not produce any output.
  -v, --verbose   Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/fread.py#L11-L101" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class fread(Unit):
    &#34;&#34;&#34;
    Reads files from disk and outputs them individually. Has the ability to
    read large files in chunks.
    &#34;&#34;&#34;

    def __init__(self,
        *filenames: arg(metavar=&#39;FILEMASK&#39;, nargs=&#39;+&#39;, type=str, help=(
            &#39;A list of file masks (with wildcard patterns). Each matching &#39;
            &#39;file will be read from disk and emitted. In addition to glob &#39;
            &#39;patterns, the file mask can include format string expressions &#39;
            &#39;which will be substituted from the current meta variables.&#39;
        )),
        size: arg.number(&#39;-s&#39;, help=(
            &#39;If specified, files will be read in chunks of size N and each &#39;
            &#39;chunk is emitted as one element in the output list.&#39;
        )) = 0,
        linewise: arg.switch(&#39;-l&#39;, help=(
            &#39;Read the file linewise. By default, one line is read at a time. &#39;
            &#39;In line mode, the --size argument can be used to read the given &#39;
            &#39;number of lines in each chunk.&#39;
        )) = False
    ):
        super().__init__(size=size, linewise=linewise, filenames=filenames)

    def _read_chunks(self, fd):
        while True:
            buffer = fd.read(self.args.size)
            if not buffer:
                break
            yield buffer

    def _read_lines(self, fd):
        count = self.args.size or 1
        if count == 1:
            while True:
                buffer = fd.readline()
                if not buffer:
                    break
                yield buffer
            return
        with BytesIO() as out:
            while True:
                for _ in range(count):
                    buffer = fd.readline()
                    if not buffer:
                        break
                    out.write(buffer)
                if not out.tell():
                    break
                yield out.getvalue()
                out.seek(0)
                out.truncate()

    def process(self, data):
        class metamap(dict):
            def __missing__(_, key): # noqa
                try:
                    value = data[key]
                    if isinstance(value, (str, int, float)):
                        return value
                    if isbuffer(value):
                        return value.decode(self.codec)
                except Exception:
                    pass
                return F&#39;{{{key}}}&#39;

        metamap = metamap()

        for mask in self.args.filenames:
            mask = mask.format_map(metamap)
            self.log_debug(&#39;scanning for mask:&#39;, mask)
            for filename in glob(mask, recursive=True):
                if not isfile(filename):
                    continue
                try:
                    with open(filename, &#39;rb&#39;) as stream:
                        if self.args.linewise:
                            yield from self._read_lines(stream)
                        elif self.args.size:
                            yield from self._read_chunks(stream)
                        else:
                            data = stream.read()
                            self.log_info(lambda: F&#39;reading: {filename} ({len(data)} bytes)&#39;)
                            yield dict(data=data, path=filename)
                except PermissionError:
                    self.log_warn(&#39;permission denied:&#39;, filename)
                except FileNotFoundError:
                    self.log_warn(&#39;file is missing:&#39;, filename)
                except Exception:
                    self.log_warn(&#39;unknown error while reading:&#39;, filename)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.fread.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.mpop"><code class="flex name class">
<span>class <span class="ident">mpop</span></span>
<span>(</span><span>*names)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.meta.mpop" href="units/meta/mpop.html">refinery.units.meta.mpop</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: mpop [-h] [-Q] [-0] [-v] [name [name ...]]

In processing order, remove visible chunks from the current frame and
store their contents in the given meta variables.

positional arguments:
  name           The meta variable names.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/mpop.py#L8-L51" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class mpop(Unit):
    &#34;&#34;&#34;
    In processing order, remove visible chunks from the current frame and store
    their contents in the given meta variables.
    &#34;&#34;&#34;
    def __init__(
        self,
        *names: arg(type=str, metavar=&#39;name&#39;, help=&#39;The meta variable names.&#39;)
    ):
        super().__init__(names=names)

    def process(self, data):
        return data

    def filter(self, chunks):
        invisible = []
        variables = {}
        remaining = iter(self.args.names)

        it = iter(chunks)

        for chunk in it:
            if not chunk.visible:
                self.log_debug(&#39;buffering invisible chunk&#39;)
                invisible.append(chunk)
                continue
            try:
                name = next(remaining)
                variables[name] = chunk
                self.log_debug(&#39;setting variable&#39;, name)
            except StopIteration:
                invisible.append(chunk)
                break
        try:
            next(remaining)
        except StopIteration:
            pass
        else:
            raise ValueError(&#39;Not all variables could be assigned.&#39;)

        for chunk in itertools.chain(invisible, it):
            chunk.meta.update(variables)
            chunk.visible = True
            yield chunk</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.mpop.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.mpush"><code class="flex name class">
<span>class <span class="ident">mpush</span></span>
<span>(</span><span>count=2)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.meta.mpush" href="units/meta/mpush.html">refinery.units.meta.mpush</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: mpush [-h] [-Z] [-Q] [-0] [-v] [count]

The unit operates almost exactly as rep, except that the last copy of the
data is moved out of scope. This chunk is considered the &quot;original&quot; data,
while all other chunks are to be used as intermediate results. For
example:

    emit key=value | mpush [[| rex =(.*)$ $1 | mpop v ]| repl var:v censored ]

will output key=censored. The application of rex turns the (duplicated)
data into just the value, which is then stored in the variable v. The
application of repl replaces this value with the hard-coded string
censored.

positional arguments:
  count          Defines the number of outputs for each input. The default
                 is the minimum of 2.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/mpush.py#L6-L28" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class mpush(rep):
    &#34;&#34;&#34;
    The unit operates almost exactly as `refinery.rep`, except that the last copy of the
    data is moved out of scope. This chunk is considered the &#34;original&#34; data, while all
    other chunks are to be used as intermediate results. For example:

        emit key=value | mpush [[| rex =(.*)$ $1 | mpop v ]| repl var:v censored ]

    will output `key=censored`. The application of `refinery.rex` turns the (duplicated)
    data into just the value, which is then stored in the variable `v`. The application
    of `refinery.repl` replaces this value with the hard-coded string `censored`.
    &#34;&#34;&#34;
    def process(self, data):
        for _ in range(self.args.count - 1):
            yield data
        if self.args.nesting &gt; 0:
            data.set_next_scope(False)
        else:
            try:
                data.visible = False
            except AttributeError:
                self.log_warn(&#39;application has no effect outside frame.&#39;)
        yield data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.strings.rep.rep" href="units/strings/rep.html#refinery.units.strings.rep.rep">rep</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.mpush.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.strings.rep.rep" href="units/strings/rep.html#refinery.units.strings.rep.rep">rep</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.strings.rep.rep.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.strings.rep.rep.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.strings.rep.rep.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.strings.rep.rep.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.strings.rep.rep.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.strings.rep.rep.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.strings.rep.rep.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.strings.rep.rep.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.strings.rep.rep.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.strings.rep.rep.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.strings.rep.rep.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.strings.rep.rep.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.strings.rep.rep.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.strings.rep.rep.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.mput"><code class="flex name class">
<span>class <span class="ident">mput</span></span>
<span>(</span><span>name, value)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.meta.mput" href="units/meta/mput.html">refinery.units.meta.mput</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: mput [-h] [-Q] [-0] [-v] name value

Can be used to add a meta variable to the processed chunk. Note that meta
variables cease to exist outside a frame.

positional arguments:
  name           The name of the variable to be used.
  value          The value for the variable.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/mput.py#L6-L19" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class mput(Unit):
    &#34;&#34;&#34;
    Can be used to add a meta variable to the processed chunk. Note that meta variables
    cease to exist outside a frame.
    &#34;&#34;&#34;
    def __init__(
        self,
        name : arg(help=&#39;The name of the variable to be used.&#39;, type=str),
        value: arg(help=&#39;The value for the variable.&#39;)
    ):
        super().__init__(name=name, value=value)

    def process(self, data):
        return {&#39;data&#39;: data, self.args.name: self.args.value}</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.mput.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.nop"><code class="flex name class">
<span>class <span class="ident">nop</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.meta.nop" href="units/meta/nop.html">refinery.units.meta.nop</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: nop [-h] [-Q] [-0] [-v]

Does not change the data.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/nop.py#L6-L10" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class nop(Unit):
    &#34;&#34;&#34;
    Does not change the data.
    &#34;&#34;&#34;
    pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.nop.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.pad"><code class="flex name class">
<span>class <span class="ident">pad</span></span>
<span>(</span><span>padding=b'\x00', absolute=0, blocksize=0, left=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.meta.pad" href="units/meta/pad.html">refinery.units.meta.pad</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: pad [-h] [-Q] [-0] [-v] [-a N | -b N] [-l] [padding]

Allows padding of the input data. By default, multiple inputs are padded
to all have length equal to the size of the longest input. Other optional
size specifications override this behaviour.

positional arguments:
  padding            This custom binary sequence is used (repeatedly, if
                     necessary) to pad the input. The default is a zero
                     byte.

optional arguments:
  -a, --absolute N   Pad inputs to be at least N bytes in size.
  -b, --blocksize N  Pad inputs to any even multiple of N.
  -l, --left         Pad on the left instead of the right.

generic options:
  -h, --help         Show this help message and exit.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/pad.py#L6-L65" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class pad(Unit):
    &#34;&#34;&#34;
    Allows padding of the input data. By default, multiple inputs are padded
    to all have length equal to the size of the longest input. Other optional
    size specifications override this behaviour.
    &#34;&#34;&#34;

    def __init__(
        self, padding: arg(&#39;padding&#39;, help=(
            &#39;This custom binary sequence is used (repeatedly, if necessary) &#39;
            &#39;to pad the input. The default is a zero byte.&#39;)) = B&#39;\0&#39;,
        absolute : arg.number(&#39;-a&#39;, group=&#39;HOW&#39;, help=&#39;Pad inputs to be at least N bytes in size.&#39;) = 0,
        blocksize: arg.number(&#39;-b&#39;, group=&#39;HOW&#39;, help=&#39;Pad inputs to any even multiple of N.&#39;) = 0,
        left: arg.switch(&#39;-l&#39;, help=&#39;Pad on the left instead of the right.&#39;) = False
    ):
        if absolute and blocksize:
            raise ValueError(&#39;Cannot pad simultaneously to a given block size and absolutely.&#39;)
        self.superinit(super(), **vars())
        self._maxlen = None

    @property
    def relative(self):
        if self.args.blocksize:
            return False
        if self.args.absolute:
            return False
        return True

    def _pad(self, data, size):
        missing = (size - len(data))
        if missing &lt;= 0:
            return data
        pad = self.args.padding
        if missing &gt; len(pad):
            pad *= (missing // len(pad))
        if self.args.left:
            return pad[:missing] + data
        else:
            data += pad[:missing]
            return data

    def filter(self, inputs):
        if self.relative:
            self.log_info(&#39;padding up to longest input&#39;)
            if not isinstance(inputs, list):
                inputs = list(inputs)
            self._maxlen = max(len(d) for d in inputs)
        else:
            self._maxlen = None
        yield from inputs

    def process(self, data):
        if self._maxlen is not None:
            return self._pad(data, self._maxlen)
        if self.args.blocksize:
            q, r = divmod(len(data), self.args.blocksize)
            size = (q + bool(r)) * self.args.blocksize
        else:
            size = self.args.absolute
        return self._pad(data, size)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.pad.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="refinery.pad.relative"><code class="name">var <span class="ident">relative</span></code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/pad.py#L26-L32" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@property
def relative(self):
    if self.args.blocksize:
        return False
    if self.args.absolute:
        return False
    return True</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.pick"><code class="flex name class">
<span>class <span class="ident">pick</span></span>
<span>(</span><span>*slice)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.meta.pick" href="units/meta/pick.html">refinery.units.meta.pick</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: pick [-h] [-Q] [-0] [-v] [slice [slice ...]]

Picks sequences from the array of multiple inputs. For example, pick 0 2:
will return all but the second ingested input (which has index 1).

positional arguments:
  slice          Specify start:stop:step in Python slice syntax.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/pick.py#L10-L45" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class pick(Unit):
    &#34;&#34;&#34;
    Picks sequences from the array of multiple inputs. For example, `pick 0 2:`
    will return all but the second ingested input (which has index `1`).
    &#34;&#34;&#34;
    def __init__(self, *slice: arg(
        type=sliceobj, nargs=&#39;*&#39;, default=[slice(None, None)],
        help=&#39;Specify start:stop:step in Python slice syntax.&#39;
    )):
        super().__init__(slice=slice)

    def filter(self, inputs):
        slices = deque(self.args.slice)
        discards = 0
        consumed = False

        def discardable(s):
            return s.stop and s.stop &gt;= 0 and (s.step or 1) &gt; 0 \
                and all(t.start &gt;= s.stop for t in slices)

        while slices:
            s = slices.popleft()

            if not consumed:
                if not discardable(s):
                    self.log_debug(F&#39;consumed input into buffer after {discards} skips&#39;)
                    inputs = [None] * discards + list(inputs)
                    consumed = True

            if consumed:
                yield from inputs[s]
            else:
                yield from islice(chain(repeat(None, discards), inputs), s.start, s.stop, s.step)
                discards = s.stop

        return</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.pick.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.scope"><code class="flex name class">
<span>class <span class="ident">scope</span></span>
<span>(</span><span>*slice, visible=True)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.meta.scope" href="units/meta/scope.html">refinery.units.meta.scope</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: scope [-h] [-Q] [-0] [-v] [-n] [slice [slice ...]]

After using scope within in a frame, all the following operations will be
applied only to the selected indices. All remaining chunks still exist,
they are just not operated on. When the frame closes or the frame is being
rescoped by a second application of this unit, they become visible again.

positional arguments:
  slice          Specify start:stop:step in Python slice syntax.

optional arguments:
  -n, --not      Hide the given chunks instead of making them the only
                 ones visible.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/scope.py#L7-L56" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class scope(FrameSlicer):
    &#34;&#34;&#34;
    After using `refinery.scope` within in a `refinery.lib.frame`, all the
    following operations will be applied only to the selected indices. All
    remaining chunks still exist, they are just not operated on. When the
    frame closes or the frame is being rescoped by a second application of
    this unit, they become visible again.
    &#34;&#34;&#34;
    def __init__(self, *slice, visible: arg.switch(&#39;-n&#39;, &#39;--not&#39;, off=True, help=(
        &#39;Hide the given chunks instead of making them the only ones visible.&#39;)) = True
    ):
        super().__init__(*slice, visible=visible)
        # Sort any slices with negative arguments to the back so we check
        # them last. This delays potential consumption of the chunks iterator
        # as much as possible.
        self.args.slice.sort(
            key=lambda s: (s.start or 0, s.stop or 0), reverse=True)

    def filter(self, chunks):
        it = iter(chunks)
        consumed = None
        size = None

        def buffered():
            yield from it
            while consumed:
                yield consumed.popleft()

        def shift(offset, default):
            nonlocal consumed, it, size
            if offset is None:
                return default
            if offset &gt;= 0:
                return offset
            if consumed is None:
                from collections import deque
                self.log_info(F&#39;consuming iterator to compute negative offset {offset}.&#39;)
                consumed = deque(it)
                size = len(consumed) + k + 1
            return max(0, offset + size)

        for k, chunk in enumerate(buffered()):
            for s in self.args.slice:
                if k in range(shift(s.start, 0), shift(s.stop, k + 1), s.step or 1):
                    chunk.visible = self.args.visible
                    break
            else:
                chunk.visible = not self.args.visible
            self.log_debug(chunk)
            yield chunk</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.meta.FrameSlicer" href="units/meta/index.html#refinery.units.meta.FrameSlicer">FrameSlicer</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.scope.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.meta.FrameSlicer" href="units/meta/index.html#refinery.units.meta.FrameSlicer">FrameSlicer</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.meta.FrameSlicer.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.meta.FrameSlicer.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.meta.FrameSlicer.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.meta.FrameSlicer.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.meta.FrameSlicer.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.meta.FrameSlicer.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.meta.FrameSlicer.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.meta.FrameSlicer.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.meta.FrameSlicer.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.meta.FrameSlicer.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.meta.FrameSlicer.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.meta.FrameSlicer.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.meta.FrameSlicer.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.meta.FrameSlicer.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.meta.FrameSlicer.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.sep"><code class="flex name class">
<span>class <span class="ident">sep</span></span>
<span>(</span><span>separator=b'\n', scoped=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.meta.sep" href="units/meta/sep.html">refinery.units.meta.sep</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: sep [-h] [-Z] [-Q] [-0] [-v] [-s] [separator]

Multiple inputs are joined along a specified separator. If any of the
input Chunks is currently out of scope, sep turns makes them visible by
default. This can be prevented by using the -s flag.

positional arguments:
  separator      Separator; the default is a line break.

optional arguments:
  -s, --scoped   Maintain chunk scope; i.e. do not turn all input chunks
                 visible.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/sep.py#L6-L39" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class sep(Unit):
    &#34;&#34;&#34;
    Multiple inputs are joined along a specified separator. If any of the input
    `refinery.lib.frame.Chunk`s is currently out of scope, `refinery.sep` turns
    makes them visible by default. This can be prevented by using the `-s` flag.
    &#34;&#34;&#34;

    def __init__(
        self, separator: arg(help=&#39;Separator; the default is a line break.&#39;) = B&#39;\n&#39;,
        scoped: arg.switch(&#39;-s&#39;, help=(
            &#39;Maintain chunk scope; i.e. do not turn all input chunks visible.&#39;)) = False
    ):
        super().__init__(separator=separator, scoped=scoped)
        self.separate = False

    def filter(self, inputs):
        it = iter(inputs)
        try:
            data = next(it)
        except StopIteration:
            return
        self.separate = True
        for upcoming in it:
            if not self.args.scoped:
                data.visible = True
            yield data
            data = upcoming
        self.separate = False
        yield data

    def process(self, data):
        yield data
        if self.separate:
            yield self.args.separator</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.sep.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.sorted"><code class="flex name class">
<span>class <span class="ident">sorted</span></span>
<span>(</span><span>length)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.meta.sorted" href="units/meta/sorted.html">refinery.units.meta.sorted</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: sorted [-h] [-Q] [-0] [-v] [-l]

Sorts all elements of the input frame lexicographically. This unit is a
nop on single inputs.

optional arguments:
  -l, --length   Sort items by length before sorting lexicographically.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/meta/sorted.py#L6-L50" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class sorted(Unit):
    &#34;&#34;&#34;
    Sorts all elements of the input `refinery.lib.frame` lexicographically.
    This unit is a `refinery.nop` on single inputs.
    &#34;&#34;&#34;

    def __init__(self, length: arg.switch(&#39;-l&#39;, help=&#39;Sort items by length before sorting lexicographically.&#39;)):
        super().__init__(length=length)

    def filter(self, chunks):
        sortbuffer = []
        invisibles = {}

        for k, chunk in enumerate(chunks):
            if not chunk.visible:
                r = k - len(invisibles)
                invisibles.setdefault(r, [])
                invisibles[r].append(chunk)
            else:
                sortbuffer.append(chunk)

        if self.args.length:
            sortbuffer.sort(key=lambda t: (len(t), t))
        else:
            sortbuffer.sort()

        if not invisibles:
            yield from sortbuffer
            return

        for r, chunk in enumerate(sortbuffer):
            if r in invisibles:
                yield from invisibles[r]
                del invisibles[r]
            yield chunk

        if invisibles:
            yield from invisibles[r]
            del invisibles[r]

        if invisibles:
            raise RefineryCriticalException(
                &#39;for unknown reasons, invisible chunks were lost during &#39;
                &#39;the sorting process.&#39;
            )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.sorted.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.autoxor"><code class="flex name class">
<span>class <span class="ident">autoxor</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.misc.autoxor" href="units/misc/autoxor.html">refinery.units.misc.autoxor</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: autoxor [-h] [-Q] [-0] [-v]

Automatically perform a single byte XOR decryption of the input data. The
unit uses the most frequent byte value from the input data as the
decryption key.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/misc/autoxor.py#L8-L18" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class autoxor(Unit):
    &#34;&#34;&#34;
    Automatically perform a single byte XOR decryption of the input data. The unit
    uses the most frequent byte value from the input data as the decryption key.
    &#34;&#34;&#34;
    def process(self, data):
        data = np.frombuffer(memoryview(data), np.ubyte)
        xkey = np.argmax(np.bincount(data))
        self.log_info(F&#39;using key 0x{xkey:02X}&#39;)
        data ^= xkey
        return data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.autoxor.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.binpng"><code class="flex name class">
<span>class <span class="ident">binpng</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.misc.binpng" href="units/misc/binpng.html">refinery.units.misc.binpng</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: binpng [-h] [-Q] [-0] [-v]

Decodes the RGBT (red/green/blue/transparency) values of the pixels of a
given PNG image file and outputs these values as bytes.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/misc/binpng.py#L9-L20" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class binpng(Unit):
    &#34;&#34;&#34;
    Decodes the RGBT (red/green/blue/transparency) values of the pixels
    of a given PNG image file and outputs these values as bytes.
    &#34;&#34;&#34;
    def process(self, data):
        image = PIL.Image.open(io.BytesIO(data))
        pixelmap, width, height = image.load(), *image.size
        return bytes(code
            for i in range(width)
            for j in range(height)
            for code in pixelmap[i, j])</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.binpng.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.datefix"><code class="flex name class">
<span>class <span class="ident">datefix</span></span>
<span>(</span><span>format='%Y-%m-%d %H:%M:%S', dos=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.misc.datefix" href="units/misc/datefix.html">refinery.units.misc.datefix</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: datefix [-h] [-Z] [-Q] [-0] [-v] [-d] [format]

Parses all kinds of date _formats and unifies them into the same format.

positional arguments:
  format         Specify the output format as a strftime-like string,
                 using ISO by default.

optional arguments:
  -d, --dos      Parse timestamps in DOS rather than Unix format.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/misc/datefix.py#L10-L110" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class datefix(Unit):
    &#34;&#34;&#34;
    Parses all kinds of date _formats and unifies them into the same format.
    &#34;&#34;&#34;

    _FORMATS = [
        &#39;%B %dth %Y %H:%M:%S (UTC)&#39;,  # November 27th 2019 17:37:02 (UTC)
        &#39;%Y-%m-%dT%H:%M:%S&#39;,          # 2010-03-15T06:27:50
        &#39;%Y-%m-%d %H:%M:%S&#39;,          # iso (2010-03-15 06:27:50.000000)
        &#39;%Y-%m-%d %H:%M:%SZ%f&#39;,
        &#39;%Y-%m-%dT%H:%M:%S.%f&#39;,
        &#39;%Y-%m-%dT%H:%M:%SZ%f&#39;,
        &#39;%a %b %d %Y %H:%M:%S&#39;,       # Thu Apr 24 2014 12:32:21
    ]

    _TIMEZONE_REGEXES = [re_compile(p) for p in [
        R&#39;([+-])(\d{2})(\d{2})$&#39;,           # Thu Apr 24 2014 12:32:21 GMT-0700
        R&#39;([+-])(\d{2}):(\d{2})$&#39;,          # 2017:09:11 23:47:22+02:00
        R&#39;GMT([+-])(\d{2})(\d{2}) \(.+\)$&#39;  # Thu Apr 24 2014 12:32:21 GMT-0700 (PDT)
    ]]

    def __init__(
        self,
        format: arg(help=&#39;Specify the output format as a strftime-like string, using ISO by default.&#39;) = &#39;%Y-%m-%d %H:%M:%S&#39;,
        dos: arg(&#39;-d&#39;, help=&#39;Parse timestamps in DOS rather than Unix format.&#39;) = False
    ):
        super().__init__(format=format, dos=dos)

    @staticmethod
    def dostime(stamp: int) -&gt; datetime:
        &#34;&#34;&#34;
        Parses a given DOS timestamp into a datetime object.
        &#34;&#34;&#34;
        d, t = stamp &gt;&gt; 16, stamp &amp; 0xFFFF
        s = (t &amp; 0x1F) &lt;&lt; 1

        return datetime(
            year   = ((d &amp; 0xFE00) &gt;&gt; 0x9) + 1980,  # noqa
            month  = ((d &amp; 0x01E0) &gt;&gt; 0x5),         # noqa
            day    = ((d &amp; 0x001F) &gt;&gt; 0x0),         # noqa
            hour   = ((t &amp; 0xF800) &gt;&gt; 0xB),         # noqa
            minute = ((t &amp; 0x07E0) &gt;&gt; 0x5),         # noqa
            second = 59 if s == 60 else s,          # noqa
        )

    def _format(self, dt: datetime) -&gt; str:
        return dt.strftime(self.args.format)

    def _extract_timezone(self, data):
        for r in self._TIMEZONE_REGEXES:
            m = r.search(data)
            if not m:
                continue
            pm = m[1]
            td = timedelta(
                hours=int(m[2]), minutes=int(m[3]))
            if pm == &#39;-&#39;:
                td = -td
            return data[:-len(m[0])].strip(), td

        return data, None

    @linewise
    def process(self, data: str) -&gt; str:
        data = data.strip()

        # replace colons (i.e. for exiftool dates: 2017:01:01)
        if len(data) &gt; 10 and data[4] == &#39;:&#39; and data[7] == &#39;:&#39;:
            data = F&#39;{data[0:4]}-{data[5:7]}-{data[8:]}&#39;

        # strips Z at end (i.e. 20171022055144Z)
        if data.endswith(&#39;Z&#39;):
            data = data[:-1]

        # parses timestamps and dates without much format
        if data.isdigit():
            time_stamp = int(data)
            if len(data) &gt; 14:
                raise Exception(&#39;cannot parse all-numeric string as date: %s&#39; % data)
            elif len(data) == 14:
                # i.e. 20111020193727
                return self._format(datetime.strptime(data, &#39;%Y%m%d%H%M%S&#39;))
            elif len(data) == 13:
                # i.e. 1458016535000
                time_stamp //= 1000
                data = data[:-3]
            if self.args.dos:
                return self._format(self.dostime(time_stamp))
            else:
                return self._format(datetime.utcfromtimestamp(time_stamp))

        data, time_delta = self._extract_timezone(data)

        for f in self._FORMATS:
            try:
                dt = datetime.strptime(data, f)
            except ValueError:
                continue
            return self._format(dt if time_delta is None else dt - time_delta)

        return data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.datefix.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="refinery.datefix.dostime"><code class="name flex">
<span>def <span class="ident">dostime</span></span>(<span>stamp)</span>
</code></dt>
<dd>
<section class="desc"><p>Parses a given DOS timestamp into a datetime object.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/misc/datefix.py#L38-L53" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@staticmethod
def dostime(stamp: int) -&gt; datetime:
    &#34;&#34;&#34;
    Parses a given DOS timestamp into a datetime object.
    &#34;&#34;&#34;
    d, t = stamp &gt;&gt; 16, stamp &amp; 0xFFFF
    s = (t &amp; 0x1F) &lt;&lt; 1

    return datetime(
        year   = ((d &amp; 0xFE00) &gt;&gt; 0x9) + 1980,  # noqa
        month  = ((d &amp; 0x01E0) &gt;&gt; 0x5),         # noqa
        day    = ((d &amp; 0x001F) &gt;&gt; 0x0),         # noqa
        hour   = ((t &amp; 0xF800) &gt;&gt; 0xB),         # noqa
        minute = ((t &amp; 0x07E0) &gt;&gt; 0x5),         # noqa
        second = 59 if s == 60 else s,          # noqa
    )</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_ps1"><code class="flex name class">
<span>class <span class="ident">deob_ps1</span></span>
<span>(</span><span>timeout)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.ps1.all" href="units/obfuscation/ps1/all.html">refinery.units.obfuscation.ps1.all</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-ps1 [-h] [-Q] [-0] [-v] [-t TIMEOUT]

optional arguments:
  -t, --timeout TIMEOUT  Maximum number of iterations; the default is 100.

generic options:
  -h, --help             Show this help message and exit.
  -Q, --quiet            Disables all log output.
  -0, --devnull          Do not produce any output.
  -v, --verbose          Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/ps1/all.py#L18-L44" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_ps1(IterativeDeobfuscator):

    _SUBUNITS = [sub() for sub in [
        deob_ps1_escape,
        deob_ps1_cases,
        deob_ps1_brackets,
        deob_ps1_format,
        deob_ps1_typecast,
        deob_ps1_stringreplace,
        deob_ps1_concat,
        deob_ps1_invoke,
        deob_ps1_literals
    ]]

    def __init__(self, timeout):
        super().__init__(timeout)

    def deobfuscate(self, data):
        for u in self._SUBUNITS:
            u.log_level = self.log_level
        for unit in self._SUBUNITS:
            self.log_debug(lambda: F&#39;invoking {unit.name}&#39;)
            checkpoint = hash(data)
            data = unit.deobfuscate(data)
            if checkpoint != hash(data) and not self.log_debug(&#39;data has changed.&#39;):
                self.log_info(F&#39;used {unit.name}&#39;)
        return re.sub(R&#39;[\r\n]+&#39;, &#39;\n&#39;, data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.IterativeDeobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.IterativeDeobfuscator">IterativeDeobfuscator</a></li>
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_ps1.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.IterativeDeobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.IterativeDeobfuscator">IterativeDeobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_ps1_brackets"><code class="flex name class">
<span>class <span class="ident">deob_ps1_brackets</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.ps1.brackets" href="units/obfuscation/ps1/brackets.html">refinery.units.obfuscation.ps1.brackets</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-ps1-brackets [-h] [-Q] [-0] [-v]

PowerShell deobfuscation that removes superfluous brackets around constant
literals, i.e. (&quot;{0}{2}{1}&quot;) is transformed to &quot;{0}{2}{1}&quot;. Currently,
only integer and string constants are supported.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/ps1/brackets.py#L10-L38" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_ps1_brackets(Deobfuscator):
    &#34;&#34;&#34;
    PowerShell deobfuscation that removes superfluous brackets around constant
    literals, i.e. `(&#34;{0}{2}{1}&#34;)` is transformed to `&#34;{0}{2}{1}&#34;`. Currently,
    only integer and string constants are supported.
    &#34;&#34;&#34;
    _SENTINEL = re.compile(
        RF&#39;&#39;&#39;(?&lt;![\w&#34;&#39;]{{2}})&#39;&#39;&#39;  # this may be a function call
        RF&#39;&#39;&#39;(\-\w+)?&#39;&#39;&#39;  # not a function call but an argument
        RF&#39;&#39;&#39;\(\s*({formats.integer}|{formats.ps1str})\s*(\S)&#39;&#39;&#39;,
        flags=re.IGNORECASE
    )

    def deobfuscate(self, data):
        strlit = Ps1StringLiterals(data)
        repeat = True

        @strlit.outside
        def replacement(match):
            nonlocal repeat
            if match[3] == &#39;)&#39;:
                repeat = True
                return (match[1] or &#39;&#39;) + match[2]

        while repeat:
            repeat = False
            data = self._SENTINEL.sub(replacement, data)

        return data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_ps1_brackets.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.Deobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_ps1_cases"><code class="flex name class">
<span>class <span class="ident">deob_ps1_cases</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.ps1.cases" href="units/obfuscation/ps1/cases.html">refinery.units.obfuscation.ps1.cases</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-ps1-cases [-h] [-Q] [-0] [-v]

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/ps1/cases.py#L9-L45" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_ps1_cases(Deobfuscator):
    _NAMES = [
        &#39;-BXor&#39;,
        &#39;-Exec Bypass&#39;,
        &#39;-NoLogo&#39;,
        &#39;-NonInter&#39;,
        &#39;-Replace&#39;,
        &#39;-Windows Hidden&#39;,
        &#39;.Invoke&#39;,
        &#39;Assembly&#39;,
        &#39;Byte&#39;,
        &#39;Char&#39;,
        &#39;ChildItem&#39;,
        &#39;CreateThread&#39;,
        &#39;Get-Variable&#39;,
        &#39;GetType&#39;,
        &#39;IntPtr&#39;,
        &#39;Invoke-Expression&#39;,
        &#39;Invoke&#39;,
        &#39;Length&#39;,
        &#39;Net.WebClient&#39;,
        &#39;PowerShell&#39;,
        &#39;PSVersionTable&#39;,
        &#39;Set-Item&#39;,
        &#39;Set-Variable&#39;,
        &#39;Start-Sleep&#39;,
        &#39;ToString&#39;,
        &#39;Type&#39;,
        &#39;Value&#39;,
        &#39;Void&#39;,
    ]

    @outside(formats.ps1str)
    def deobfuscate(self, data):
        for name in self._NAMES:
            data = re.sub(RF&#39;\b{re.escape(name)}\b&#39;, name, data, flags=re.IGNORECASE)
        return data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_ps1_cases.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.Deobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_ps1_concat"><code class="flex name class">
<span>class <span class="ident">deob_ps1_concat</span></span>
<span>(</span><span>timeout=100)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.ps1.concat" href="units/obfuscation/ps1/concat.html">refinery.units.obfuscation.ps1.concat</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-ps1-concat [-h] [-Q] [-0] [-v] [-t TIMEOUT]

optional arguments:
  -t, --timeout TIMEOUT  Maximum number of iterations; the default is 100.

generic options:
  -h, --help             Show this help message and exit.
  -Q, --quiet            Disables all log output.
  -0, --devnull          Do not produce any output.
  -v, --verbose          Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/ps1/concat.py#L9-L42" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_ps1_concat(IterativeDeobfuscator):
    _SENTINEL = re.compile(R&#39;&#39;&#39;[&#39;&#34;]\s*[+&amp;]\s*[&#39;&#34;]&#39;&#39;&#39;)

    def deobfuscate(self, data):

        def concat(data):
            strlit = Ps1StringLiterals(data)
            repeat = True
            while repeat:
                for match in self._SENTINEL.finditer(data):
                    a, b = match.span()
                    a = strlit.get_container(a)
                    if a is None:
                        continue
                    b = strlit.get_container(b)
                    if b is None or b != a + 1:
                        continue
                    a = strlit.ranges[a]
                    b = strlit.ranges[b]
                    stra = data[slice(*a)]
                    strb = data[slice(*b)]
                    parts = list(string_unquote(stra))
                    it = iter(string_unquote(strb))
                    parts[~0] += next(it)
                    parts.extend(it)
                    yield data[:a[0]] + string_quote(parts)
                    data = data[b[1]:]
                    strlit.update(data)
                    break
                else:
                    repeat = False
            yield data

        return &#39;&#39;.join(concat(data))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.IterativeDeobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.IterativeDeobfuscator">IterativeDeobfuscator</a></li>
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_ps1_concat.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.IterativeDeobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.IterativeDeobfuscator">IterativeDeobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.IterativeDeobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_ps1_escape"><code class="flex name class">
<span>class <span class="ident">deob_ps1_escape</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.ps1.escape" href="units/obfuscation/ps1/escape.html">refinery.units.obfuscation.ps1.escape</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-ps1-escape [-h] [-Q] [-0] [-v]

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/ps1/escape.py#L9-L15" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_ps1_escape(Deobfuscator):

    def deobfuscate(self, data):
        strlit = Ps1StringLiterals(data)
        @strlit.outside
        def repl(m): return m[1]
        return re.sub(R&#39;&#39;&#39;`([^0abfnrtv`#&#39;&#34;\$])&#39;&#39;&#39;, repl, data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_ps1_escape.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.Deobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_ps1_format"><code class="flex name class">
<span>class <span class="ident">deob_ps1_format</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.ps1.format" href="units/obfuscation/ps1/format.html">refinery.units.obfuscation.ps1.format</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-ps1-format [-h] [-Q] [-0] [-v]

PowerShell deobfuscation for the following &quot;format string&quot;-based
technique:

- &quot;{0}{2}{1}&quot;-f 'signa','ures','t'
- &quot;{0}na{2}{1}&quot;-f 'sig','ures','t'

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/ps1/format.py#L11-L80" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_ps1_format(Deobfuscator):
    &#34;&#34;&#34;
    PowerShell deobfuscation for the following &#34;format string&#34;-based technique:

    - `&#34;{0}{2}{1}&#34;-f &#39;signa&#39;,&#39;ures&#39;,&#39;t&#39;`
    - `&#34;{0}na{2}{1}&#34;-f &#39;sig&#39;,&#39;ures&#39;,&#39;t&#39;`
    &#34;&#34;&#34;

    def deobfuscate(self, data):

        repeat = True

        while repeat:

            repeat = False

            for string in re.finditer(str(formats.ps1str), data):
                argmatch = re.search(R&#39;^\s*-[fF]\s*((?:{s},\s*)*{s})&#39;.format(s=formats.ps1str), data[string.end():])
                if not argmatch:
                    continue

                def dbgmsg():
                    sample = string[0]
                    if len(sample) &gt; 33:
                        sample = F&#34;{sample[1:30]}...{sample[0]}&#34;
                    return F&#39;found match at {string.start()}: {sample}&#39;

                self.log_debug(dbgmsg)

                args = re.split(F&#39;({formats.ps1str})&#39;, argmatch[1])
                args = [list(string_unquote(a.strip())) for a in args[1::2]]

                def formatter(string):
                    buffer = []
                    for k, part in enumerate(re.split(R&#39;(\{\d+\})&#39;, string)):
                        if k % 2 == 0:
                            if part:
                                buffer.append(part)
                            continue
                        try:
                            index = int(part[1:-1])
                            arg = args[index]
                        except IndexError:
                            self.log_debug(F&#39;only found {len(args)} arguments and format sequence {index}, aborting.&#39;)
                            raise

                        it = iter(arg)
                        buffer.append(next(it))

                        if len(arg) &gt; 1:
                            yield &#39;&#39;.join(buffer)
                            buffer = []
                            for last, part in lookahead(it):
                                if last:
                                    buffer.append(part)
                                    break
                                yield part

                    yield &#39;&#39;.join(buffer)

                try:
                    result = string_apply(string[0], formatter)
                except IndexError:
                    continue

                data = data[:string.start()] + result + data[argmatch.end() + string.end():]
                repeat = True
                break

        return data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_ps1_format.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.Deobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_ps1_invoke"><code class="flex name class">
<span>class <span class="ident">deob_ps1_invoke</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.ps1.invoke" href="units/obfuscation/ps1/invoke.html">refinery.units.obfuscation.ps1.invoke</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-ps1-invoke [-h] [-Q] [-0] [-v]

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/ps1/invoke.py#L9-L40" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_ps1_invoke(Deobfuscator):
    def deobfuscate(self, data):
        strlit = Ps1StringLiterals(data)

        @strlit.outside
        def invrepl1(m): return m[1] + m[3]

        data = re.sub(
            R&#39;&#39;&#39;(\.|::)&#39;&#39;&#39;                    # preceeded by dot or namespace delimiter
            R&#39;&#39;&#39;([&#39;&#34;])(\w{1,200})\2&#39;&#39;&#39;        # quoted string (actually a method name)
            R&#39;&#39;&#39;(?=[\s\(\.\,\;\+\-])&#39;&#39;&#39;,      # only if followed by certain characters
            invrepl1, data                    # remove quotes around symbol
        )

        @strlit.outside
        def invrepl2(m): return m[1] + &#39;(&#39;

        data = re.sub(
            &#39;\\s{0,5}&#39;.join([
                &#39;[.&amp;]&#39;, &#39;(\\(&#39;,               # sourcing operator
                &#39;(?:gcm|get-command)&#39;, &#39;)?&#39;,  # potentially a get-command
                &#39;([\&#39;&#34;])([-a-z]{1,100})\\2&#39;   # string enclosing a command
                &#39;(?(1)\\s{0,5}\\)|)&#39;,         # closing bracket for get-command
            ]), &#39;\\3&#39;, data, flags=re.IGNORECASE
        )
        data = re.sub(
            R&#39;&#39;&#39;(\w{1,200})\.Invoke\s*\(&#39;&#39;&#39;,
            invrepl2, data,
            flags=re.IGNORECASE
        )

        return data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_ps1_invoke.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.Deobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_ps1_literals"><code class="flex name class">
<span>class <span class="ident">deob_ps1_literals</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.ps1.literals" href="units/obfuscation/ps1/literals.html">refinery.units.obfuscation.ps1.literals</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-ps1-literals [-h] [-Q] [-0] [-v]

PowerShell deobfuscation that removes superfluous curly braces around
literals that do not require it, i.e. ${variable} is transformed to just
$variable.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/ps1/literals.py#L9-L22" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_ps1_literals(Deobfuscator):
    &#34;&#34;&#34;
    PowerShell deobfuscation that removes superfluous curly braces around
    literals that do not require it, i.e. `${variable}` is transformed to
    just `$variable`.
    &#34;&#34;&#34;

    _SENTINEL = re.compile(R&#39;\$\{(\w+)\}&#39;)

    def deobfuscate(self, data):
        strlit = Ps1StringLiterals(data)
        @strlit.outside
        def strip(m): return F&#39;${m[1]}&#39;
        return self._SENTINEL.sub(strip, data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_ps1_literals.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.Deobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_ps1_secstr"><code class="flex name class">
<span>class <span class="ident">deob_ps1_secstr</span></span>
<span>(</span><span>*a, **kw)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.ps1.securestring" href="units/obfuscation/ps1/securestring.html">refinery.units.obfuscation.ps1.securestring</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-ps1-secstr [-h] [-Q] [-0] [-v] [a [a ...]]

positional arguments:
  a

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/ps1/securestring.py#L11-L69" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_ps1_secstr(Deobfuscator):
    def __init__(self, *a, **kw):
        super().__init__(*a, **kw)

        self._pack = pack()
        self._secstr = secstr()

        self._pattern = re.compile(
            R&#39;\s{{0,20}}&#39;.join([
                R&#39;&#39;&#39;([&#39;&#34;])({b})\1&#39;&#39;&#39;,
                R&#39;\|&#39;, R&#39;\.?&#39;, R&#39;&amp;?&#39;,
                R&#39;&#39;&#39;([&#39;&#34;]?)ConvertTo-SecureString\3&#39;&#39;&#39;,
                R&#39;-ke?y?&#39;,
                R&#39;&#39;&#39;(\(?)({a}|{i}\s{{0,20}}\.\.\s{{0,20}}{i})&#39;&#39;&#39;,
                R&#39;((?:\)\s{{0,20}}){{0,10}})?&#39;
            ]).format(
                b=formats.b64,
                a=formats.intarray,
                i=formats.integer
            ),
            flags=re.IGNORECASE | re.DOTALL
        )

    def _decrypt_block(self, data, match):
        if &#39;..&#39; in match[5]:
            a, b = [int(x.strip(), 0) for x in match[5].split(&#39;..&#39;)]
            key = range(min(a, b), max(a, b) + 1)
            if a &gt; b:
                key = reversed(key)
            self._secstr.args.key = bytes(bytearray(key))
        else:
            self._secstr.args.key = self._pack(match[5].encode(self.codec))
        decoded = self._secstr(match[2].encode(self.codec))
        decoded = decoded.decode(self.codec)
        result = F&#39;\n\n{decoded}\n\n&#39;
        brackets = match[6].count(&#39;)&#39;)
        start = match.start()
        if match[4]:
            brackets -= 1
        if brackets &lt;= 0:
            if brackets &lt; 0:
                result += &#39;)&#39;
            return start, result
        while brackets:
            start -= 1
            if data[start] == &#39;(&#39;:
                brackets -= 1
            if data[start] == &#39;)&#39;:
                brackets += 1
        return start, result

    def deobfuscate(self, data):
        while True:
            match = self._pattern.search(data)
            if not match:
                break
            start, result = self._decrypt_block(data, match)
            data = data[:start] + result + data[match.end():]
        return data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_ps1_secstr.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.Deobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_ps1_stringreplace"><code class="flex name class">
<span>class <span class="ident">deob_ps1_stringreplace</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.ps1.stringreplace" href="units/obfuscation/ps1/stringreplace.html">refinery.units.obfuscation.ps1.stringreplace</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-ps1-stringreplace [-h] [-Q] [-0] [-v]

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/ps1/stringreplace.py#L11-L88" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_ps1_stringreplace(Deobfuscator):

    _SENTINEL = re.compile((
        R&#39;(?i)[\&#39;&#34;]\s*&#39;               # end of haystack string
        R&#39;(-c|-i|-|\.)replace&#39;        # the replace call
        R&#39;([\(\s]*)({s})([\)\s]*),&#39;   # needle (with brackets)
        R&#39;([\(\s]*)({s})([\)\s]*)&#39;    # insert (with brackets)
    ).format(s=formats.ps1str), flags=re.IGNORECASE)

    def deobfuscate(self, data):
        repeat = True
        strlit = Ps1StringLiterals(data)

        while repeat:
            repeat = False
            needle = None

            for match in self._SENTINEL.finditer(data):
                for check in re.finditer(R&#39;(?i)(-c|-i|-|\.)replace&#39;, data):
                    if check.start() in strlit:
                        break
                if check.start() &lt; match.start():
                    break
                k = strlit.get_container(match.start())
                if k is None:
                    break
                offset, end = strlit.ranges[k]
                if match.start() != end - 1:
                    break
                string = data[offset:end]
                pf, bl1, needle, bl2, br1, insert, br2 = match.groups()
                end = match.end()
                case = &#39;&#39; if pf[0] in &#39;.c&#39; else &#39;(?i)&#39;
                bl = bl1.count(&#39;(&#39;) - bl2.count(&#39;)&#39;)
                br = br2.count(&#39;)&#39;) - br1.count(&#39;(&#39;)
                if pf[0] == &#39;.&#39;:
                    bl -= 1
                    br -= 1
                if bl != 0 or br &lt; 0:
                    break
                needle = list(string_unquote(needle))
                if len(needle) &gt; 1:
                    break

                needle = needle[0]
                head, *body = string_unquote(insert)

                self.log_info(&#39;replacing&#39;, needle, &#39;by&#39;, insert)

                if not body:
                    def perform_replacement(string):
                        return re.sub(F&#39;{case}{re.escape(needle)}&#39;, lambda _: head, string)
                else:
                    *body, tail = body
                    def perform_replacement(string): # noqa
                        parts = re.split(F&#39;{case}{re.escape(needle)}&#39;, string)
                        if len(parts) == 1:
                            yield string
                            return
                        it = iter(parts)
                        yield next(it) + head
                        yield from body
                        for last, part in lookahead(it):
                            if last:
                                yield tail + part
                            else:
                                yield tail + part + head
                                yield from body

                replaced = string_apply(string, perform_replacement) + (br * &#39;)&#39;)
                strlit.ranges[k] = offset, offset + len(replaced) - br
                strlit.ranges[k + 1: k + 3] = []
                strlit.shift(len(replaced) + offset - end, k + 1)
                data = data[:offset] + replaced + data[end:]
                repeat = True
                break

        return data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_ps1_stringreplace.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.Deobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_ps1_typecast"><code class="flex name class">
<span>class <span class="ident">deob_ps1_typecast</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.ps1.typecast" href="units/obfuscation/ps1/typecast.html">refinery.units.obfuscation.ps1.typecast</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-ps1-typecast [-h] [-Q] [-0] [-v]

Replaces sequences like [Char]120 to their string representation, in this
case the string &quot;x&quot;.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/ps1/typecast.py#L11-L68" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_ps1_typecast(Deobfuscator):
    &#34;&#34;&#34;
    Replaces sequences like [Char]120 to their string representation, in this
    case the string &#34;x&#34;.
    &#34;&#34;&#34;

    def deobfuscate(self, data):
        strlit = Ps1StringLiterals(data)

        @strlit.outside
        def strip_typecast(m): return m[1]

        data = re.sub(
            FR&#39;\[(?:string|char\[\])\]\s*({formats.ps1str!s})&#39;,
            strip_typecast,
            data,
            flags=re.IGNORECASE
        )

        @strlit.outside
        def char_literal(match):
            c = chr(int(match[1]))
            if c == &#34;&#39;&#34;:
                return &#39;&#39;&#39;&#34;&#39;&#34;&#39;&#39;&#39;
            return F&#34;&#39;{c}&#39;&#34;

        data = re.sub(
            R&#39;\[char\]\s*0*(0x[0-9a-f]+|\d+)&#39;,
            char_literal,
            data,
            flags=re.IGNORECASE
        )

        def char_array(match):
            result = bytes(int(x, 0) for x in match[1].split(&#39;,&#39;))
            try:
                result = result.decode(&#39;ascii&#39;)
                if not all(x in string.printable or x.isspace() for x in result):
                    raise ValueError
            except ValueError:
                return match[0]
            else:
                return string_quote(result)

        data = re.sub(
            R&#39;\s*&#39;.join([
                R&#39;\[char\[\]\]&#39;,
                R&#39;\((&#39;,
                R&#39;(?:\s*(?:0x[0-9a-f]+|\d+)\s*,)+&#39;,
                R&#39;(?:0x[0-9a-f]+|\d+)&#39;,
                R&#39;)\)&#39;
            ]),
            char_array,
            data,
            flags=re.IGNORECASE
        )

        return data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_ps1_typecast.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.Deobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_vba_arithmetic"><code class="flex name class">
<span>class <span class="ident">deob_vba_arithmetic</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.vba.arithmetic" href="units/obfuscation/vba/arithmetic.html">refinery.units.obfuscation.vba.arithmetic</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-vba-arithmetic [-h] [-Q] [-0] [-v]

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/vba/arithmetic.py#L10-L42" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_vba_arithmetic(Deobfuscator):
    def deobfuscate(self, data):

        def evaluate(match):
            match = match[0]
            expr = match.strip()
            brackets = 0
            for end, character in enumerate(expr):
                if character == &#39;(&#39;:
                    brackets += 1
                    continue
                if character == &#39;)&#39;:
                    brackets -= 1
                    if brackets &lt; 0:
                        expr, tail = expr[:end], expr[end:]
                        break
            else:
                tail = &#39;&#39;
            if expr.isdigit() or brackets &gt; 0:
                return match
            if self.log_debug(&#39;evaluating&#39;, expr):
                evaluator = cautious_eval
            else:
                def evaluator(e): return cautious_eval_or_default(e, e)
            result = str(evaluator(expr)) + self.deobfuscate(tail)
            if expr.startswith(&#39;(&#39;) and expr.endswith(&#39;)&#39;):
                result = F&#39;({result})&#39;
            return result

        pattern = re.compile(R&#39;(?:{i}|{f}|[-+(])(?:[^\S\r\n]{{0,20}}(?:{i}|{f}|[-%|&amp;~&lt;&gt;()+/*^]))+&#39;.format(
            i=str(formats.integer), f=str(formats.float)))

        return pattern.sub(evaluate, data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_vba_arithmetic.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.Deobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_vba_comments"><code class="flex name class">
<span>class <span class="ident">deob_vba_comments</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.vba.comments" href="units/obfuscation/vba/comments.html">refinery.units.obfuscation.vba.comments</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-vba-comments [-h] [-Q] [-0] [-v]

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/vba/comments.py#L8-L15" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_vba_comments(Deobfuscator):
    def deobfuscate(self, data):
        return re.sub(
            R&#34;^\s{0,20}(?:&#39;|rem\b|dim\b).*$\n\r?&#34;,
            &#39;&#39;,
            data,
            flags=re.MULTILINE | re.IGNORECASE
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_vba_comments.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.Deobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_vba_constants"><code class="flex name class">
<span>class <span class="ident">deob_vba_constants</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.vba.constants" href="units/obfuscation/vba/constants.html">refinery.units.obfuscation.vba.constants</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-vba-constants [-h] [-Q] [-0] [-v]

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/vba/constants.py#L8-L24" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_vba_constants(Deobfuscator):
    def deobfuscate(self, data):
        def extract_constants(lines):
            for line in lines:
                match = re.match(R&#39;(?i)^\s*const\s*(\w+)\s*=\s*(.*?)(?:\&#39;|rem|$)&#39;, line)
                if match is None:
                    yield line
                    continue
                constants[match[1]] = match[2]
                self.log_debug(F&#39;const {match[1]} = {match[2]}&#39;)

        constants = {}
        data = &#39;\n&#39;.join(extract_constants(data.splitlines(keepends=False)))
        for name, value in constants.items():
            data = re.sub(RF&#39;\b{re.escape(name)!s}\b&#39;, value, data)

        return data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_vba_constants.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.Deobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_vba_dummy_variables"><code class="flex name class">
<span>class <span class="ident">deob_vba_dummy_variables</span></span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.vba.dummies" href="units/obfuscation/vba/dummies.html">refinery.units.obfuscation.vba.dummies</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-vba-dummy-variables [-h] [-Q] [-0] [-v]

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/vba/dummies.py#L10-L55" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_vba_dummy_variables(Deobfuscator):
    def deobfuscate(self, data):
        lines = data.splitlines(keepends=False)
        names = collections.defaultdict(list)

        def might_be_used_in(name, line):
            # avoid finding the name within a string literal
            line = &#39;&#34;&#34;&#39;.join(re.split(str(formats.ps1str), line))
            line = re.split(RF&#39;\b{name}\b&#39;, line)
            try:
                L, R = line
            except ValueError:
                return False
            L = L.strip().lower()
            if L.startswith(&#34;&#39;&#34;) or L.startswith(&#39;rem&#39;):
                return False
            R = R.strip().lower()
            if R.startswith(&#39;=&#39;) and &#39;if&#39; not in L:
                return False
            if L.startswith(&#39;dim&#39;):
                return False
            return True

        pattern = re.compile(
            R&#39;^\s{0,8}(?:const\s{1,8})?(\w+)\s{1,8}=\s{1,8}.*$&#39;,
            flags=re.IGNORECASE
        )

        for k, line in enumerate(lines):
            try:
                name = pattern.match(line)[1]
            except (AttributeError, TypeError):
                continue
            names[name].append(k)

        for line in lines:
            while True:
                for name in names:
                    if might_be_used_in(name, line):
                        del names[name]
                        break
                else:
                    break

        return &#39;\n&#39;.join(line for k, line in enumerate(lines) if not any(
            k in rows for rows in names.values()))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_vba_dummy_variables.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.obfuscation.Deobfuscator" href="units/obfuscation/index.html#refinery.units.obfuscation.Deobfuscator">Deobfuscator</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.obfuscation.Deobfuscator.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.obfuscation.Deobfuscator.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.deob_vba_chr_literals"><code class="flex name class">
<span>class <span class="ident">deob_vba_chr_literals</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.obfuscation.vba.vba" href="units/obfuscation/vba/vba.html">refinery.units.obfuscation.vba.vba</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: deob-vba-chr-literals [-h] [-Q] [-0] [-v]

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/obfuscation/vba/vba.py#L8-L17" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class deob_vba_chr_literals(Unit):
    def process(self, data):
        def _chr(m):
            code = int(m[1], 0)
            if code == 34:
                return B&#39;&#34;&#34;&#34;&#34;&#39;
            return B&#39;&#34;%s&#34;&#39; % chr(code).encode(&#39;unicode_escape&#39;)
        data = re.sub(BR&#39;Chr\((\d+x?\d+)\)&#39;, _chr, data, flags=re.IGNORECASE)
        data = re.sub(BR&#39;&#34;\s*\&amp;\s*&#34;&#39;, B&#39;&#39;, data)
        return data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.deob_vba_chr_literals.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.carve"><code class="flex name class">
<span>class <span class="ident">carve</span></span>
<span>(</span><span>format, decode=False, single=False, min=1, max=None, len=None, stripspace=False, unique=False, longest=False, take=None, utf16=True, ascii=True)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.pattern.carve" href="units/pattern/carve.html">refinery.units.pattern.carve</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: carve [-h] [-Z] [-Q] [-0] [-v] [-d] [-s] [-n N] [-N N] [-E N] [-S]
             [-q] [-l] [-t N] [-a | -u]
             format

Extracts patches of data in particular formats from the input.

positional arguments:
  format            Specify one of the following formats: integer, float,
                    string, cmdstr, ps1str, printable, intarray, word,
                    alph, vbe, anum, b64, b64u, hex, HEX, hexdump,
                    hexarray

optional arguments:
  -d, --decode      Automatically decode known patterns.
  -s, --single      Only get the biggest match; equivalent to -qlt1
  -n, --min N       Matches must have length at least N.
  -N, --max N       Matches must have length at most N.
  -E, --len N       Matches must be of length N.
  -S, --stripspace  Strip all whitespace from input data.
  -q, --unique      Yield every (transformed) Match only once.
  -l, --longest     Sort results by length.
  -t, --take N      Return only the first N occurrences in order of
                    appearance.
  -a, --no-utf16    Search for ASCII encoded patterns only.
  -u, --no-ascii    Search for UTF16 encoded patterns only.

generic options:
  -h, --help        Show this help message and exit.
  -Z, --squeeze     Fuse outputs, do not insert line breaks.
  -Q, --quiet       Disables all log output.
  -0, --devnull     Do not produce any output.
  -v, --verbose     Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/carve.py#L7-L69" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class carve(PatternExtractor):
    &#34;&#34;&#34;
    Extracts patches of data in particular formats from the input.
    &#34;&#34;&#34;
    def __init__(
        self, format: arg.choice(choices=[p.name for p in formats], metavar=&#39;format&#39;,
            help=&#39;Specify one of the following formats: {choices}&#39;),
        decode: arg.switch(&#39;-d&#39;, help=&#39;Automatically decode known patterns.&#39;) = False,
        single: arg.switch(&#39;-s&#39;, help=&#39;Only get the biggest match; equivalent to -qlt1&#39;) = False,
        min=1, max=None, len=None,
        stripspace=False, unique=False, longest=False, take=None, utf16=True, ascii=True
    ):
        if single:
            take = 1        # noqa warning about unused variable
            longest = True  # noqa warning about unused variable
            unique = True   # noqa warning about unused variable
        del single
        self.superinit(super(), **vars())
        self.args.format = formats[format]
        if not decode:
            decoder = NotImplemented
        elif self.args.format is formats.string:
            def decoder(chunk):
                return decoder.unesc(chunk[1:-1])
            from ..encoding.esc import esc
            decoder.unesc = esc()
        elif self.args.format in (formats.HEX, formats.hex):
            from ..encoding.hex import hex
            decoder = hex()
        elif self.args.format is formats.hexdump:
            from ..blockwise.pack import pack
            decoder = pack(0x10, hexdump=True)
        elif self.args.format is formats.intarray:
            from ..blockwise.pack import pack
            decoder = pack()
        elif self.args.format is formats.b64:
            from ..encoding.b64 import b64
            decoder = b64()
        elif self.args.format is formats.b64u:
            from ..encoding.b64 import b64
            decoder = b64(urlsafe=True)
        elif self.args.format is formats.ps1str:
            from ..encoding.ps1str import ps1str
            decoder = ps1str()
        elif self.args.format is formats.hexarray:
            from ..blockwise.pack import pack
            decoder = pack(0x10)
        elif self.args.format is formats.vbe:
            from ..encoding.vbe import vbe
            decoder = vbe()
        else:
            decoder = NotImplemented
        self.decoder = decoder

    def process(self, data):
        it = iter(self.matches_filtered(memoryview(data), bytes(self.args.format)))
        if self.decoder is NotImplemented:
            yield from it
        for chunk in it:
            try:
                yield self.decoder(chunk)
            except Exception as E:
                self.log_info(F&#39;decoder failure: {E!s}&#39;)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.pattern.PatternExtractor" href="units/pattern/index.html#refinery.units.pattern.PatternExtractor">PatternExtractor</a></li>
<li><a title="refinery.units.pattern.PatternExtractorBase" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase">PatternExtractorBase</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="refinery.units.shortcuts.carveb64z.carveb64z" href="units/shortcuts/carveb64z.html#refinery.units.shortcuts.carveb64z.carveb64z">carveb64z</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.carve.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.pattern.PatternExtractor" href="units/pattern/index.html#refinery.units.pattern.PatternExtractor">PatternExtractor</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.pattern.PatternExtractor.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.matches" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase.matches">matches</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.matches_filtered" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase.matches_filtered">matches_filtered</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.carve_json"><code class="flex name class">
<span>class <span class="ident">carve_json</span></span>
<span>(</span><span>dictonly=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.pattern.carve_json" href="units/pattern/carve_json.html">refinery.units.pattern.carve_json</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: carve-json [-h] [-Z] [-Q] [-0] [-v] [-d]

Extracts anything from the input data that looks like JSON.

optional arguments:
  -d, --dictonly  only extract JSON dictionaries, do not extract lists.

generic options:
  -h, --help      Show this help message and exit.
  -Z, --squeeze   Fuse outputs, do not insert line breaks.
  -Q, --quiet     Disables all log output.
  -0, --devnull   Do not produce any output.
  -v, --verbose   Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/carve_json.py#L82-L90" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class carve_json(Unit):
    &#34;&#34;&#34;
    Extracts anything from the input data that looks like JSON.
    &#34;&#34;&#34;
    def __init__(self, dictonly: arg.switch(&#39;-d&#39;, help=&#39;only extract JSON dictionaries, do not extract lists.&#39;) = False):
        super().__init__(dictonly=dictonly)

    def process(self, data):
        yield from JSONCarver(data, dictonly=self.args.dictonly)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.carve_json.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.carve_pe"><code class="flex name class">
<span>class <span class="ident">carve_pe</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.pattern.carve_pe" href="units/pattern/carve_pe.html">refinery.units.pattern.carve_pe</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: carve-pe [-h] [-Z] [-Q] [-0] [-v]

Extracts anything from the input data that looks like a Portable
Executable (PE) file.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/carve_pe.py#L10-L32" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class carve_pe(Unit):
    &#34;&#34;&#34;
    Extracts anything from the input data that looks like a Portable
    Executable (PE) file.
    &#34;&#34;&#34;
    def process(self, data):
        cursor = 0
        while True:
            p = data.find(B&#39;MZ&#39;, cursor)
            if p &lt; cursor: break
            cursor = p + 2
            k, = unpack(&#39;H&#39;, data[p + 0x3C:p + 0x3E])
            if data[p + k:p + k + 2] != B&#39;PE&#39;:
                continue
            try:
                pe = PE(data=data[p:])
            except PEFormatError as err:
                self.log_debug(&#39;parsing of PE header at 0x{p:08X} failed:&#39;, err)
                continue
            pesize = get_pe_size(pe)
            self.log_info(F&#39;extracted PE file of size 0x{pesize:08X} from 0x{p:08X}&#39;)
            yield data[p:p + pesize]
            cursor = pe.OPTIONAL_HEADER.SizeOfHeaders + p</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.carve_pe.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.carve_xml"><code class="flex name class">
<span>class <span class="ident">carve_xml</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.pattern.carve_xml" href="units/pattern/carve_xml.html">refinery.units.pattern.carve_xml</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: carve-xml [-h] [-Z] [-Q] [-0] [-v]

Extracts anything from the input data that looks like XML.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/carve_xml.py#L121-L127" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class carve_xml(Unit):
    &#34;&#34;&#34;
    Extracts anything from the input data that looks like XML.
    &#34;&#34;&#34;

    def process(self, data):
        yield from XMLCarver(data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.carve_xml.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.carve_zip"><code class="flex name class">
<span>class <span class="ident">carve_zip</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.pattern.carve_zip" href="units/pattern/carve_zip.html">refinery.units.pattern.carve_zip</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: carve-zip [-h] [-Z] [-Q] [-0] [-v]

Extracts anything from the input data that looks like a zip archive file.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/carve_zip.py#L8-L35" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class carve_zip(Unit):
    &#34;&#34;&#34;
    Extracts anything from the input data that looks like a zip archive file.
    &#34;&#34;&#34;

    def process(self, data):

        def carve(start):
            end = start
            while end &lt;= start:
                end = data.find(B&#39;PK\x05\x06&#39;, end + 4)
                if end &lt; 0:
                    return None
                size, offset = unpack(&#39;&lt;LL&#39;, data[end + 12 : end + 20])
                if offset + start + size == end:
                    return end + 22

        cursor = 0

        while True:
            start = data.find(B&#39;PK&#39;, cursor)
            if start &lt; cursor:
                break
            end = carve(start)
            if end is None:
                break
            yield data[start:end]
            cursor = end</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.carve_zip.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.defang"><code class="flex name class">
<span>class <span class="ident">defang</span></span>
<span>(</span><span>url_only=False, dot_only=False, quote_md=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.pattern.defang" href="units/pattern/defang.html">refinery.units.pattern.defang</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: defang [-h] [-R] [-Q] [-0] [-v] [-u] [-d] [-q]

Defangs all domains and ipv4 addresses in the input data by replacing the
last dot in the expression by [.]. For example, 127.0.0.1 will be replaced
by 127.0.0[.]1.

optional arguments:
  -u, --url-only  Only defang URLs, do not look for domains or IPs.
  -d, --dot-only  Do not escape the protocol colon in URLs.
  -q, --quote-md  Wrap all indicators in backticks for markdown code.

generic options:
  -h, --help      Show this help message and exit.
  -R, --reverse   Use the reverse operation.
  -Q, --quiet     Disables all log output.
  -0, --devnull   Do not produce any output.
  -v, --verbose   Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/defang.py#L9-L68" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class defang(Unit):
    &#34;&#34;&#34;
    Defangs all domains and ipv4 addresses in the input data by replacing the last dot in the
    expression by `[.]`. For example, `127.0.0.1` will be replaced by `127.0.0[.]1`.
    &#34;&#34;&#34;

    WHITELIST = [
        B&#39;wscript.shell&#39;,
    ]

    def __init__(
        self,
        url_only: arg.switch(&#39;-u&#39;, help=&#39;Only defang URLs, do not look for domains or IPs.&#39;) = False,
        dot_only: arg.switch(&#39;-d&#39;, help=&#39;Do not escape the protocol colon in URLs.&#39;) = False,
        quote_md: arg.switch(&#39;-q&#39;, help=&#39;Wrap all indicators in backticks for markdown code.&#39;) = False
    ):
        self.superinit(super(), **vars())

    def _quote(self, word):
        return word if not self.args.quote_md else B&#39;`%s`&#39; % word

    def reverse(self, data):
        def refang(hostname):
            return hostname[0].replace(B&#39;[.]&#39;, B&#39;.&#39;)
        data = defanged.hostname.sub(refang, data)
        data = data.replace(B&#39;[:]//&#39;, B&#39;://&#39;)
        data = re.sub(B&#39;hxxp(s?)://&#39;, B&#39;http\\1://&#39;, data)
        return data

    def process(self, data):
        def replace_hostname(hostname, match=True):
            if match:
                return self._quote(replace_hostname(hostname[0], False))
            self.log_info(&#39;replace:&#39;, hostname)
            host = hostname.rsplit(B&#39;:&#39;)[0].lower()
            if host in self.WHITELIST:
                return hostname
            return B&#39;[.]&#39;.join(hostname.rsplit(B&#39;.&#39;, 1))

        def replace_url(url):
            if not url:
                return url
            sep = B&#39;://&#39; if self.args.dot_only else B&#39;[:]//&#39;
            self.log_info(&#39;replace:&#39;, url)
            p, q = url.split(B&#39;://&#39;)
            q = q.split(B&#39;/&#39;, 1)
            q[0] = replace_hostname(q[0], False)
            q = B&#39;/&#39;.join(q)
            return self._quote(p + sep + q)

        analyze = indicators.url.split(data)
        analyze[1::2] = [replace_url(t) for t in analyze[1::2]]

        if not self.args.url_only:
            analyze[0::2] = [
                indicators.hostname.sub(replace_hostname, t)
                for t in analyze[0::2]
            ]

        return B&#39;&#39;.join(analyze)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.defang.WHITELIST"><code class="name">var <span class="ident">WHITELIST</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.defang.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.dnsdomain"><code class="flex name class">
<span>class <span class="ident">dnsdomain</span></span>
<span>(</span><span>min=1, max=None, len=None, stripspace=False, unique=False, longest=False, take=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.pattern.dnsdomain" href="units/pattern/dnsdomain.html">refinery.units.pattern.dnsdomain</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: dnsdomain [-h] [-Z] [-Q] [-0] [-v] [-n N] [-N N] [-E N] [-S] [-q]
                 [-l] [-t N]

Extracts domain names in the format as they appear in DNS requests. This
can be used as a quick and dirty way to extract domains from PCAP files,
for example.

optional arguments:
  -n, --min N       Matches must have length at least N.
  -N, --max N       Matches must have length at most N.
  -E, --len N       Matches must be of length N.
  -S, --stripspace  Strip all whitespace from input data.
  -q, --unique      Yield every (transformed) Match only once.
  -l, --longest     Sort results by length.
  -t, --take N      Return only the first N occurrences in order of
                    appearance.

generic options:
  -h, --help        Show this help message and exit.
  -Z, --squeeze     Fuse outputs, do not insert line breaks.
  -Q, --quiet       Disables all log output.
  -0, --devnull     Do not produce any output.
  -v, --verbose     Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/dnsdomain.py#L13-L43" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class dnsdomain(PatternExtractorBase):
    &#34;&#34;&#34;
    Extracts domain names in the format as they appear in DNS requests. This
    can be used as a quick and dirty way to extract domains from PCAP files,
    for example.
    &#34;&#34;&#34;

    _DOMAIN_CHARACTERS = (
        B&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;
        B&#39;abcdefghijklmnopqrstuvwxyz&#39;
        B&#39;0123456789-_&#39;
    )

    _DOMAIN_PATTERN = BR&#39;(?:%s){1,20}(?:%s)\b&#39; % (_lps(0xFF), _lps(25))

    def process(self, data):

        def transform(match):
            match = bytearray(match[0])
            pos = 0
            while pos &lt; len(match):
                length = match[pos]
                match[pos] = 0x2E
                if len(match) &lt; length + pos:
                    return None
                if any(x not in self._DOMAIN_CHARACTERS for x in match[pos + 1 : pos + length]):
                    return None
                pos += 1 + length
            return match[1:]

        yield from self.matches_filtered(memoryview(data), self._DOMAIN_PATTERN, transform)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.pattern.PatternExtractorBase" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase">PatternExtractorBase</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.dnsdomain.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.pattern.PatternExtractorBase" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase">PatternExtractorBase</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.pattern.PatternExtractorBase.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.matches" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase.matches">matches</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.matches_filtered" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase.matches_filtered">matches_filtered</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.mimewords"><code class="flex name class">
<span>class <span class="ident">mimewords</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.pattern.mimewords" href="units/pattern/mimewords.html">refinery.units.pattern.mimewords</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: mimewords [-h] [-Q] [-0] [-v]

Implements the decoding of MIME encoded-word syntax from RFC-2047.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/mimewords.py#L12-L24" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class mimewords(Unit):
    &#34;&#34;&#34;
    Implements the decoding of MIME encoded-word syntax from RFC-2047.
    &#34;&#34;&#34;

    @unicoded
    def process(self, data: str) -&gt; str:
        def replacer(match):
            self.log_info(&#39;encoded mime word:&#39;, match[0])
            decoded, = decode_header(match[0])
            raw, codec = decoded
            return codecs.decode(raw, codec, errors=&#39;surrogateescape&#39;)
        return re.sub(R&#34;=(?:\?[^\?]*){3}\?=&#34;, replacer, data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.mimewords.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.resplit"><code class="flex name class">
<span>class <span class="ident">resplit</span></span>
<span>(</span><span>regex=b'\\r?\\n', multiline=False, ignorecase=False, min=1, max=None, len=None, stripspace=False, unique=False, longest=False, take=None, utf16=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.pattern.resplit" href="units/pattern/resplit.html">refinery.units.pattern.resplit</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: resplit [-h] [-Z] [-Q] [-0] [-v] [-M] [-I] [-n N] [-N N] [-E N]
               [-S] [-q] [-l] [-t N] [-u]
               [regex]

Splits the data at the given regular expression and returns the sequence
of chunks between the separators. By default, the input is split along
line breaks.

positional arguments:
  regex             Regular expression to match.

optional arguments:
  -M, --multiline   Caret and dollar match the beginning and end of a
                    line, a dot does not match line breaks.
  -I, --ignorecase  Ignore capitalization for alphabetic characters.
  -n, --min N       Matches must have length at least N.
  -N, --max N       Matches must have length at most N.
  -E, --len N       Matches must be of length N.
  -S, --stripspace  Strip all whitespace from input data.
  -q, --unique      Yield every (transformed) Match only once.
  -l, --longest     Sort results by length.
  -t, --take N      Return only the first N occurrences in order of
                    appearance.
  -u, --utf16       Search for unicode patterns instead of ascii.

generic options:
  -h, --help        Show this help message and exit.
  -Z, --squeeze     Fuse outputs, do not insert line breaks.
  -Q, --quiet       Disables all log output.
  -0, --devnull     Do not produce any output.
  -v, --verbose     Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/resplit.py#L8-L34" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class resplit(RegexUnit):
    &#34;&#34;&#34;
    Splits the data at the given regular expression and returns the sequence of
    chunks between the separators. By default, the input is split along line breaks.
    &#34;&#34;&#34;

    def __init__(
        self, regex=RB&#39;\r?\n&#39;,
        # TODO: Use positional only in Python 3.8
        # /,
        multiline=False, ignorecase=False, min=1, max=None, len=None, stripspace=False,
        unique=False, longest=False, take=None, utf16=False
    ):
        super().__init__(
            regex,
            min=min,
            max=max,
            len=len,
            stripspace=stripspace,
            unique=unique,
            utf16=utf16,
            longest=longest,
            take=take
        )

    def process(self, data):
        yield from re.split(self.args.regex, data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.pattern.RegexUnit" href="units/pattern/index.html#refinery.units.pattern.RegexUnit">RegexUnit</a></li>
<li><a title="refinery.units.pattern.PatternExtractorBase" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase">PatternExtractorBase</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.resplit.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.pattern.RegexUnit" href="units/pattern/index.html#refinery.units.pattern.RegexUnit">RegexUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.pattern.RegexUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.matches" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase.matches">matches</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.matches_filtered" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase.matches_filtered">matches_filtered</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.resub"><code class="flex name class">
<span>class <span class="ident">resub</span></span>
<span>(</span><span>regex, subst=b'', multiline=False, ignorecase=False, min=1, max=None, len=None, stripspace=False, unique=False, longest=False, take=None, utf16=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.pattern.resub" href="units/pattern/resub.html">refinery.units.pattern.resub</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: resub [-h] [-Q] [-0] [-v] [-M] [-I] [-n N] [-N N] [-E N] [-S] [-q]
             [-l] [-t N] [-u]
             regex [subst]

A unit for performing substitutions based on a binary regular expression
pattern. Besides the usual syntax $k to insert the k-th match group, the
unit supports processing the contents of match groups with arbitrary
refinery units (see TransformSubstitutionFactory).

positional arguments:
  regex             Regular expression to match.
  subst             Substitution value: use $1 for group 1, $0 for entire
                    match. Matches are removed (replaced by an empty
                    string) by default.

optional arguments:
  -M, --multiline   Caret and dollar match the beginning and end of a
                    line, a dot does not match line breaks.
  -I, --ignorecase  Ignore capitalization for alphabetic characters.
  -n, --min N       Matches must have length at least N.
  -N, --max N       Matches must have length at most N.
  -E, --len N       Matches must be of length N.
  -S, --stripspace  Strip all whitespace from input data.
  -q, --unique      Yield every (transformed) Match only once.
  -l, --longest     Sort results by length.
  -t, --take N      Return only the first N occurrences in order of
                    appearance.
  -u, --utf16       Search for unicode patterns instead of ascii.

generic options:
  -h, --help        Show this help message and exit.
  -Q, --quiet       Disables all log output.
  -0, --devnull     Do not produce any output.
  -v, --verbose     Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/resub.py#L9-L32" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class resub(RegexUnit):
    &#34;&#34;&#34;
    A unit for performing substitutions based on a binary regular expression
    pattern. Besides the usual syntax `$k` to insert the `k`-th match group,
    the unit supports processing the contents of match groups with arbitrary
    refinery units (see `refinery.units.pattern.TransformSubstitutionFactory`).
    &#34;&#34;&#34;
    def __init__(self, regex,
        subst: arg(&#39;subst&#39;, type=utf8, help=(
            &#39;Substitution value: use $1 for group 1, $0 for entire match. &#39;
            &#39;Matches are removed (replaced by an empty string) by default.&#39;
        )) = B&#39;&#39;,
        # TODO: Use positional only in Python 3.8
        # /,
        multiline=False, ignorecase=False, min=1, max=None, len=None,
        stripspace=False, unique=False, longest=False, take=None, utf16=False
    ):
        self.superinit(super(), **vars())
        self.args.subst = subst

    def process(self, data):
        self.log_info(&#39;pattern:&#39;, self.args.regex)
        self.log_info(&#39;replace:&#39;, self.args.subst)
        return re.sub(self.args.regex, TransformSubstitutionFactory(self.args.subst), data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.pattern.RegexUnit" href="units/pattern/index.html#refinery.units.pattern.RegexUnit">RegexUnit</a></li>
<li><a title="refinery.units.pattern.PatternExtractorBase" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase">PatternExtractorBase</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.resub.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.pattern.RegexUnit" href="units/pattern/index.html#refinery.units.pattern.RegexUnit">RegexUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.pattern.RegexUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.matches" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase.matches">matches</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.matches_filtered" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase.matches_filtered">matches_filtered</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.rex"><code class="flex name class">
<span>class <span class="ident">rex</span></span>
<span>(</span><span>regex, *transformation, multiline=False, ignorecase=False, min=1, max=None, len=None, stripspace=False, unique=False, longest=False, take=None, utf16=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.pattern.rex" href="units/pattern/rex.html">refinery.units.pattern.rex</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: rex [-h] [-Z] [-Q] [-0] [-v] [-M] [-I] [-n N] [-N N] [-E N] [-S]
           [-q] [-l] [-t N] [-u]
           regex [transformation [transformation ...]]

A binary grep which can apply a transformation to each match. Each match
is an individual output and standard forking settings apply. Two
additional special multibin handlers are available for regular
expressions:

positional arguments:
  regex             Regular expression to match.
  transformation    An optional sequence of transformations to be applied
                    to each match. Each transformation produces one output
                    in the order in which they are given. The default
                    transformation is $0, i.e. the entire match.

optional arguments:
  -M, --multiline   Caret and dollar match the beginning and end of a
                    line, a dot does not match line breaks.
  -I, --ignorecase  Ignore capitalization for alphabetic characters.
  -n, --min N       Matches must have length at least N.
  -N, --max N       Matches must have length at most N.
  -E, --len N       Matches must be of length N.
  -S, --stripspace  Strip all whitespace from input data.
  -q, --unique      Yield every (transformed) Match only once.
  -l, --longest     Sort results by length.
  -t, --take N      Return only the first N occurrences in order of
                    appearance.
  -u, --utf16       Search for unicode patterns instead of ascii.

generic options:
  -h, --help        Show this help message and exit.
  -Z, --squeeze     Fuse outputs, do not insert line breaks.
  -Q, --quiet       Disables all log output.
  -0, --devnull     Do not produce any output.
  -v, --verbose     Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/rex.py#L7-L47" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class rex(RegexUnit):
    &#34;&#34;&#34;
    A binary grep which can apply a transformation to each match. Each match is an
    individual output and standard forking settings apply. Two additional special
    multibin handlers are available for regular expressions:
    &#34;&#34;&#34;
    @staticmethod
    def _xmeta(t):
        def meta_transform(match):
            meta = match.groupdict()
            data = t(match) if callable(t) else t
            meta.update(data=data)
            return meta
        return meta_transform

    def __init__(self, regex,
        # TODO: Use positional only in Python 3.8
        # /,
        *transformation: arg(type=utf8, help=(
            &#39;An optional sequence of transformations to be applied to each match. &#39;
            &#39;Each transformation produces one output in the order in which they   &#39;
            &#39;are given. The default transformation is $0, i.e. the entire match.  &#39;
        )),
        multiline=False, ignorecase=False, min=1, max=None, len=None, stripspace=False,
        unique=False, longest=False, take=None, utf16=False
    ):
        self.superinit(super(), **vars())
        self.args.transforms = [
            self._xmeta(TransformSubstitutionFactory(t))
            for t in transformation
        ]
        if not self.args.transforms:
            self.args.transforms.append(self._xmeta(lambda m: m[0]))

    def process(self, data):
        self.log_debug(&#39;regular expression:&#39;, self.args.regex)
        yield from self.matches_filtered(
            memoryview(data),
            self.args.regex,
            *self.args.transforms
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.pattern.RegexUnit" href="units/pattern/index.html#refinery.units.pattern.RegexUnit">RegexUnit</a></li>
<li><a title="refinery.units.pattern.PatternExtractorBase" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase">PatternExtractorBase</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.rex.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.pattern.RegexUnit" href="units/pattern/index.html#refinery.units.pattern.RegexUnit">RegexUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.pattern.RegexUnit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.matches" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase.matches">matches</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.matches_filtered" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase.matches_filtered">matches_filtered</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.urlguards"><code class="flex name class">
<span>class <span class="ident">urlguards</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.pattern.urlguards" href="units/pattern/urlguards.html">refinery.units.pattern.urlguards</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: urlguards [-h] [-Q] [-0] [-v]

Restores the original URLs from their 'protected' versions as generated by
Outlook protection and ProofPoint.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/urlguards.py#L22-L118" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class urlguards(Unit):
    &#34;&#34;&#34;
    Restores the original URLs from their &#39;protected&#39; versions as generated by
    Outlook protection and ProofPoint.
    &#34;&#34;&#34;

    _PP3RLENC = {
        letter: rl for rl, letter in enumerate(
            &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;
            &#39;abcdefghijklmnopqrstuvwxyz&#39;
            &#39;0123456789-_&#39;, 2
        )
    }

    @unguard(r&#39;https?://urldefense(?:\.proofpoint)?\.com/v([12])/url\?([:;/_=!?#&amp;.,\w\%\-\+|]+)&#39;)
    def proofpointV2(self, match):
        version = int(match[1])
        self.log_info(&#39;proofpoint match:&#39;, version)
        argmatch = re.match(
            R&#39;^u=(.+?)&amp;(?:amp;)?{}=&#39;.format(&#39;k&#39; if version == 1 else &#39;[dc]&#39;),
            match[2],
            flags=re.DOTALL
        )
        if not argmatch:
            self.log_warn(&#39;not able to translate unexpected proofpoint format:&#39;, match)
            return match[0]
        encoded = argmatch[1]
        if match[1] == &#39;2&#39;:
            encoded = encoded.translate(str.maketrans(&#39;-_&#39;, &#39;%/&#39;))
        return unescape(unquote(encoded))

    @unguard(r&#39;https?://urldefense(?:\.proofpoint)?\.com/v3/__(.+?)__;(.*?)![-\w!?$]+&#39;)
    def proofpointV3(self, match):
        data = unquote(match[1])
        cmap = match[2] + &#39;=&#39; * (-len(match[2]) % 4)
        cmap = urlsafe_b64decode(cmap).decode(&#39;UTF-8&#39;)
        cursor = 0
        result = &#39;&#39;
        for k in range(len(cmap)):
            ast = data.find(&#39;*&#39;, cursor)
            if ast &lt; 0:
                break
            result += data[cursor:ast]
            if data[ast + 1] == &#39;*&#39;:
                end = self._PP3RLENC[data[ast + 2]]
                result += cmap[k:end]
                ast += 2
            else:
                result += cmap[k]
            cursor = ast + 1
        self.log_debug(result)
        self.log_debug(data[cursor:])
        return result + data[cursor:]

    @unguard(r&#39;https?://\w+.safelinks\.protection\.outlook\.com/([:;/_=!?#&amp;.,\w\%\-\+|]+)&#39;)
    def outlook(self, match):
        result = match[0]
        self.log_info(&#39;outlook match:&#39;, result)
        parsed = urlparse(result)
        params = parse_qs(parsed.query)
        try:
            result = unquote(params[&#39;url&#39;][0])
        except Exception:
            pass
        return result

    @unguard(r&#39;https?://outlook.office.com/actions/ei\?u=([:;/_=!?#&amp;.,\w\%\-\+|]+)&#39;)
    def outlook_image_proxy(self, match):
        return unquote(match[1])

    @unguard(r&#39;https?://(?:[\w-]+\.)?trendmicro.com(?::\d+)?/wis/clicktime/v[12]/(?:query|clickthrough)[:;/_=!?#&amp;.,\w\%\-\+|]+&#39;)
    def trendmicro(self, match):
        result = match[0]
        self.log_info(&#39;trendmicro match:&#39;, result)
        parsed = urlparse(result)
        params = parse_qs(parsed.query)
        try:
            result = unquote(params[&#39;url&#39;][0])
        except Exception:
            pass
        return result

    @unicoded
    def process(self, data: str) -&gt; str:
        newsize, size = 0, len(data)
        while newsize != size:
            for handler in (
                self.proofpointV2,
                self.proofpointV3,
                self.outlook,
                self.outlook_image_proxy,
                self.trendmicro
            ):
                data = handler(data)
            size = newsize
            newsize = len(data)
        return data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.urlguards.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="refinery.urlguards.proofpointV2"><code class="name flex">
<span>def <span class="ident">proofpointV2</span></span>(<span>self, match)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/urlguards.py#L36-L51" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@unguard(r&#39;https?://urldefense(?:\.proofpoint)?\.com/v([12])/url\?([:;/_=!?#&amp;.,\w\%\-\+|]+)&#39;)
def proofpointV2(self, match):
    version = int(match[1])
    self.log_info(&#39;proofpoint match:&#39;, version)
    argmatch = re.match(
        R&#39;^u=(.+?)&amp;(?:amp;)?{}=&#39;.format(&#39;k&#39; if version == 1 else &#39;[dc]&#39;),
        match[2],
        flags=re.DOTALL
    )
    if not argmatch:
        self.log_warn(&#39;not able to translate unexpected proofpoint format:&#39;, match)
        return match[0]
    encoded = argmatch[1]
    if match[1] == &#39;2&#39;:
        encoded = encoded.translate(str.maketrans(&#39;-_&#39;, &#39;%/&#39;))
    return unescape(unquote(encoded))</code></pre>
</details>
</dd>
<dt id="refinery.urlguards.proofpointV3"><code class="name flex">
<span>def <span class="ident">proofpointV3</span></span>(<span>self, match)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/urlguards.py#L53-L74" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@unguard(r&#39;https?://urldefense(?:\.proofpoint)?\.com/v3/__(.+?)__;(.*?)![-\w!?$]+&#39;)
def proofpointV3(self, match):
    data = unquote(match[1])
    cmap = match[2] + &#39;=&#39; * (-len(match[2]) % 4)
    cmap = urlsafe_b64decode(cmap).decode(&#39;UTF-8&#39;)
    cursor = 0
    result = &#39;&#39;
    for k in range(len(cmap)):
        ast = data.find(&#39;*&#39;, cursor)
        if ast &lt; 0:
            break
        result += data[cursor:ast]
        if data[ast + 1] == &#39;*&#39;:
            end = self._PP3RLENC[data[ast + 2]]
            result += cmap[k:end]
            ast += 2
        else:
            result += cmap[k]
        cursor = ast + 1
    self.log_debug(result)
    self.log_debug(data[cursor:])
    return result + data[cursor:]</code></pre>
</details>
</dd>
<dt id="refinery.urlguards.outlook"><code class="name flex">
<span>def <span class="ident">outlook</span></span>(<span>self, match)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/urlguards.py#L76-L86" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@unguard(r&#39;https?://\w+.safelinks\.protection\.outlook\.com/([:;/_=!?#&amp;.,\w\%\-\+|]+)&#39;)
def outlook(self, match):
    result = match[0]
    self.log_info(&#39;outlook match:&#39;, result)
    parsed = urlparse(result)
    params = parse_qs(parsed.query)
    try:
        result = unquote(params[&#39;url&#39;][0])
    except Exception:
        pass
    return result</code></pre>
</details>
</dd>
<dt id="refinery.urlguards.outlook_image_proxy"><code class="name flex">
<span>def <span class="ident">outlook_image_proxy</span></span>(<span>self, match)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/urlguards.py#L88-L90" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@unguard(r&#39;https?://outlook.office.com/actions/ei\?u=([:;/_=!?#&amp;.,\w\%\-\+|]+)&#39;)
def outlook_image_proxy(self, match):
    return unquote(match[1])</code></pre>
</details>
</dd>
<dt id="refinery.urlguards.trendmicro"><code class="name flex">
<span>def <span class="ident">trendmicro</span></span>(<span>self, match)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/urlguards.py#L92-L102" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@unguard(r&#39;https?://(?:[\w-]+\.)?trendmicro.com(?::\d+)?/wis/clicktime/v[12]/(?:query|clickthrough)[:;/_=!?#&amp;.,\w\%\-\+|]+&#39;)
def trendmicro(self, match):
    result = match[0]
    self.log_info(&#39;trendmicro match:&#39;, result)
    parsed = urlparse(result)
    params = parse_qs(parsed.query)
    try:
        result = unquote(params[&#39;url&#39;][0])
    except Exception:
        pass
    return result</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.xtp"><code class="flex name class">
<span>class <span class="ident">xtp</span></span>
<span>(</span><span>*pattern, filter=0, min=1, max=None, len=None, stripspace=False, unique=False, longest=False, take=None)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.pattern.xtp" href="units/pattern/xtp.html">refinery.units.pattern.xtp</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: xtp [-h] [-Z] [-Q] [-0] [-v] [-f] [-n N] [-N N] [-E N] [-S] [-q]
           [-l] [-t N]
           [pattern [pattern ...]]

Extract Patterns: Uses regular expressions to extract indicators from the
input data and optionally filters these results heuristically. The unit is
designed to extract indicators such as domain names and IP addresses, see
below for a complete list. To extract data formats such as hex-encoded
data, use carve.

positional arguments:
  pattern           Choose the pattern to extract, defaults are hostname,
                    url, and email. Use an asterix character to select all
                    available patterns. The available patterns are:
                    domain, email, guid, ipv4, md5, sha, sha256, hostname,
                    socket, subdomain, url, btc, pem, xmr, path, evar

optional arguments:
  -f, --filter      If this setting is enabled, the xtp unit will attempt
                    to reduce the number of false positives by certain
                    crude heuristics. Specify multiple times to make the
                    filtering more aggressive.
  -n, --min N       Matches must have length at least N.
  -N, --max N       Matches must have length at most N.
  -E, --len N       Matches must be of length N.
  -S, --stripspace  Strip all whitespace from input data.
  -q, --unique      Yield every (transformed) Match only once.
  -l, --longest     Sort results by length.
  -t, --take N      Return only the first N occurrences in order of
                    appearance.

generic options:
  -h, --help        Show this help message and exit.
  -Z, --squeeze     Fuse outputs, do not insert line breaks.
  -Q, --quiet       Disables all log output.
  -0, --devnull     Do not produce any output.
  -v, --verbose     Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/pattern/xtp.py#L15-L167" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class xtp(PatternExtractor):
    &#34;&#34;&#34;
    Extract Patterns: Uses regular expressions to extract indicators from the
    input data and optionally filters these results heuristically. The unit is
    designed to extract indicators such as domain names and IP addresses, see
    below for a complete list. To extract data formats such as hex-encoded
    data, use `refinery.carve`.
    &#34;&#34;&#34;

    def __init__(
        self,
        *pattern: arg(&#39;pattern&#39;, type=str, default=(&#39;hostname&#39;, &#39;url&#39;, &#39;email&#39;), help=(
            &#39;Choose the pattern to extract, defaults are hostname, url, and email. &#39;
            &#39;Use an asterix character to select all available patterns. The available &#39;
            &#39;patterns are: {}&#39;.format(&#39;, &#39;.join(p.name for p in indicators)))),
        filter: arg(&#39;-f&#39;, dest=&#39;filter&#39;, action=&#39;count&#39;, help=(
            &#39;If this setting is enabled, the xtp unit will attempt to reduce the number &#39;
            &#39;of false positives by certain crude heuristics. Specify multiple times to &#39;
            &#39;make the filtering more aggressive.&#39;)) = 0,
        min=1, max=None, len=None, stripspace=False, unique=False, longest=False, take=None
    ):
        self.superinit(super(), **vars(), ascii=True, utf16=True)

        patterns = {
            p for name in pattern for p in indicators if fnmatch(p.name, name)
        }
        if indicators.hostname in patterns:
            patterns.remove(indicators.hostname)
            patterns.add(indicators.ipv4)
            patterns.add(indicators.domain)
        patterns = [F&#39;(?P&lt;{p.name}&gt;{p.value})&#39; for p in patterns]
        if not patterns:
            raise RefineryCriticalException(&#39;The given mask does not match any known indicator pattern.&#39;)
        pattern = &#39;|&#39;.join(patterns)
        self.log_debug(F&#39;using pattern: {pattern}&#39;)

        self.args.pattern = re.compile(pattern.encode(self.codec))
        self.args.filter = filter

    _ALPHABETIC = ascii_letters.encode(&#39;ASCII&#39;)
    _LEGITIMATE_HOSTS = {
        &#39;adobe.com&#39;           : 1,
        &#39;aka.ms&#39;              : 1,
        &#39;apache.org&#39;          : 1,
        &#39;apple.com&#39;           : 1,
        &#39;azure.com&#39;           : 1,
        &#39;baidu.com&#39;           : 2,
        &#39;curl.haxx.se&#39;        : 1,
        &#39;digicert.com&#39;        : 1,
        &#39;globalsign.com&#39;      : 1,
        &#39;globalsign.net&#39;      : 1,
        &#39;google.com&#39;          : 3,
        &#39;iana.org&#39;            : 1,
        &#39;live.com&#39;            : 1,
        &#39;microsoft.com&#39;       : 1,
        &#39;msdn.com&#39;            : 1,
        &#39;msn.com&#39;             : 1,
        &#39;office.com&#39;          : 1,
        &#39;openssl.org&#39;         : 1,
        &#39;openxmlformats.org&#39;  : 1,
        &#39;purl.org&#39;            : 1,
        &#39;python.org&#39;          : 1,
        &#39;skype.com&#39;           : 1,
        &#39;sway-cdn.com&#39;        : 1,
        &#39;sway-extensions.com&#39; : 1,
        &#39;symantec.com&#39;        : 1,
        &#39;symauth.com&#39;         : 1,
        &#39;symcb.com&#39;           : 1,
        &#39;thawte.com&#39;          : 1,
        &#39;verisign.com&#39;        : 1,
        &#39;w3.org&#39;              : 1,
        &#39;xml.org&#39;             : 1,
        &#39;xmlsoap.org&#39;         : 1,
        &#39;yahoo.com&#39;           : 1,
    }

    _DOMAIN_WHITELIST = [
        &#39;system.net&#39;,
        &#39;wscript.shell&#39;,
    ]

    def _check_match(self, data, pos, name, value):
        if name == &#39;ipv4&#39;:
            ocets = [int(x) for x in value.split(B&#39;.&#39;)]
            if ocets.count(0) &gt;= 3:
                return None
            for area in (
                data[pos - 20 : pos + 20],
                data[pos * 2 - 40 : pos * 2 + 40 : 2],
                data[pos * 2 - 41 : pos * 2 + 39 : 2]
            ):
                if B&#39;version&#39; in area.lower():
                    return None
            ip = ip_address(value.decode(self.codec))
            if not ip.is_global:
                if self.args.filter &gt; 1 or not ip.is_private:
                    return None
        elif name in (&#39;url&#39;, &#39;socket&#39;, &#39;domain&#39;):
            ioc = value.decode(self.codec)
            if &#39;://&#39; not in ioc: ioc = F&#39;TCP://{ioc}&#39;
            host = urlparse(ioc).netloc.split(&#39;:&#39;, 1)[0].lower()
            for white, level in self._LEGITIMATE_HOSTS.items():
                if level &lt;= self.args.filter and host == white or host.endswith(F&#39;.{white}&#39;):
                    return None
            if any(host == w for w in self._DOMAIN_WHITELIST):
                return None
            if name == &#39;domain&#39;:
                hostparts = host.split(&#39;.&#39;)
                # These heuristics attempt to filter out member access to variables in
                # scripts which can be mistaken for domains because of the TLD inflation
                # we&#39;ve had.
                if len(hostparts) == 2 and hostparts[0] == &#39;this&#39;:
                    return None
                if len(hostparts[-2]) &lt; 3:
                    return None
                if any(x.startswith(&#39;_&#39;) for x in hostparts):
                    return None
                if len(hostparts[-1]) &gt; 3:
                    seen_before = len(set(re.findall(
                        R&#39;{}(?:\.\w+)+&#39;.format(hostparts[0]).encode(&#39;ascii&#39;), data)))
                    if seen_before &gt; 2:
                        return None
        elif name == &#39;email&#39;:
            at = value.find(B&#39;@&#39;)
            ix = 0
            while value[ix] not in self._ALPHABETIC:
                ix += 1
            return None if at - ix &lt; 3 else value[ix:]
        elif name == &#39;path&#39;:
            if len(value) &lt; 8:
                return None
            if len(value) &gt; 16 and len(re.findall(RB&#39;\\x\d\d&#39;, value)) &gt; len(value) // 10:
                return None
        return value

    def process(self, data):
        whitelist = set()

        def check(match):
            for name, value in match.groupdict().items():
                if value is not None:
                    break
            else:
                raise RefineryCriticalException(&#39;Received empty match.&#39;)
            if value in whitelist:
                return None
            result = self._check_match(data, match.start(), name, value)
            if result is not None:
                return result
            whitelist.add(value)

        transforms = [] if not self.args.filter else [check]
        yield from self.matches_filtered(memoryview(data), self.args.pattern, *transforms)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.pattern.PatternExtractor" href="units/pattern/index.html#refinery.units.pattern.PatternExtractor">PatternExtractor</a></li>
<li><a title="refinery.units.pattern.PatternExtractorBase" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase">PatternExtractorBase</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.xtp.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.pattern.PatternExtractor" href="units/pattern/index.html#refinery.units.pattern.PatternExtractor">PatternExtractor</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.pattern.PatternExtractor.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.matches" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase.matches">matches</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.matches_filtered" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase.matches_filtered">matches_filtered</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractor.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.carveb64z"><code class="flex name class">
<span>class <span class="ident">carveb64z</span></span>
<span>(</span><span>single=True, min=1, max=None, stripspace=False, unique=False, longest=False, take=None, utf16=True, ascii=True)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.shortcuts.carveb64z" href="units/shortcuts/carveb64z.html">refinery.units.shortcuts.carveb64z</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: carveb64z [-h] [-Z] [-Q] [-0] [-v] [-m] [-n N] [-N N] [-S] [-q]
                 [-l] [-t N] [-a | -u]

Carves base64 encoded expressions, decodes them, and then applies the
decompress unit to the result. By default, only the longest base64 string
is processed.

optional arguments:
  -m, --multi       Process all base64 strings instead of just the
                    longest.
  -n, --min N       Matches must have length at least N.
  -N, --max N       Matches must have length at most N.
  -S, --stripspace  Strip all whitespace from input data.
  -q, --unique      Yield every (transformed) Match only once.
  -l, --longest     Sort results by length.
  -t, --take N      Return only the first N occurrences in order of
                    appearance.
  -a, --no-utf16    Search for ASCII encoded patterns only.
  -u, --no-ascii    Search for UTF16 encoded patterns only.

generic options:
  -h, --help        Show this help message and exit.
  -Z, --squeeze     Fuse outputs, do not insert line breaks.
  -Q, --quiet       Disables all log output.
  -0, --devnull     Do not produce any output.
  -v, --verbose     Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/shortcuts/carveb64z.py#L7-L22" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class carveb64z(carve):
    &#34;&#34;&#34;
    Carves base64 encoded expressions, decodes them, and then applies the `refinery.decompress`
    unit to the result. By default, only the longest base64 string is processed.
    &#34;&#34;&#34;
    def __init__(
        self, single: arg.switch(&#39;-m&#39;, &#39;--multi&#39;, help=&#39;Process all base64 strings instead of just the longest.&#39;) = True,
        min=1, max=None, stripspace=False, unique=False, longest=False, take=None, utf16=True, ascii=True
    ):
        super().__init__(&#39;b64&#39;, decode=True,
            single=single, min=min, max=max, stripspace=stripspace, unique=unique, longest=longest, take=take, utf16=utf16, ascii=ascii)
        self.decompressor = decompress()

    def process(self, data):
        for chunk in super().process(data):
            yield self.decompressor(chunk)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.pattern.carve.carve" href="units/pattern/carve.html#refinery.units.pattern.carve.carve">carve</a></li>
<li><a title="refinery.units.pattern.PatternExtractor" href="units/pattern/index.html#refinery.units.pattern.PatternExtractor">PatternExtractor</a></li>
<li><a title="refinery.units.pattern.PatternExtractorBase" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase">PatternExtractorBase</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.carveb64z.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.pattern.carve.carve" href="units/pattern/carve.html#refinery.units.pattern.carve.carve">carve</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.pattern.carve.carve.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.matches" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase.matches">matches</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.matches_filtered" href="units/pattern/index.html#refinery.units.pattern.PatternExtractorBase.matches_filtered">matches_filtered</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.pattern.carve.carve.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.pattern.PatternExtractor" href="units/pattern/index.html#refinery.units.pattern.PatternExtractor">PatternExtractor</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.pattern.PatternExtractor.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.asm"><code class="flex name class">
<span>class <span class="ident">asm</span></span>
<span>(</span><span>mode=x32, addr=True, bytes=True, str=True, zeros=True, width=15)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.sinks.asm" href="units/sinks/asm.html">refinery.units.sinks.asm</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: asm [-h] [-Q] [-0] [-v] [-a] [-b] [-s] [-z] [-w N] [ARCH]

Disassembles the input data using the capstone disassembly library.

positional arguments:
  ARCH           select one of the following architectures: x16, x32, x64,
                 arm; the default is x32.

optional arguments:
  -a, --addr     hide addresses of instruction
  -b, --bytes    hide instruction bytes next to disassembly
  -s, --str      disassemble over detected strings
  -z, --zeros    disassemble zero byte patches
  -w, --width N  number of data bytes to put in one row, 15 by default

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/sinks/asm.py#L30-L136" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class asm(Unit):
    &#34;&#34;&#34;
    Disassembles the input data using the capstone disassembly library.
    &#34;&#34;&#34;

    def __init__(
        self,
        mode  : arg.option(choices=ARCH, help=&#39;select one of the following architectures: {choices}; the default is {default}.&#39;) = ARCH.x32,
        addr  : arg.switch(&#39;-a&#39;, help=&#39;hide addresses of instruction&#39;) = True,
        bytes : arg.switch(&#39;-b&#39;, help=&#39;hide instruction bytes next to disassembly&#39;) = True,
        str   : arg.switch(&#39;-s&#39;, help=&#39;disassemble over detected strings&#39;) = True,
        zeros : arg.switch(&#39;-z&#39;, help=&#39;disassemble zero byte patches&#39;) = True,
        width : arg.number(&#39;-w&#39;, bound=(3, None), help=&#39;number of data bytes to put in one row, {default} by default&#39;) = 15
    ):
        mode = makeinstance(ARCH, mode)
        self.superinit(super(), **vars())

    def _printable(self, b):
        return 0x20 &lt;= b &lt;= 0x7E and b not in B&#39; \t\v\r\n&#39;

    def _strings(self, data):
        if not self.args.str:
            return
        for match in re.finditer(BR&#39;([ -~]{5,})\x00?|((?:[ -~]\x00){5,})(?:\x00\x00)?&#39;, data):
            string = match[0]
            try:
                string = string.decode(&#39;UTF16-LE&#39;) if not string.end \
                    else string.decode(&#39;UTF8&#39;)
            except Exception:
                continue
            alpha = len([x for x in string if x in digits or x in ascii_letters])
            if 2 * alpha &gt; len(string):
                yield box(start=match.start(), end=match.end(), data=string)
                self.log_info(F&#39;detected string at {match.start():08X}:&#39;, string)

    def _format(self, addr=0, data=B&#39;&#39;, code=&#39;&#39;, arg=&#39;&#39;, comment=&#39;&#39;):
        data_str = &#39;&#39;.join(&#39;%c&#39; % X if self._printable(X) else &#39;.&#39; for X in data)
        data_hex = &#39; &#39;.join(&#39;%02X&#39; % X for X in data)
        if comment: comment = &#39;    ; &#39; + comment
        return {
            &#39;addr&#39;: addr,
            &#39;str&#39;: data_str,
            &#39;hex&#39;: data_hex,
            &#39;code&#39;: code,
            &#39;arg&#39;: arg,
            &#39;comment&#39;: comment
        }

    def _bytepatch(self, data, addr, end):
        return self._format(addr, data[addr:end], &#39;db&#39;, &#39;,&#39;.join(&#39;%02X&#39; % b for b in data[addr:end]))

    def _nullsize(self, data, offset, max):
        length = 0
        try:
            while not data[offset + length] and length &lt; max:
                length += 1
        except IndexError:
            pass
        return length

    def _disassemble(self, data):
        capstone = Cs(*self.args.mode.value)
        strz = self._strings(data)
        string = next(strz, None)
        cursor, done = 0, 0
        while done &lt; len(data):
            cursor = max(cursor, done)
            patchsize = self._nullsize(data, cursor, self.args.width)
            if patchsize &gt; 2:
                yield self._format(done, data[done:done + patchsize], &#39;db&#39;, &#39;,&#39;.join(&#39;0&#39; * patchsize))
                done += patchsize
                continue
            if cursor &gt;= len(data):
                yield self._bytepatch(data, done, len(data))
                done = cursor
            if string and cursor &gt;= string.end:
                yield self._bytepatch(data, done, string.start)
                yield self._format(string.start, data[string.start:string.end], &#39;db&#39;, string.data)
                done = string.end
                continue
            try:
                ins = next(capstone.disasm(
                    data[cursor:cursor + 15], cursor, count=1))
                end = ins.address + ins.size
                if self.args.str and string:
                    if end &gt; string.start and string.end &gt; cursor:
                        cursor = string.end
                        continue
            except StopIteration:
                cursor += 1
                continue
            else:
                yield self._format(ins.address, ins.bytes, ins.mnemonic, ins.op_str)
                done = end

    def process(self, data):
        disassembly = list(self._disassemble(data))
        for key in [&#39;hex&#39;, &#39;str&#39;, &#39;code&#39;, &#39;arg&#39;]:
            m = max(len(r[key]) for r in disassembly)
            for r in disassembly:
                r[key] = r[key].ljust(m)
        line_format = &#39;{code} {arg}{comment}&#39;
        if self.args.bytes:
            line_format = &#39;{hex}  {str}  &#39; + line_format
        if self.args.addr:
            line_format = &#39;0x{addr:08X}:  &#39; + line_format
        return &#39;\n&#39;.join(line_format.format(**r) for r in disassembly).encode(self.codec)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.asm.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.dump"><code class="flex name class">
<span>class <span class="ident">dump</span></span>
<span>(</span><span>*filenames, tee=False, stream=False, plain=False, force=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.sinks.dump" href="units/sinks/dump.html">refinery.units.sinks.dump</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: dump [-h] [-Z] [-Q] [-0] [-v] [-t] [-s] [-p] [-f]
            [filenames [filenames ...]]

Dump incoming data to files on disk. It is possible to specify filenames
with format fields. The following format fields are supported.
Additionally, any metadata field on an incoming chunk can also be used.

    {ext}    : Automatically guessed file extension
    {crc32}  : CRC32 checksum of the data
    {index}  : Index of the data in the input stream, starting at 1
    {length} : Size of the data in bytes
    {md5}    : MD5 hash of the data
    {sha1}   : SHA1 hash of the data
    {sha256} : SHA-256 hash of the data
    {path}   : Associated path; defaults to {sha256} if none is given.

When not using formatted file names, the unit ingests as many incoming
inputs as filenames were specified on the command line. Unless connected
to a terminal, the remaining inputs will be forwarded on STDOUT. The -t or
--tee switch can be used to forward all inputs, under all circumstances,
regardless of whether or not they have been processed.

If no file is specified, the first ingested input is dumped to the
clipboard.

positional arguments:
  filenames

optional arguments:
  -t, --tee      Forward all inputs to STDOUT.
  -s, --stream   Dump all incoming data to the same file.
  -p, --plain    Never apply any formatting to file names.
  -f, --force    Remove files if necessary to create dump path.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/sinks/dump.py#L12-L193" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class dump(Unit):
    &#34;&#34;&#34;
    Dump incoming data to files on disk. It is possible to specify filenames with format fields.
    The following format fields are supported. Additionally, any metadata field on an incoming chunk
    can also be used.

        {ext}    : Automatically guessed file extension
        {crc32}  : CRC32 checksum of the data
        {index}  : Index of the data in the input stream, starting at 1
        {length} : Size of the data in bytes
        {md5}    : MD5 hash of the data
        {sha1}   : SHA1 hash of the data
        {sha256} : SHA-256 hash of the data
        {path}   : Associated path; defaults to {sha256} if none is given.

    When not using formatted file names, the unit ingests as many incoming inputs as filenames were
    specified on the command line. Unless connected to a terminal, the remaining inputs will be
    forwarded on STDOUT. The `-t` or `--tee` switch can be used to forward all inputs, under all
    circumstances, regardless of whether or not they have been processed.

    If no file is specified, the first ingested input is dumped to the clipboard.
    &#34;&#34;&#34;

    def __init__(
        self, *filenames: str,
        tee    : arg.switch(&#39;-t&#39;, help=&#39;Forward all inputs to STDOUT.&#39;) = False,
        stream : arg.switch(&#39;-s&#39;, help=&#39;Dump all incoming data to the same file.&#39;) = False,
        plain  : arg.switch(&#39;-p&#39;, help=&#39;Never apply any formatting to file names.&#39;) = False,
        force  : arg.switch(&#39;-f&#39;, help=&#39;Remove files if necessary to create dump path.&#39;) = False,
    ):
        if stream and len(filenames) != 1:
            raise ValueError(&#39;Can only use exactly one file in stream mode.&#39;)
        super().__init__(filenames=filenames, tee=tee, stream=stream, force=force)
        if plain:
            self.formatted = False
        else:
            from string import Formatter
            nf = Formatter()
            self.formatted = any(any(t.isalnum() for t in fields)
                for f in filenames for _, fields, *__ in nf.parse(f) if fields)
        self._reset()

    def _reset(self):
        self.stream = None
        self.exhausted = False
        if self.formatted:
            self.paths = cycle(self.args.filenames)
        else:
            self.paths = iter(self.args.filenames)

    @property
    def _paste(self):
        return not self.args.filenames

    def _components(self, path):
        def _reversed_components(path):
            while True:
                path, component = os.path.split(path)
                if not component:
                    break
                yield component
            yield path
        components = list(_reversed_components(path))
        components.reverse()
        return components

    def _open(self, filename, unc=False):
        filename = os.path.abspath(filename)
        base = os.path.dirname(filename)
        if not unc:
            self.log_info(&#39;opening:&#39;, filename)
        try:
            os.makedirs(base, exist_ok=True)
        except FileExistsError:
            path, components = &#39;&#39;, self._components(filename)
            while components:
                component, *components = components
                path = os.path.join(path, component)
                if os.path.exists(path) and os.path.isfile(path):
                    if self.args.force:
                        os.unlink(path)
                        return self._open(filename, unc)
                    break
            raise RefineryCriticalException(F&#39;Unable to dump to {filename} because {path} is a file.&#39;)
        except FileNotFoundError:
            if unc or os.name != &#39;nt&#39;:
                raise
            filename = F&#39;\\\\?\\{filename}&#39;
            return self._open(filename, unc=True)
        else:
            return open(filename, &#39;wb&#39;)

    def _close(self):
        if self.stream:
            self.stream.flush()
            self.stream.close()
            self.stream = None

    def _format(self, filename, data, index=0, **meta):
        class DelayedFormatter(dict):
            dmp = self

            def __missing__(self, key):
                if key == &#39;crc32&#39;:
                    from zlib import crc32
                    return F&#39;{crc32(data) &amp; 0xFFFFFFFF:08X}&#39;
                if key == &#39;ext&#39;:
                    try:
                        return file_extension_from_data(data)
                    except NoMagicAvailable:
                        self.dmp.log_warn(&#39;no magic library available, using default extension .bin&#39;)
                        return &#39;bin&#39;
                if key == &#39;path&#39;:
                    key = &#39;sha256&#39;
                if key in (&#39;md5&#39;, &#39;sha1&#39;, &#39;sha256&#39;):
                    import hashlib
                    algorithm = getattr(hashlib, key)
                    return algorithm(data).hexdigest()
                return &#39;{&#39; + key + &#39;}&#39;

        return filename.format_map(
            DelayedFormatter(dict(index=index, length=len(data), **meta))
        )

    def process(self, data):
        if not self.exhausted:
            if self._paste:
                import codecs
                import pyperclip
                pyperclip.copy(codecs.decode(
                    data, &#39;utf-8&#39;, errors=&#39;backslashreplace&#39;))
            elif not self.stream:
                # This should happen only when the unit is called from Python code
                # rather than via the command line.
                try:
                    filename = next(self.paths)
                except StopIteration:
                    raise RefineryCriticalException(&#39;the list of filenames was exhausted.&#39;)
                else:
                    with self._open(filename) as stream:
                        stream.write(data)
            else:
                self.stream.write(data)
                self.log_debug(F&#39;wrote 0x{len(data):08X} bytes&#39;)
                if not self.args.stream:
                    self._close()
            forward_input_data = self.args.tee
        else:
            forward_input_data = self.args.tee or not self.isatty
            if not forward_input_data:
                self.log_debug(F&#39;discarding unprocessed chunk of size {len(data)}.&#39;)

        if forward_input_data:
            yield data

    def filter(self, chunks):
        if self.exhausted:
            self._reset()

        if self._paste:
            it = iter(chunks)
            yield next(it)
            self.exhausted = True
            yield from it
            return

        for index, chunk in enumerate(chunks, 1):
            if self.exhausted:
                continue
            if not self.args.stream or not self.stream:
                try:
                    filename = next(self.paths)
                except StopIteration:
                    self.exhausted = True
                else:
                    if self.formatted:
                        filename = self._format(filename, chunk, index, **chunk.meta)
                    self.stream = self._open(filename)
            yield chunk

        self._close()
        self.exhausted = True</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.dump.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.hexview"><code class="flex name class">
<span>class <span class="ident">hexview</span></span>
<span>(</span><span>hexaddr=True, width=0, expand=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.sinks.hexview" href="units/sinks/hexview.html">refinery.units.sinks.hexview</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: hexview [-h] [-Z] [-Q] [-0] [-v] [-A] [-W N] [-E]

Produces a hex dump of the data.

optional arguments:
  -A, --no-addr  Do not show addresses in hexdump
  -W, --width N  Specify the number of hexadecimal characters to use in
                 preview.
  -E, --expand   Do not compress sequences of identical lines in hexdump

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/sinks/hexview.py#L6-L15" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class hexview(HexViewer):
    &#34;&#34;&#34;
    Produces a hex dump of the data.
    &#34;&#34;&#34;
    def __init__(self, hexaddr=True, width=0, expand=False):
        super().__init__(hexaddr=hexaddr, width=width, expand=expand)

    def process(self, data):
        for line in self.hexdump(data):
            yield line.encode(self.codec)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.sinks.HexViewer" href="units/sinks/index.html#refinery.units.sinks.HexViewer">HexViewer</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.hexview.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.sinks.HexViewer" href="units/sinks/index.html#refinery.units.sinks.HexViewer">HexViewer</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.sinks.HexViewer.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.peek"><code class="flex name class">
<span>class <span class="ident">peek</span></span>
<span>(</span><span>lines=10, all=False, decode=False, esc=False, brief=False, hexaddr=True, expand=False, width=0)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.sinks.peek" href="units/sinks/peek.html">refinery.units.sinks.peek</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: peek [-h] [-Z] [-Q] [-0] [-v] [-l LINES | -a] [-d | -e | -b] [-A]
            [-E] [-W N]

The unit extracts preview information of the input data and displays it on
the standard error stream. If the standard output of this unit is
connected by a pipe, the incoming data is forwarded. However, if the unit
outputs to a terminal, the data is discarded instead.

optional arguments:
  -l, --lines LINES  Specify number N of lines in the preview, default is
                     10.
  -a, --all          Output all possible preview lines without restriction
  -d, --decode       Attempt to decode and display printable data.
  -e, --esc          Always peek data as string, escape characters if
                     necessary.
  -b, --brief        One line peek, implies --lines=0.
  -A, --no-addr      Do not show addresses in hexdump
  -E, --expand       Do not compress sequences of identical lines in
                     hexdump
  -W, --width N      Specify the number of hexadecimal characters to use
                     in preview.

generic options:
  -h, --help         Show this help message and exit.
  -Z, --squeeze      Fuse outputs, do not insert line breaks.
  -Q, --quiet        Disables all log output.
  -0, --devnull      Do not produce any output.
  -v, --verbose      Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/sinks/peek.py#L11-L125" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class peek(HexViewer):
    &#34;&#34;&#34;
    The unit extracts preview information of the input data and displays it on
    the standard error stream. If the standard output of this unit is connected
    by a pipe, the incoming data is forwarded. However, if the unit outputs to
    a terminal, the data is discarded instead.
    &#34;&#34;&#34;

    def __init__(
        self,
        lines  : arg(&#39;-l&#39;, group=&#39;SIZE&#39;, help=&#39;Specify number N of lines in the preview, default is 10.&#39;) = 10,
        all    : arg(&#39;-a&#39;, group=&#39;SIZE&#39;, help=&#39;Output all possible preview lines without restriction&#39;) = False,
        decode : arg(&#39;-d&#39;, group=&#39;MODE&#39;, help=&#39;Attempt to decode and display printable data.&#39;) = False,
        esc    : arg(&#39;-e&#39;, group=&#39;MODE&#39;, help=&#39;Always peek data as string, escape characters if necessary.&#39;) = False,
        brief  : arg(&#39;-b&#39;, group=&#39;MODE&#39;, help=&#39;One line peek, implies --lines=0.&#39;) = False,
        hexaddr=True, expand=False, width=0
    ):
        lines = INF if all else lines
        super(peek, self).__init__(
            hexaddr=hexaddr, expand=expand, width=width, lines=lines, decode=decode, esc=esc, brief=brief)
        self.separate = True

    def process(self, data):
        for line in self._peeklines(data):
            print(line, file=sys.stderr)
        if not sys.stdout.isatty():
            self.log_info(&#39;forwarding input to next unit&#39;)
            yield data

    def _peeklines(self, data):
        import codecs
        import string
        import itertools
        from ...lib.tools import format_size
        from ...lib.magic import magicparse

        peeks = [
            F&#39;{entropy(memoryview(data)) * 100:05.2f}% entropy&#39;,
            format_size(len(data), align=not self.args.lines)
        ]

        magic = magicparse(data)

        if magic is not None:
            peeks.append(magic)

        header = &#39;, &#39;.join(peeks)

        dump = None
        termsize = get_terminal_size()
        working_codec = None

        if data and not self.args.brief:
            if self.args.decode:
                for codec in (&#39;UTF8&#39;, &#39;UTF-16LE&#39;, &#39;UTF-16&#39;, &#39;UTF-16BE&#39;):
                    try:
                        self.log_info(F&#39;trying to decode as {codec}.&#39;)
                        handler = &#39;backslashreplace&#39; if self.args.esc else &#39;strict&#39;
                        decoded = codecs.decode(data, codec, errors=handler)
                        count = sum(x in string.printable for x in decoded)
                        ratio = count / len(data)
                    except ValueError as V:
                        self.log_info(&#39;decoding failed:&#39;, V)
                        continue
                    if ratio &lt; 0.8 or any(x in decoded for x in &#39;\b\v&#39;):
                        self.log_info(F&#39;data contains {ratio * 100:.2f}% printable characters, this is too low.&#39;)
                        continue

                    width = self.args.width or termsize
                    decoded = decoded[:abs(width * self.args.lines)]
                    dump = [
                        line.rstrip(&#39;\r&#39;)
                        for chunk in textwrap.wrap(
                            decoded,
                            width,
                            break_on_hyphens=False,
                            replace_whitespace=False
                        )
                        for line in chunk.split(&#39;\n&#39;)
                    ]
                    working_codec = codec
                    break

            if not dump:
                total = abs(self.args.lines * termsize // 3)
                dump = self.hexdump(data, total=total)

            dump = list(itertools.islice(dump, 0, abs(self.args.lines)))

        width = max(len(d) for d in dump) if self.args.width else termsize

        def separator(title=None):
            if title is None or width &lt;= len(title) + 8:
                return width * &#39;-&#39;
            return F&#39;--{title}&#39; + &#39;-&#39; * (width - len(title) - 2)

        yield separator()

        if width:
            yield from textwrap.wrap(header, width)
        else:
            yield header

        if dump:
            yield separator(F&#39;CODEC={working_codec}&#39; if working_codec else &#39;HEXDUMP&#39;)
            yield from dump

        if self.separate:
            yield separator()

    def filter(self, inputs):
        from ...lib.tools import lookahead
        for last, item in lookahead(inputs):
            self.separate = last
            yield item</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.sinks.HexViewer" href="units/sinks/index.html#refinery.units.sinks.HexViewer">HexViewer</a></li>
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.peek.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.sinks.HexViewer" href="units/sinks/index.html#refinery.units.sinks.HexViewer">HexViewer</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.sinks.HexViewer.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.sinks.HexViewer.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.ppjson"><code class="flex name class">
<span>class <span class="ident">ppjson</span></span>
<span>(</span><span>indent=4)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.sinks.ppjson" href="units/sinks/ppjson.html">refinery.units.sinks.ppjson</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: ppjson [-h] [-Q] [-0] [-v] [-i N]

Expects JSON input data and outputs it in a neatly formatted manner. If
the indentation is set to zero, the output is minified.

optional arguments:
  -i, --indent N  Controls the amount of space characters used for
                  indentation in the output. Default is 4.

generic options:
  -h, --help      Show this help message and exit.
  -Q, --quiet     Disables all log output.
  -0, --devnull   Do not produce any output.
  -v, --verbose   Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/sinks/ppjson.py#L10-L42" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ppjson(Unit):
    &#34;&#34;&#34;
    Expects JSON input data and outputs it in a neatly formatted manner.
    If the indentation is set to zero, the output is minified.
    &#34;&#34;&#34;
    _TRAILING_COMMA = re.compile(R&#39;,\s*(}|])&#39;)

    def __init__(self, indent: arg.number(&#39;-i&#39;, help=(
        &#39;Controls the amount of space characters used for indentation in the output. Default is 4.&#39;)) = 4
    ):
        return super().__init__(indent=indent)

    @unicoded
    def process(self, data: str) -&gt; str:
        if self._TRAILING_COMMA.search(data):
            from ...lib.patterns import formats

            strings = {
                range(*m.span())
                for m in re.finditer(formats.string.pattern, data)
            }

            def smartfix(match):
                k = match.start()
                return match.group(0 if any(k in s for s in strings) else 1)

            data = self._TRAILING_COMMA.sub(smartfix, data)

        kwargs = dict(indent=self.args.indent)
        if not self.args.indent:
            kwargs.update(separators=(&#39;,&#39;, &#39;:&#39;))
        data = json.dumps(json.loads(data), **kwargs)
        return data if self.args.indent else data.replace(&#39;\n&#39;, &#39;&#39;)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.ppjson.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.ppxml"><code class="flex name class">
<span>class <span class="ident">ppxml</span></span>
<span>(</span><span>indent=4, header=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.sinks.ppxml" href="units/sinks/ppxml.html">refinery.units.sinks.ppxml</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: ppxml [-h] [-Q] [-0] [-v] [-i N] [-x]

Expects XML input data and outputs it in a neatly formatted manner.

optional arguments:
  -i, --indent N  Controls the amount of space characters used for
                  indentation in the output. Default is 4.
  -x, --header    Add an XML header to the formatted output.

generic options:
  -h, --help      Show this help message and exit.
  -Q, --quiet     Disables all log output.
  -0, --devnull   Do not produce any output.
  -v, --verbose   Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/sinks/ppxml.py#L47-L100" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ppxml(Unit):
    &#34;&#34;&#34;
    Expects XML input data and outputs it in a neatly formatted manner.
    &#34;&#34;&#34;

    def __init__(self,
        indent: arg.number(&#39;-i&#39;, help=(
            &#39;Controls the amount of space characters used for indentation in the output. Default is 4.&#39;)) = 4,
        header: arg.switch(&#39;-x&#39;, help=&#39;Add an XML header to the formatted output.&#39;) = False
    ):
        super().__init__(indent=indent, header=header)

    def process(self, data):

        pad = self.args.indent * &#39; &#39;
        etm = {}
        dom = ParseXML(io.BytesIO(data), parser=ForgivingXMLParser(etm))

        def indent(element, level=0, more_sibs=False):
            &#34;&#34;&#34;
            The credit for this one goes to:
            https://stackoverflow.com/a/12940014
            &#34;&#34;&#34;
            indentation = &#39;\n&#39;
            if level:
                indentation += (level - 1) * pad
            childcount = len(element)
            if childcount:
                if not element.text or not element.text.strip():
                    element.text = indentation + pad
                    if level:
                        element.text += pad
                for count, child in enumerate(element):
                    indent(child, level + 1, count &lt; childcount - 1)
                if level and (not element.tail or element.tail.isspace()):
                    element.tail = indentation
                    if more_sibs:
                        element.tail += pad
            elif level and (not element.tail or element.tail.isspace()):
                element.tail = indentation
                if more_sibs: element.tail += pad

        indent(dom.getroot())

        with io.BytesIO() as output:
            dom.write(output, encoding=self.codec, xml_declaration=self.args.header)
            result = output.getvalue()

        for uid, key in etm.items():
            entity = F&#39;&amp;{key};&#39;.encode(self.codec)
            needle = uid.encode(self.codec)
            result = result.replace(needle, entity)

        return result</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.ppxml.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.cca"><code class="flex name class">
<span>class <span class="ident">cca</span></span>
<span>(</span><span>*data)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.strings.cca" href="units/strings/cca.html">refinery.units.strings.cca</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: cca [-h] [-Q] [-0] [-v] [data [data ...]]

Append data to the input.

positional arguments:
  data           Binary strings to be appended to the input.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/strings/cca.py#L6-L15" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class cca(Unit):
    &#34;&#34;&#34;
    Append data to the input.
    &#34;&#34;&#34;

    def __init__(self, *data: arg(help=&#39;Binary strings to be appended to the input.&#39;)):
        super().__init__(data=data)

    def process(self, data):
        return data + B&#39;&#39;.join(self.args.data)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.cca.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.ccp"><code class="flex name class">
<span>class <span class="ident">ccp</span></span>
<span>(</span><span>*data)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.strings.ccp" href="units/strings/ccp.html">refinery.units.strings.ccp</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: ccp [-h] [-Q] [-0] [-v] [data [data ...]]

Prepend data to the input.

positional arguments:
  data           Binary strings to be prepended to the input.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/strings/ccp.py#L6-L15" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ccp(Unit):
    &#34;&#34;&#34;
    Prepend data to the input.
    &#34;&#34;&#34;

    def __init__(self, *data: arg(help=&#39;Binary strings to be prepended to the input.&#39;)):
        super().__init__(data=data)

    def process(self, data):
        return B&#39;&#39;.join(self.args.data) + data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.ccp.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.cfmt"><code class="flex name class">
<span>class <span class="ident">cfmt</span></span>
<span>(</span><span>*format)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.strings.cfmt" href="units/strings/cfmt.html">refinery.units.strings.cfmt</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: cfmt [-h] [-Z] [-Q] [-0] [-v] [format [format ...]]

Transform a given chunk by applying a format string operation. Two types
of string format operations are performed. First, the unit attempts to
pass the incoming data as the only formatting option, which will only
succeed if the formatting string contains exactly one placeholder of the
form %b. Next, the unit will pass a mapping object as the formatting
option which contains all incoming metadata. The incoming data can be
accessed from this mapping object under the name data, or using the empty
string. For example, the following formatting option will print the value
of the meta variable &quot;path&quot;, followed by a colon, a space, and the first
five bytes of the incoming data:

    &quot;%(path)b: %(data).5b&quot;

The following would produce the same output:

    &quot;%%(path)b: %.5b&quot;

But note that %% had to be used for the meta variable substitution because
the first formatting operation (which does not use a mapping object)
requires escaping the percent sign.

positional arguments:
  format         Binary format strings.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/strings/cfmt.py#L6-L55" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class cfmt(Unit):
    &#34;&#34;&#34;
    Transform a given chunk by applying a format string operation. Two types of string format
    operations are performed. First, the unit attempts to pass the incoming data as the only
    formatting option, which will only succeed if the formatting string contains exactly one
    placeholder of the form `%b`. Next, the unit will pass a mapping object as the formatting
    option which contains all incoming metadata. The incoming data can be accessed from this
    mapping object under the name `data`, or using the empty string. For example, the
    following formatting option will print the value of the meta variable &#34;path&#34;, followed by
    a colon, a space, and the first five bytes of the incoming data:

        &#34;%(path)b: %(data).5b&#34;

    The following would produce the same output:

        &#34;%%(path)b: %.5b&#34;

    But note that `%%` had to be used for the meta variable substitution because the first
    formatting operation (which does not use a mapping object) requires escaping the percent
    sign.
    &#34;&#34;&#34;

    def __init__(self, *format: arg(help=&#39;Binary format strings.&#39;)):
        super().__init__(format=format)

    def process(self, data):

        class formatter(dict):
            unit = self

            def __missing__(self, key):
                if key.lower() == b&#39;data&#39; or not key:
                    return data
                result = data[key.decode(&#39;utf8&#39;)]
                if isinstance(result, str):
                    return result.encode(self.unit.codec)
                return result

        formatter = formatter()

        for result in self.args.format:
            try:
                result %= data
            except TypeError as T:
                self.log_debug(str(T))
            try:
                result %= formatter
            except TypeError as T:
                self.log_debug(str(T))
            yield result</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.cfmt.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.clower"><code class="flex name class">
<span>class <span class="ident">clower</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.strings.clower" href="units/strings/clower.html">refinery.units.strings.clower</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: clower [-h] [-Q] [-0] [-v]

Transforms the input data to lowercase.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/strings/clower.py#L6-L11" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class clower(Unit):
    &#34;&#34;&#34;
    Transforms the input data to lowercase.
    &#34;&#34;&#34;
    def process(self, data):
        return data.lower()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.clower.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.cupper"><code class="flex name class">
<span>class <span class="ident">cupper</span></span>
<span>(</span><span>**keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.strings.cupper" href="units/strings/cupper.html">refinery.units.strings.cupper</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: cupper [-h] [-Q] [-0] [-v]

Transforms the input data to uppercase.

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/strings/cupper.py#L6-L11" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class cupper(Unit):
    &#34;&#34;&#34;
    Transforms the input data to uppercase.
    &#34;&#34;&#34;
    def process(self, data):
        return data.upper()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.cupper.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.rep"><code class="flex name class">
<span>class <span class="ident">rep</span></span>
<span>(</span><span>count=2)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.strings.rep" href="units/strings/rep.html">refinery.units.strings.rep</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: rep [-h] [-Z] [-Q] [-0] [-v] [count]

Duplicates the given input a given number of times.

positional arguments:
  count          Defines the number of outputs for each input. The default
                 is the minimum of 2.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/strings/rep.py#L6-L18" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class rep(Unit):
    &#34;&#34;&#34;
    Duplicates the given input a given number of times.
    &#34;&#34;&#34;

    def __init__(self, count: arg(help=&#39;Defines the number of outputs for each input. The default is the minimum of 2.&#39;) = 2):
        if count &lt; 2:
            raise ValueError(&#39;The count must be at least two.&#39;)
        super().__init__(count=count)

    def process(self, data: bytes):
        from itertools import repeat
        yield from repeat(data, self.args.count)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="refinery.units.meta.mpush.mpush" href="units/meta/mpush.html#refinery.units.meta.mpush.mpush">mpush</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.rep.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.repl"><code class="flex name class">
<span>class <span class="ident">repl</span></span>
<span>(</span><span>search, replace=b'', count=-1)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.strings.repl" href="units/strings/repl.html">refinery.units.strings.repl</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: repl [-h] [-Q] [-0] [-v] [-n N] search [replace]

Performs a simple binary string replacement on the input data.

positional arguments:
  search         This is the search term.
  replace        The substitution string. Leave this empty to remove all
                 occurrences of the search term.

optional arguments:
  -n, --count N  Only replace the given number of occurrences

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/strings/repl.py#L6-L24" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class repl(Unit):
    &#34;&#34;&#34;
    Performs a simple binary string replacement on the input data.
    &#34;&#34;&#34;

    def __init__(
        self,
        search : arg(help=&#39;This is the search term.&#39;),
        replace: arg(help=&#39;The substitution string. Leave this empty to remove all occurrences of the search term.&#39;) = B&#39;&#39;,
        count  : arg.number(&#39;-n&#39;, help=&#39;Only replace the given number of occurrences&#39;) = -1
    ):
        super().__init__(search=search, replace=replace, count=count)

    def process(self, data: bytes):
        return data.replace(
            self.args.search,
            self.args.replace,
            self.args.count
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.repl.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.snip"><code class="flex name class">
<span>class <span class="ident">snip</span></span>
<span>(</span><span>slices=[slice(None, None, None)], remove=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.strings.snip" href="units/strings/snip.html">refinery.units.strings.snip</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: snip [-h] [-Z] [-Q] [-0] [-v] [-r] [slices [slices ...]]

Snips the input data based on a Python slice expression. For example, the
initialization slice 0::1 1::1 would yield a unit that first extracts
every byte at an even position and then, every byte at an odd position. In
this case, multiple outputs are produced. The unit can be used in reverse
mode, in which case the specified ranges are deleted sequentially from the
input.

positional arguments:
  slices         Specify start:stop:step in Python slice syntax.

optional arguments:
  -r, --remove   Remove the slices from the input rather than selecting
                 them.

generic options:
  -h, --help     Show this help message and exit.
  -Z, --squeeze  Fuse outputs, do not insert line breaks.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/strings/snip.py#L9-L33" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class snip(Unit):
    &#34;&#34;&#34;
    Snips the input data based on a Python slice expression. For example, the
    initialization `slice 0::1 1::1` would yield a unit that first extracts
    every byte at an even position and then, every byte at an odd position. In
    this case, multiple outputs are produced. The unit can be used in reverse
    mode, in which case the specified ranges are deleted sequentially from the
    input.
    &#34;&#34;&#34;
    def __init__(
        self,
        slices: arg(help=&#39;Specify start:stop:step in Python slice syntax.&#39;) = [slice(None, None)],
        remove: arg.switch(&#39;-r&#39;, help=&#39;Remove the slices from the input rather than selecting them.&#39;) = False
    ):
        super().__init__(slices=slices, remove=remove)

    def process(self, data: bytearray):
        if self.args.remove:
            for last, bounds in lookahead(self.args.slices):
                chunk = data if last else copy(data)
                del chunk[bounds]
                yield chunk
        else:
            for bounds in self.args.slices:
                yield data[bounds]</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.snip.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.stretch"><code class="flex name class">
<span>class <span class="ident">stretch</span></span>
<span>(</span><span>*count)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.strings.stretch" href="units/strings/stretch.html">refinery.units.strings.stretch</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: stretch [-h] [-R] [-Q] [-0] [-v] [count [count ...]]

Stretch the input data by repeating every byte a number of times.

positional arguments:
  count          The number of times every byte should be repeated. By
                 default, every byte is repeated once.

generic options:
  -h, --help     Show this help message and exit.
  -R, --reverse  Use the reverse operation.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/strings/stretch.py#L8-L39" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class stretch(Unit):
    &#34;&#34;&#34;
    Stretch the input data by repeating every byte a number of times.
    &#34;&#34;&#34;
    def __init__(self, *count: arg.number(metavar=&#39;count&#39;, help=(
        &#39;The number of times every byte should be repeated. By default,  &#39;
        &#39;every byte is repeated once.&#39;
    ))):
        count = count or (2,)
        if any(k &lt;= 0 for k in count):
            raise ValueError(&#39;You can not use a stretching factor of less than 1.&#39;)
        super().__init__(count=count or (2,))

    def process(self, data):
        def stretched(it):
            factor = cycle(self.args.count)
            for byte in it:
                yield from repeat(byte, next(factor))
        return bytearray(stretched(iter(data)))

    def reverse(self, data):
        # one-sided inverse
        def clinched(it):
            factor = cycle(self.args.count)
            while True:
                try:
                    take = islice(it, next(factor))
                    yield next(take)
                    for _ in take: pass
                except StopIteration:
                    break
        return bytearray(clinched(iter(data)))</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.stretch.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.termfit"><code class="flex name class">
<span>class <span class="ident">termfit</span></span>
<span>(</span><span>width=0, delta=0)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.strings.termfit" href="units/strings/termfit.html">refinery.units.strings.termfit</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: termfit [-h] [-Q] [-0] [-v] [-d N] [width]

Reformat incoming text data to fit a certain width.

positional arguments:
  width          Optionally specify the width, by default the current
                 terminal width is used.

optional arguments:
  -d, --delta N  Subtract this number from the calculated width (0 by
                 default).

generic options:
  -h, --help     Show this help message and exit.
  -Q, --quiet    Disables all log output.
  -0, --devnull  Do not produce any output.
  -v, --verbose  Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/strings/termfit.py#L8-L22" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class termfit(Unit):
    &#34;&#34;&#34;
    Reformat incoming text data to fit a certain width.
    &#34;&#34;&#34;

    def __init__(
        self,
        width: arg(&#39;width&#39;, help=&#39;Optionally specify the width, by default the current terminal width is used.&#39;) = 0,
        delta: arg.number(&#39;-d&#39;, help=&#39;Subtract this number from the calculated width (0 by default).&#39;) = 0,
    ):
        super().__init__(width=width, delta=delta)

    @unicoded
    def process(self, data: str) -&gt; str:
        return terminalfit(data, self.args.delta, self.args.width)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.termfit.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.trim"><code class="flex name class">
<span>class <span class="ident">trim</span></span>
<span>(</span><span>*junk, left=True, right=True)</span>
</code></dt>
<dd>
<section class="desc"><p>This unit is implemented in <code><a title="refinery.units.strings.trim" href="units/strings/trim.html">refinery.units.strings.trim</a></code> and has the following commandline Interface:</p>
<pre><code class="text">usage: trim [-h] [-Q] [-0] [-v] [-r | -l] [junk [junk ...]]

Removes byte sequences at beginning and end of input data.

positional arguments:
  junk              Binary strings to be removed, default are all
                    whitespace characters.

optional arguments:
  -r, --right-only  Do not trim left.
  -l, --left-only   Do not trim right.

generic options:
  -h, --help        Show this help message and exit.
  -Q, --quiet       Disables all log output.
  -0, --devnull     Do not produce any output.
  -v, --verbose     Specify up to two times to increase log level.
</code></pre></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/238a54e16c2e926f29dde73bb91a2e05be817b90/refinery/units/strings/trim.py#L6-L91" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class trim(Unit):
    &#34;&#34;&#34;
    Removes byte sequences at beginning and end of input data.
    &#34;&#34;&#34;

    def __init__(
        self, *junk: arg(help=&#39;Binary strings to be removed, default are all whitespace characters.&#39;),
        left: arg.switch(&#39;-r&#39;, &#39;--right-only&#39;, group=&#39;SIDE&#39;, help=&#39;Do not trim left.&#39;) = True,
        right: arg.switch(&#39;-l&#39;, &#39;--left-only&#39;, group=&#39;SIDE&#39;, help=&#39;Do not trim right.&#39;) = True
    ):
        if not junk:
            import string
            strips = string.whitespace.encode(&#39;ascii&#39;)
        else:
            strips = bytes(j[0] for j in junk if len(j) == 1)
            junk = [j for j in junk if len(j) &gt;= 2]

        strip = None

        if strips:
            if left and right:
                def strip(b):
                    if b[0] in strips or b[-1] in strips:
                        return True, b.strip(strips)
                    return False, b
            elif left:
                def strip(b):
                    if b[0] in strips:
                        return True, b.lstrip(strips)
                    return False, b
            elif right:
                def strip(b):
                    if b[-1] in strips:
                        return True, b.rstrip(strips)
                    return False, b

        super().__init__(strip=strip, junk=junk, left=left, right=right)

    def process(self, data: bytearray):
        dirty = True
        synch = True
        mview = memoryview(data)

        while dirty:
            dirty = False

            if self.args.strip:
                dirty, data = self.args.strip(data)
                if dirty:
                    mview = memoryview(data)
                    synch = True

            for junk in self.args.junk:

                # For large repeated patches of junk, performance is increased significantly by
                # performing less comparisons in Python code. The following code determines a
                # binary representation of the number N of trimmable junk pieces by performing
                # at most 2 log(N) comparisons. Furthermore, exactly K trimming operations are
                # done, where K is the number of bits in the binary representation of N that are
                # set.

                if self.args.left and mview[:len(junk)] == junk:
                    dirty = True
                    synch = False
                    t = junk
                    while mview[:len(t)] == t:
                        mview = mview[len(t):]
                        t += t
                    t = memoryview(t)
                    while t:
                        if mview[:len(t)] == t: mview = mview[len(t):]
                        t = t[:len(t) // 2]

                if self.args.right and mview[-len(junk):] == junk:
                    dirty = True
                    synch = False
                    t = junk
                    while mview[-len(t):] == t:
                        mview = mview[:-len(t)]
                        t += t
                    t = memoryview(t)
                    while t:
                        if mview[-len(t):] == t: mview = mview[:-len(t)]
                        t = t[:len(t) // 2]

        return bytearray(mview) if not synch else data</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.Entry" href="units/index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.trim.argspec"><code class="name">var <span class="ident">argspec</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="units/index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.assemble" href="units/index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.detach" href="units/index.html#refinery.units.Unit.detach">detach</a></code></li>
<li><code><a title="refinery.units.Unit.filter" href="units/index.html#refinery.units.Unit.filter">filter</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="units/index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="units/index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="units/index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="units/index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="units/index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.output" href="units/index.html#refinery.units.Unit.output">output</a></code></li>
<li><code><a title="refinery.units.Unit.process" href="units/index.html#refinery.units.Unit.process">process</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="units/index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="units/index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="units/index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="units/index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="units/index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="refinery.explore" href="explore.html">refinery.explore</a></code></li>
<li><code><a title="refinery.lib" href="lib/index.html">refinery.lib</a></code></li>
<li><code><a title="refinery.units" href="units/index.html">refinery.units</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="refinery.arg" href="#refinery.arg">arg</a></code></h4>
<ul class="two-column">
<li><code><a title="refinery.arg.switch" href="#refinery.arg.switch">switch</a></code></li>
<li><code><a title="refinery.arg.number" href="#refinery.arg.number">number</a></code></li>
<li><code><a title="refinery.arg.option" href="#refinery.arg.option">option</a></code></li>
<li><code><a title="refinery.arg.choice" href="#refinery.arg.choice">choice</a></code></li>
<li><code><a title="refinery.arg.infer" href="#refinery.arg.infer">infer</a></code></li>
<li><code><a title="refinery.arg.update_help" href="#refinery.arg.update_help">update_help</a></code></li>
<li><code><a title="refinery.arg.merge_args" href="#refinery.arg.merge_args">merge_args</a></code></li>
<li><code><a title="refinery.arg.merge_all" href="#refinery.arg.merge_all">merge_all</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.add" href="#refinery.add">add</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.bitrev" href="#refinery.bitrev">bitrev</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.blockop" href="#refinery.blockop">blockop</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.map" href="#refinery.map">map</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.neg" href="#refinery.neg">neg</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.pack" href="#refinery.pack">pack</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.rev" href="#refinery.rev">rev</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.rotl" href="#refinery.rotl">rotl</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.rotr" href="#refinery.rotr">rotr</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.shl" href="#refinery.shl">shl</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.shr" href="#refinery.shr">shr</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.sub" href="#refinery.sub">sub</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.transpose" href="#refinery.transpose">transpose</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.xor" href="#refinery.xor">xor</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.aplib" href="#refinery.aplib">aplib</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.bz2" href="#refinery.bz2">bz2</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.decompress" href="#refinery.decompress">decompress</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.gz" href="#refinery.gz">gz</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.lzma" href="#refinery.lzma">lzma</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.lznt1" href="#refinery.lznt1">lznt1</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.zl" href="#refinery.zl">zl</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.aes" href="#refinery.aes">aes</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.blowfish" href="#refinery.blowfish">blowfish</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.cast" href="#refinery.cast">cast</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.chacha" href="#refinery.chacha">chacha</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.des" href="#refinery.des">des</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.des3" href="#refinery.des3">des3</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.hc128" href="#refinery.hc128">hc128</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.rc2" href="#refinery.rc2">rc2</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.rc4" href="#refinery.rc4">rc4</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.rncrypt" href="#refinery.rncrypt">rncrypt</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.rot" href="#refinery.rot">rot</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.rsa" href="#refinery.rsa">rsa</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.salsa" href="#refinery.salsa">salsa</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.seal" href="#refinery.seal">seal</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.secstr" href="#refinery.secstr">secstr</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.vigenere" href="#refinery.vigenere">vigenere</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.xtea" href="#refinery.xtea">xtea</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.adler32" href="#refinery.adler32">adler32</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.crc32" href="#refinery.crc32">crc32</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.blk224" href="#refinery.blk224">blk224</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.blk256" href="#refinery.blk256">blk256</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.blk384" href="#refinery.blk384">blk384</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.blk512" href="#refinery.blk512">blk512</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.md5" href="#refinery.md5">md5</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.sha1" href="#refinery.sha1">sha1</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.sha224" href="#refinery.sha224">sha224</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.sha256" href="#refinery.sha256">sha256</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.sha384" href="#refinery.sha384">sha384</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.sha512" href="#refinery.sha512">sha512</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.imphash" href="#refinery.imphash">imphash</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.CryptDeriveKey" href="#refinery.CryptDeriveKey">CryptDeriveKey</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.DESDerive" href="#refinery.DESDerive">DESDerive</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.PasswordDeriveBytes" href="#refinery.PasswordDeriveBytes">PasswordDeriveBytes</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.HKDF" href="#refinery.HKDF">HKDF</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.kblob" href="#refinery.kblob">kblob</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.PBKDF1" href="#refinery.PBKDF1">PBKDF1</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.PBKDF2" href="#refinery.PBKDF2">PBKDF2</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.ucrypt" href="#refinery.ucrypt">ucrypt</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.b32" href="#refinery.b32">b32</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.b64" href="#refinery.b64">b64</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.b85" href="#refinery.b85">b85</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.base" href="#refinery.base">base</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.cp1252" href="#refinery.cp1252">cp1252</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.esc" href="#refinery.esc">esc</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.hex" href="#refinery.hex">hex</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.html" href="#refinery.html">html</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.netbios" href="#refinery.netbios">netbios</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.ps1str" href="#refinery.ps1str">ps1str</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.recode" href="#refinery.recode">recode</a></code></h4>
<ul class="">
<li><code><a title="refinery.recode.detect" href="#refinery.recode.detect">detect</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.u16" href="#refinery.u16">u16</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.url" href="#refinery.url">url</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.vbe" href="#refinery.vbe">vbe</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.dsjava" href="#refinery.dsjava">dsjava</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.dsphp" href="#refinery.dsphp">dsphp</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.elfslice" href="#refinery.elfslice">elfslice</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.xtmail" href="#refinery.xtmail">xtmail</a></code></h4>
<ul class="">
<li><code><a title="refinery.xtmail.unpack" href="#refinery.xtmail.unpack">unpack</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.httpresponse" href="#refinery.httpresponse">httpresponse</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.xlxtr" href="#refinery.xlxtr">xlxtr</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.dncfx" href="#refinery.dncfx">dncfx</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.dnds" href="#refinery.dnds">dnds</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.dnfields" href="#refinery.dnfields">dnfields</a></code></h4>
<ul class="">
<li><code><a title="refinery.dnfields.unpack" href="#refinery.dnfields.unpack">unpack</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.dnhdr" href="#refinery.dnhdr">dnhdr</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.dnmr" href="#refinery.dnmr">dnmr</a></code></h4>
<ul class="">
<li><code><a title="refinery.dnmr.unpack" href="#refinery.dnmr.unpack">unpack</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.dnrc" href="#refinery.dnrc">dnrc</a></code></h4>
<ul class="">
<li><code><a title="refinery.dnrc.unpack" href="#refinery.dnrc.unpack">unpack</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.dnstr" href="#refinery.dnstr">dnstr</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.pemeta" href="#refinery.pemeta">pemeta</a></code></h4>
<ul class="">
<li><code><a title="refinery.pemeta.parse_signature" href="#refinery.pemeta.parse_signature">parse_signature</a></code></li>
<li><code><a title="refinery.pemeta.parse_file_info" href="#refinery.pemeta.parse_file_info">parse_file_info</a></code></li>
<li><code><a title="refinery.pemeta.parse_time_stamps" href="#refinery.pemeta.parse_time_stamps">parse_time_stamps</a></code></li>
<li><code><a title="refinery.pemeta.parse_dotnet" href="#refinery.pemeta.parse_dotnet">parse_dotnet</a></code></li>
<li><code><a title="refinery.pemeta.parse_debug_data" href="#refinery.pemeta.parse_debug_data">parse_debug_data</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.peoverlay" href="#refinery.peoverlay">peoverlay</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.perc" href="#refinery.perc">perc</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.pesig" href="#refinery.pesig">pesig</a></code></h4>
<ul class="">
<li><code><a title="refinery.pesig.process" href="#refinery.pesig.process">process</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.peslice" href="#refinery.peslice">peslice</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.pestrip" href="#refinery.pestrip">pestrip</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.pkcs7" href="#refinery.pkcs7">pkcs7</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.winreg" href="#refinery.winreg">winreg</a></code></h4>
<ul class="">
<li><code><a title="refinery.winreg.unpack" href="#refinery.winreg.unpack">unpack</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.xtzip" href="#refinery.xtzip">xtzip</a></code></h4>
<ul class="">
<li><code><a title="refinery.xtzip.unpack" href="#refinery.xtzip.unpack">unpack</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.chop" href="#refinery.chop">chop</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.couple" href="#refinery.couple">couple</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.dedup" href="#refinery.dedup">dedup</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.emit" href="#refinery.emit">emit</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.fread" href="#refinery.fread">fread</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.mpop" href="#refinery.mpop">mpop</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.mpush" href="#refinery.mpush">mpush</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.mput" href="#refinery.mput">mput</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.nop" href="#refinery.nop">nop</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.pad" href="#refinery.pad">pad</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.pick" href="#refinery.pick">pick</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.scope" href="#refinery.scope">scope</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.sep" href="#refinery.sep">sep</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.sorted" href="#refinery.sorted">sorted</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.autoxor" href="#refinery.autoxor">autoxor</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.binpng" href="#refinery.binpng">binpng</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.datefix" href="#refinery.datefix">datefix</a></code></h4>
<ul class="">
<li><code><a title="refinery.datefix.dostime" href="#refinery.datefix.dostime">dostime</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.deob_ps1" href="#refinery.deob_ps1">deob_ps1</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_ps1_brackets" href="#refinery.deob_ps1_brackets">deob_ps1_brackets</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_ps1_cases" href="#refinery.deob_ps1_cases">deob_ps1_cases</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_ps1_concat" href="#refinery.deob_ps1_concat">deob_ps1_concat</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_ps1_escape" href="#refinery.deob_ps1_escape">deob_ps1_escape</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_ps1_format" href="#refinery.deob_ps1_format">deob_ps1_format</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_ps1_invoke" href="#refinery.deob_ps1_invoke">deob_ps1_invoke</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_ps1_literals" href="#refinery.deob_ps1_literals">deob_ps1_literals</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_ps1_secstr" href="#refinery.deob_ps1_secstr">deob_ps1_secstr</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_ps1_stringreplace" href="#refinery.deob_ps1_stringreplace">deob_ps1_stringreplace</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_ps1_typecast" href="#refinery.deob_ps1_typecast">deob_ps1_typecast</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_vba_arithmetic" href="#refinery.deob_vba_arithmetic">deob_vba_arithmetic</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_vba_comments" href="#refinery.deob_vba_comments">deob_vba_comments</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_vba_constants" href="#refinery.deob_vba_constants">deob_vba_constants</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_vba_dummy_variables" href="#refinery.deob_vba_dummy_variables">deob_vba_dummy_variables</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.deob_vba_chr_literals" href="#refinery.deob_vba_chr_literals">deob_vba_chr_literals</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.carve" href="#refinery.carve">carve</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.carve_json" href="#refinery.carve_json">carve_json</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.carve_pe" href="#refinery.carve_pe">carve_pe</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.carve_xml" href="#refinery.carve_xml">carve_xml</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.carve_zip" href="#refinery.carve_zip">carve_zip</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.defang" href="#refinery.defang">defang</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.dnsdomain" href="#refinery.dnsdomain">dnsdomain</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.mimewords" href="#refinery.mimewords">mimewords</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.resplit" href="#refinery.resplit">resplit</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.resub" href="#refinery.resub">resub</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.rex" href="#refinery.rex">rex</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.urlguards" href="#refinery.urlguards">urlguards</a></code></h4>
<ul class="">
<li><code><a title="refinery.urlguards.proofpointV2" href="#refinery.urlguards.proofpointV2">proofpointV2</a></code></li>
<li><code><a title="refinery.urlguards.proofpointV3" href="#refinery.urlguards.proofpointV3">proofpointV3</a></code></li>
<li><code><a title="refinery.urlguards.outlook" href="#refinery.urlguards.outlook">outlook</a></code></li>
<li><code><a title="refinery.urlguards.outlook_image_proxy" href="#refinery.urlguards.outlook_image_proxy">outlook_image_proxy</a></code></li>
<li><code><a title="refinery.urlguards.trendmicro" href="#refinery.urlguards.trendmicro">trendmicro</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.xtp" href="#refinery.xtp">xtp</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.carveb64z" href="#refinery.carveb64z">carveb64z</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.asm" href="#refinery.asm">asm</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.dump" href="#refinery.dump">dump</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.hexview" href="#refinery.hexview">hexview</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.peek" href="#refinery.peek">peek</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.ppjson" href="#refinery.ppjson">ppjson</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.ppxml" href="#refinery.ppxml">ppxml</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.cca" href="#refinery.cca">cca</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.ccp" href="#refinery.ccp">ccp</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.cfmt" href="#refinery.cfmt">cfmt</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.clower" href="#refinery.clower">clower</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.cupper" href="#refinery.cupper">cupper</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.rep" href="#refinery.rep">rep</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.repl" href="#refinery.repl">repl</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.snip" href="#refinery.snip">snip</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.stretch" href="#refinery.stretch">stretch</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.termfit" href="#refinery.termfit">termfit</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.trim" href="#refinery.trim">trim</a></code></h4>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.8.3</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>
hljs.configure({languages: []})
hljs.initHighlightingOnLoad()
</script>
</body>
</html>